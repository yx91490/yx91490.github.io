(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{509:function(t,a,e){"use strict";e.r(a);var v=e(18),_=Object(v.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"sqoophcatalog使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sqoophcatalog使用"}},[t._v("$")]),t._v(" sqoopHCatalog使用")]),t._v(" "),a("p",[t._v("HCatalog 是 Hadoop 的一个 table 与存储管理的一个服务，用户可以更容易地使用不同的数据处理工具 Pig、MapReduce 和 Hive 读写数据。HCatalog 表的抽象呈现给用户一个 HDFS 分布式文件系统（HDFS）中的关系视图，用户不需要担心数据存储在哪里及数据的存储格式：RCFile 格式、text 文件、或者 SequenceFile。")]),t._v(" "),a("h3",{attrs:{id:"参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[t._v("$")]),t._v(" 参数")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("功能")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("--hcatalog-database")])]),t._v(" "),a("td",[t._v("库名，默认为default，必须与"),a("code",[t._v("--hcatalog-table")]),t._v("一起使用，可选")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hcatalog-table")])]),t._v(" "),a("td",[t._v("表名，必填")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hcatalog-home")])]),t._v(" "),a("td",[t._v("HCatalog安装目录，包含"),a("code",[t._v("lib")]),t._v(","),a("code",[t._v("share/hcatalog")]),t._v("子目录，可选")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--create-hcatalog-table")])]),t._v(" "),a("td",[t._v("导入过程中如果不存在则创建表，表名自动转为小写，可选")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hcatalog-storage-stanza")])]),t._v(" "),a("td",[t._v("对于新建的表指定存储格式，默认值为"),a("code",[t._v("stored as rcfile")]),t._v("，可选")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hcatalog-partition-keys")]),t._v("，"),a("code",[t._v("--hcatalog-partition-values")])]),t._v(" "),a("td",[t._v("指定多级静态分区，逗号分隔，可选，如"),a("code",[t._v("--hcatalog-partition-keys year,month,day")]),t._v("和 "),a("code",[t._v("--hcatalog-partition-values 1999,12,31")]),t._v("，两个参数必须一起使用")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--map-column-hive")])]),t._v(" "),a("td",[t._v("数据类型映射")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hive-home")])]),t._v(" "),a("td",[t._v("hive home路径")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hive-partition-key")])]),t._v(" "),a("td",[t._v("静态分区列，必须为string类型，只能指定一个")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("--hive-partition-value")])]),t._v(" "),a("td",[t._v("静态分区值")])])])]),t._v(" "),a("p",[t._v("不支持的参数：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("--hive-import")])]),t._v(" "),a("li",[a("code",[t._v("--hive-overwrite")])]),t._v(" "),a("li",[a("code",[t._v("--export-dir")])]),t._v(" "),a("li",[a("code",[t._v("--target-dir")])]),t._v(" "),a("li",[a("code",[t._v("--warehouse-dir")])]),t._v(" "),a("li",[a("code",[t._v("--append")])]),t._v(" "),a("li",[a("code",[t._v("--as-sequencefile")])]),t._v(" "),a("li",[a("code",[t._v("--as-avrodatafile")])]),t._v(" "),a("li",[a("code",[t._v("--as-parquetfile")])])]),t._v(" "),a("p",[t._v("忽略的参数：")]),t._v(" "),a("ul",[a("li",[t._v("输入分隔符选项")]),t._v(" "),a("li",[t._v("除了 "),a("code",[t._v("--hive-drop-import-delims")]),t._v(" 和 "),a("code",[t._v("--hive-delims-replacement")]),t._v(" 的输出分隔符选项。")])]),t._v(" "),a("p",[t._v("其中"),a("code",[t._v("--hive-overwrite")]),t._v("参数文档上说并不支持，但是经过实测可以通过此参数达到追加写的目的。")]),t._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("$")]),t._v(" 示例")]),t._v(" "),a("p",[t._v("HCatalog 使用示例:")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("sqoop "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--connect")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'jdbc:mysql://'")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--username")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--password")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("  \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(" \n--split-by "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("id")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--table")]),t._v(" t1 \n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--columns")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'id,modify_time'")]),t._v(" \n-hive-drop-import-delims\n--hcatalog-database ods \n--hcatalog-table h1 \n--hcatalog-partition-keys dt \n--hcatalog-partition-values "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'20190221'")]),t._v("\n")])])]),a("h3",{attrs:{id:"分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分区"}},[t._v("$")]),t._v(" 分区")]),t._v(" "),a("p",[t._v("支持以下类型的表：")]),t._v(" "),a("ul",[a("li",[t._v("无分区表")]),t._v(" "),a("li",[t._v("指定一个静态分区键的分区表")]),t._v(" "),a("li",[t._v("数据库结果集中包含动态分区的分区表")]),t._v(" "),a("li",[t._v("包含一个静态分区和附加的动态分区的分区表")])]),t._v(" "),a("h3",{attrs:{id:"schema映射"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#schema映射"}},[t._v("$")]),t._v(" schema映射")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("sqoop目前不支持列名映射，但是用户可以指定类型映射")])]),t._v(" "),a("li",[a("p",[t._v("默认SQL中的float和real类型会被映射成HCatalog的float")])]),t._v(" "),a("li",[a("p",[t._v("除了binary的SQL类型都能映射成string类型")])]),t._v(" "),a("li",[a("p",[t._v("SQL中的数字类型（int, shortint, tinyint, bigint 和 bigdecimal, float 和 double）可以被映射成HCatalog中任意的数字类型，根据精度的不同，数据有可能发生截断")])]),t._v(" "),a("li",[a("p",[t._v("date/time/timestamps会被映射为Hive的date/timestamp类型，也可以映射成bigint类型（代表新纪元后的毫秒数）")])]),t._v(" "),a("li",[a("p",[t._v("BLOBs 和 CLOBs只支持导入")])]),t._v(" "),a("li",[a("p",[t._v("数据库的列名会被映射成对应的小写形式，当前不支持大小写敏感的数据库对象名")])]),t._v(" "),a("li",[a("p",[t._v("允许列的投影，如果有动态分区列的话，必须是投影的一部分")])]),t._v(" "),a("li",[a("p",[t._v("动态分区列在db中必须有非空的属性，如果导入过程中动态分区列有null值的话会终止导入任务")])])]),t._v(" "),a("h3",{attrs:{id:"数据类型支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据类型支持"}},[t._v("$")]),t._v(" 数据类型支持")]),t._v(" "),a("p",[t._v("Hive 0.13中所有的基本类型都支持，HCatalog的复杂类型都不支持")]),t._v(" "),a("ul",[a("li",[t._v("TINYINT")]),t._v(" "),a("li",[t._v("SMALLINT")]),t._v(" "),a("li",[t._v("INTEGER")]),t._v(" "),a("li",[t._v("BIGINT")]),t._v(" "),a("li",[t._v("FLOAT")]),t._v(" "),a("li",[t._v("DOUBLE")]),t._v(" "),a("li",[t._v("DECIMAL")]),t._v(" "),a("li",[t._v("TIMESTAMP")]),t._v(" "),a("li",[t._v("DATE")]),t._v(" "),a("li",[t._v("STRING")]),t._v(" "),a("li",[t._v("VARCHAR")]),t._v(" "),a("li",[t._v("CHAR")]),t._v(" "),a("li",[t._v("BOOLEAN")]),t._v(" "),a("li",[t._v("BINARY")])]),t._v(" "),a("h3",{attrs:{id:"优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#优点"}},[t._v("$")]),t._v(" 优点")]),t._v(" "),a("p",[t._v("使用HCatalog导入Hive表有如下好处：")]),t._v(" "),a("ol",[a("li",[t._v("兼容Hive表的存储格式")]),t._v(" "),a("li",[t._v("不用考虑null值处理问题")]),t._v(" "),a("li",[t._v("输出文件会合并")])]),t._v(" "),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("$")]),t._v(" 参考资料：")]),t._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://sqoop.apache.org/docs/1.4.6/SqoopUserGuide.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sqoop User Guide (v1.4.6)"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Types",target:"_blank",rel:"noopener noreferrer"}},[t._v("LanguageManual Types"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://cwiki.apache.org/confluence/display/Hive/HCatalog+InputOutput",target:"_blank",rel:"noopener noreferrer"}},[t._v("HCatalog InputOutput"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/39113492",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sqoop 使用指南"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/42239286",target:"_blank",rel:"noopener noreferrer"}},[t._v("重要 | mr使用hcatalog读写hive"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"http://zhang-jc.github.io/2018/12/28/Sqoop-%E6%94%AF%E6%8C%81-ORC-%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sqoop 支持 ORC 文件格式"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=_.exports}}]);