(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{454:function(e,r,t){"use strict";t.r(r);var s=t(10),a=Object(s.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"hive源码分析"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#hive源码分析"}},[e._v("$")]),e._v(" Hive源码分析")]),e._v(" "),r("h2",{attrs:{id:"jdbc"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#jdbc"}},[e._v("$")]),e._v(" Jdbc")]),e._v(" "),r("h3",{attrs:{id:"url格式"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#url格式"}},[e._v("$")]),e._v(" URL格式")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://github.com/apache/hive/blob/rel/release-3.1.3/jdbc/src/java/org/apache/hive/jdbc/HiveConnection.java#L173",target:"_blank",rel:"noopener noreferrer"}},[e._v("JDBC URL"),r("OutboundLink")],1),e._v("的格式（其中每个list部分都是分号分隔的键值对）：")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("jdbc:hive2://<host1>:<port1>,<host2>:<port2>/dbName;initFile=<file>;sess_var_list?hive_conf_list#hive_var_list\n")])])]),r("p",[e._v("URL解析的代码在："),r("a",{attrs:{href:"https://github.com/apache/hive/blob/rel/release-3.1.3/jdbc/src/java/org/apache/hive/jdbc/Utils.java#L349",target:"_blank",rel:"noopener noreferrer"}},[e._v("org.apache.hive.jdbc.Utils.extractURLComponents(String uri, Properties info)"),r("OutboundLink")],1),e._v("，主要流程如下：")]),e._v(" "),r("ul",[r("li",[e._v("解析Authority部分，即"),r("code",[e._v("Host:Port")]),e._v("列表（当动态服务发现的时候支持多个）。")]),e._v(" "),r("li",[e._v("从URL的Path部分（“/”后，“?”前）解析db名和SessionVars的键值对。")]),e._v(" "),r("li",[e._v("从URL的Query部分（“?”后，“#”前）解析HiveConfs的键值对。")]),e._v(" "),r("li",[e._v("从URL的Fragment部分（“#”后）解析HiveVars的键值对。")]),e._v(" "),r("li",[e._v('从info的键值对中按前缀"hiveconf:"或"hivevar:"分别覆盖HiveConfs和HiveVars对应的值。')]),e._v(" "),r("li",[e._v('如果SessionVars中没有"user"，则从info中取"user"，"password"键值对覆盖。')]),e._v(" "),r("li",[e._v('从info的键值对取"auth"覆盖SessionVars中的值。')])]),e._v(" "),r("p",[e._v('sess_var_list主要是JDBC客户端的参数，hive_conf_list和hive_var_list主要是服务端的参数，会随着OpenSession请求发送到服务端。info Properties可以覆盖URL中的hive_conf_list和hive_var_list，以及sess_var_list中的"user"，"password"，"auth"等认证相关参数。')]),e._v(" "),r("h3",{attrs:{id:"参考"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("$")]),e._v(" 参考")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://cwiki.apache.org/confluence/display/hive/hiveserver2+clients#HiveServer2Clients-ConnectionURLs",target:"_blank",rel:"noopener noreferrer"}},[e._v("HiveServer2 Clients - Connection URLs"),r("OutboundLink")],1)])])}),[],!1,null,null,null);r.default=a.exports}}]);