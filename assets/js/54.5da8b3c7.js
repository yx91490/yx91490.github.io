(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{439:function(e,a,t){"use strict";t.r(a);var r=t(10),s=Object(r.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"hdfs-issue"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hdfs-issue"}},[e._v("$")]),e._v(" HDFS Issue")]),e._v(" "),a("h3",{attrs:{id:"_1-datanode汇报块不及时导致报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-datanode汇报块不及时导致报错"}},[e._v("$")]),e._v(" 1.DataNode汇报块不及时导致报错")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("2020-11-02 16:39:41,515 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: BLOCK* checkFileProgress: blk_1653438437_582833232{blockUCState=COMMITTED, primaryNodeIndex=-1, \nreplicas=[ReplicaUnderConstruction[[DISK]DS-b2dc6b07-b55a-4176-a5db-206250c4aed6:NORMAL:\n172.16.36.158:1004|RBW], ReplicaUnderConstruction[[DISK]DS-06c29767-45cf-43de-a68b-86b103ea9c0a:NORMAL:\n172.16.36.179:1004|RBW], ReplicaUnderConstruction[[DISK]DS-9a76064f-6b52-4cb3-b469-f86efedc582b:NORMAL:\n172.16.22.209:1004|RBW]]} has not reached minimal replication 1\n\n2020-11-02 16:39:41,918 INFO org.apache.hadoop.hdfs.server.namenode.FSNamesystem: BLOCK* checkFileProgress: blk_1653438437_582833232{\n  blockUCState=COMMITTED, primaryNodeIndex=-1, replicas=[ReplicaUnderConstruction[\n    [DISK]DS-b2dc6b07-b55a-4176-a5db-206250c4aed6:NORMAL:172.16.36.158:1004|RBW], \n    ReplicaUnderConstruction[[DISK]DS-06c29767-45cf-43de-a68b-86b103ea9c0a:NORMAL:\n    172.16.36.179:1004|RBW], ReplicaUnderConstruction[[DISK]DS-9a76064f-6b52-4cb3-b469-f86efedc582b:NORMAL:172.16.22.209:1004|RBW]]} has not reached minimal replication 1\n2020-11-02 16:39\n")])])]),a("h3",{attrs:{id:"_2-没有足够副本数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-没有足够副本数"}},[e._v("$")]),e._v(" 2.没有足够副本数")]),e._v(" "),a("p",[e._v("参考：")]),e._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://stackoverflow.com/questions/36015864/hadoop-be-replicated-to-0-nodes-instead-of-minreplication-1-there-are-1/36310025",target:"_blank",rel:"noopener noreferrer"}},[e._v(" There are 1 datanode(s) running and no node(s) are excluded in this operation"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://stackoverflow.com/questions/34245682/could-only-be-replicated-to-0-nodes-instead-of-minreplication-1-there-are-4",target:"_blank",rel:"noopener noreferrer"}},[e._v("could only be replicated to 0 nodes instead of minReplication (=1)"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://www.runexception.com/q/180",target:"_blank",rel:"noopener noreferrer"}},[e._v("hdfs通过put命令上传文件成果，reduce阶段写入hdfs报错是什么原因？"),a("OutboundLink")],1)])])]),e._v(" "),a("h3",{attrs:{id:"_3-小文件问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-小文件问题"}},[e._v("$")]),e._v(" 3.小文件问题")]),e._v(" "),a("p",[e._v("所谓的小文件是指远远小于文件块大小的文件。众所周知HDFS中过多的小文件会给NameNode造成很大的压力，在使用HDFS的过程中，应尽量避免生成过多的小文件。")]),e._v(" "),a("p",[e._v("将本地的小文件合并上传到HDFS：")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("hadoop fs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-appendToFile")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("1")]),e._v(".txt "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(".txt hdfs://cdh5/tmp/merged.txt\n")])])]),a("p",[e._v("下载HDFS的小文件并合并到本地：")]),e._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[e._v("hadoop fs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[e._v("-getmerge")]),e._v(" hdfs://cdh5/tmp/*.txt local.txt\n")])])]),a("p",[e._v("参考：")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"http://lxw1234.com/archives/2015/09/481.htm",target:"_blank",rel:"noopener noreferrer"}},[e._v("合并HDFS和本地文件系统中的小文件"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=s.exports}}]);