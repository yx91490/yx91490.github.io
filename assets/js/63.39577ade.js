(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{442:function(t,a,e){"use strict";e.r(a);var s=e(10),l=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"hive解析json数组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hive解析json数组"}},[t._v("$")]),t._v(" Hive解析json数组")]),t._v(" "),a("h3",{attrs:{id:"sql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql"}},[t._v("$")]),t._v(" sql")]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("SELECT id, get_json_object(input_path_json_col, '$.path') AS input_path\nFROM (\n\tSELECT id, input_path_json_col\n\tFROM (\n\t\tSELECT id\n\t\t\t, split(\n\t\t\t\tregexp_replace(\n\t\t\t\tregexp_extract(input_path, '^\\\\[(.+)\\\\]$', 1)\n\t\t\t\t, '\\\\}\\\\,\\\\{'\n\t\t\t\t, '\\\\}\\\\|\\\\|\\\\{')\n\t\t\t, '\\\\|\\\\|') \n\t\t\tAS input_path_json\n\t\tFROM ods.o_t_job_spark_bigdata_test\n\t) tmp\n\t\tLATERAL VIEW explode(tmp.input_path_json) spark_job AS input_path_json_col\n) exp\n")])])]),a("h3",{attrs:{id:"函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#函数"}},[t._v("$")]),t._v(" 函数")]),t._v(" "),a("p",[t._v("regexp_extract(string subject, string pattern, string index)")]),t._v(" "),a("p",[t._v("​\t抽取字符串subject中符合正则表达式pattern的第index部分的子字符串")]),t._v(" "),a("p",[t._v("regexp_replace(string s, string regex, string replacement)")]),t._v(" "),a("p",[t._v("​\t根据java正则表达式regex将字符串s中符合条件的部分替换成replacement")]),t._v(" "),a("p",[t._v("split(string s, string patter)")]),t._v(" "),a("p",[t._v("​\t按照正则表达式pattern分割字符串s，并以数组的形式返回")]),t._v(" "),a("p",[t._v("get_json_object(string json, string path)")]),t._v(" "),a("p",[t._v("​\t从给定json字符串中抽取json对象")]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("select get_json_object(‘${hivevar:msg}’,’$.server’) from test;\n")])])]),a("h3",{attrs:{id:"lateralview"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lateralview"}},[t._v("$")]),t._v(" lateralView")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("简介")]),t._v(" "),a("p",[t._v("Lateral View一般与用户自定义表生成函数（如explode()）结合使用。 如内置表生成函数中所述，UDTF为每个输入行生成零个或多个输出行。 Lateral View 首先将UDTF应用于基表的每一行，然后将结果输出行连接到输入行，以形成具有提供的表别名的虚拟表。")])]),t._v(" "),a("li",[a("p",[t._v("语法")])])]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("fromClause: FROM baseTable (lateralView)*\nlateralView: LATERAL VIEW udtf(expression) tableAlias AS columnAlias (',' columnAlias)*\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("例子：")])]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("SELECT adid, count(1)\n    FROM tmp_laterview LATERAL VIEW explode(adid_list) adTable AS adid\n    GROUP BY adid;\n")])])]),a("p",[t._v("FROM子句可以有多个LATERAL VIEW子句。 后面的LATERAL VIEWS子句可以引用出现在LATERAL VIEWS左侧表的任何列")]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("SELECT * FROM exampleTable\n\tLATERAL VIEW explode(col1) myTable1 AS myCol1\n\tLATERAL VIEW explode(col2) myTable2 AS myCol2;\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[t._v("OUTER")]),t._v(" "),a("p",[t._v("用户可以指定可选的OUTER关键字来生成行，即使LATERAL VIEW通常不会生成行。当所使用的UDTF不产生任何行时（使用explode()函数时，explode的列为空时，很容易发生上述这种情况）。 在这种情况下，源数据行不会出现在结果中。如果想让源数据行继续出现在结果中，可以使用 OUTER可以用来阻止关键字，并且来自UDTF的列使用NULL值代替。")]),t._v(" "),a("p",[t._v("例如，以下查询返回空结果：")]),t._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("SELECT * FROM tmp_laterview LATERAL VIEW explode(array()) C AS a;\n//空\n")])])]),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v('SELECT * FROM tmp_laterview LATERAL VIEW OUTER explode(array()) C AS a;\n[1,2,3]\t["a","b","c"]\tNULL\n[4,5]\t["c","d"]\tNULL\n')])])])])])])}),[],!1,null,null,null);a.default=l.exports}}]);