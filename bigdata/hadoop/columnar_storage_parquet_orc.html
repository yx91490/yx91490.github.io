<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>列式存储（parquet,orc） | yx91490的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.png">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-QQHZM2VLM0"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QQHZM2VLM0');</script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6781d2ac2dff1f3b278518419b4d4deb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <meta name="description" content="java, 大数据(hadoop, sqoop, kylin, zeppelin)相关技术, 工作经验记录">
    <meta name="google-site-verification" content="j1Gm2ZeMV3D7mPiI08fpx91dEOSlhCAJjD4vy_pSroQ">
    <meta name="baidu-site-verification" content="4z2bGbjYMB">
    
    <link rel="preload" href="/assets/css/0.styles.003598ab.css" as="style"><link rel="preload" href="/assets/js/app.e5e86d4d.js" as="script"><link rel="preload" href="/assets/js/2.09d8812d.js" as="script"><link rel="preload" href="/assets/js/15.88324fac.js" as="script"><link rel="prefetch" href="/assets/js/10.4171dbcb.js"><link rel="prefetch" href="/assets/js/100.f81c7377.js"><link rel="prefetch" href="/assets/js/101.c22bd5e3.js"><link rel="prefetch" href="/assets/js/102.69bd0d78.js"><link rel="prefetch" href="/assets/js/103.d0821059.js"><link rel="prefetch" href="/assets/js/104.b2696c15.js"><link rel="prefetch" href="/assets/js/105.fb36fb46.js"><link rel="prefetch" href="/assets/js/106.88d6436f.js"><link rel="prefetch" href="/assets/js/107.d93f09bb.js"><link rel="prefetch" href="/assets/js/108.589b461e.js"><link rel="prefetch" href="/assets/js/109.d1e3bc25.js"><link rel="prefetch" href="/assets/js/11.84e74a99.js"><link rel="prefetch" href="/assets/js/110.f356fd92.js"><link rel="prefetch" href="/assets/js/111.c6f574e1.js"><link rel="prefetch" href="/assets/js/112.aaddf412.js"><link rel="prefetch" href="/assets/js/113.2f2bec01.js"><link rel="prefetch" href="/assets/js/114.b34c0c50.js"><link rel="prefetch" href="/assets/js/115.10eb77c0.js"><link rel="prefetch" href="/assets/js/116.5b3b59d2.js"><link rel="prefetch" href="/assets/js/117.19afcb19.js"><link rel="prefetch" href="/assets/js/118.8400b815.js"><link rel="prefetch" href="/assets/js/119.7fedc175.js"><link rel="prefetch" href="/assets/js/12.b2560a0e.js"><link rel="prefetch" href="/assets/js/120.c754ee6d.js"><link rel="prefetch" href="/assets/js/121.d91d5fe1.js"><link rel="prefetch" href="/assets/js/122.0db684a6.js"><link rel="prefetch" href="/assets/js/123.5f8ace9e.js"><link rel="prefetch" href="/assets/js/124.e47691c2.js"><link rel="prefetch" href="/assets/js/125.4b9948c9.js"><link rel="prefetch" href="/assets/js/126.d8ab7d87.js"><link rel="prefetch" href="/assets/js/127.135070f6.js"><link rel="prefetch" href="/assets/js/128.564b8d71.js"><link rel="prefetch" href="/assets/js/129.6afca56a.js"><link rel="prefetch" href="/assets/js/13.c9da01d5.js"><link rel="prefetch" href="/assets/js/130.fe579d47.js"><link rel="prefetch" href="/assets/js/131.bb94529c.js"><link rel="prefetch" href="/assets/js/132.578be1aa.js"><link rel="prefetch" href="/assets/js/133.384eb3c7.js"><link rel="prefetch" href="/assets/js/134.d1c634f4.js"><link rel="prefetch" href="/assets/js/135.e3222528.js"><link rel="prefetch" href="/assets/js/136.2e2371c2.js"><link rel="prefetch" href="/assets/js/137.4d20b75c.js"><link rel="prefetch" href="/assets/js/138.9542edff.js"><link rel="prefetch" href="/assets/js/139.c8650aaf.js"><link rel="prefetch" href="/assets/js/14.a3d22f43.js"><link rel="prefetch" href="/assets/js/140.e0825b9d.js"><link rel="prefetch" href="/assets/js/141.06ae9b8e.js"><link rel="prefetch" href="/assets/js/142.63955fb2.js"><link rel="prefetch" href="/assets/js/143.f6df311c.js"><link rel="prefetch" href="/assets/js/144.2a781a1d.js"><link rel="prefetch" href="/assets/js/145.1a5a8f42.js"><link rel="prefetch" href="/assets/js/146.0e0c5073.js"><link rel="prefetch" href="/assets/js/147.8e1a0316.js"><link rel="prefetch" href="/assets/js/148.df198827.js"><link rel="prefetch" href="/assets/js/149.41b5db4c.js"><link rel="prefetch" href="/assets/js/150.d4610bcf.js"><link rel="prefetch" href="/assets/js/151.2aef3bc6.js"><link rel="prefetch" href="/assets/js/152.cfb467ab.js"><link rel="prefetch" href="/assets/js/153.655a7f5a.js"><link rel="prefetch" href="/assets/js/154.a9ac702c.js"><link rel="prefetch" href="/assets/js/155.e0fe2c4b.js"><link rel="prefetch" href="/assets/js/156.64f63a3c.js"><link rel="prefetch" href="/assets/js/157.4b583116.js"><link rel="prefetch" href="/assets/js/158.6fd7d07c.js"><link rel="prefetch" href="/assets/js/159.09151b16.js"><link rel="prefetch" href="/assets/js/16.60745381.js"><link rel="prefetch" href="/assets/js/160.bf510d12.js"><link rel="prefetch" href="/assets/js/161.2a2051b7.js"><link rel="prefetch" href="/assets/js/162.377b1f39.js"><link rel="prefetch" href="/assets/js/163.47bae087.js"><link rel="prefetch" href="/assets/js/164.6dafe90c.js"><link rel="prefetch" href="/assets/js/165.820ff007.js"><link rel="prefetch" href="/assets/js/166.dee6bd1d.js"><link rel="prefetch" href="/assets/js/167.3631c64d.js"><link rel="prefetch" href="/assets/js/168.2601d5f0.js"><link rel="prefetch" href="/assets/js/169.ac5e7efc.js"><link rel="prefetch" href="/assets/js/17.0ec55566.js"><link rel="prefetch" href="/assets/js/170.80408de1.js"><link rel="prefetch" href="/assets/js/171.38438981.js"><link rel="prefetch" href="/assets/js/172.81bbe493.js"><link rel="prefetch" href="/assets/js/173.89ba378a.js"><link rel="prefetch" href="/assets/js/174.2f074f9c.js"><link rel="prefetch" href="/assets/js/175.17e9d568.js"><link rel="prefetch" href="/assets/js/176.732c1ad7.js"><link rel="prefetch" href="/assets/js/177.fd80cf13.js"><link rel="prefetch" href="/assets/js/178.e9e09ff3.js"><link rel="prefetch" href="/assets/js/179.83f399b5.js"><link rel="prefetch" href="/assets/js/18.87b0f642.js"><link rel="prefetch" href="/assets/js/180.0d64c527.js"><link rel="prefetch" href="/assets/js/181.741f406e.js"><link rel="prefetch" href="/assets/js/182.362549de.js"><link rel="prefetch" href="/assets/js/183.5c65d51e.js"><link rel="prefetch" href="/assets/js/184.602e578e.js"><link rel="prefetch" href="/assets/js/185.d8549706.js"><link rel="prefetch" href="/assets/js/186.e2ec1c8d.js"><link rel="prefetch" href="/assets/js/187.0e98dfd8.js"><link rel="prefetch" href="/assets/js/188.1303515f.js"><link rel="prefetch" href="/assets/js/189.649a2efe.js"><link rel="prefetch" href="/assets/js/19.7ee86863.js"><link rel="prefetch" href="/assets/js/190.3ba381cc.js"><link rel="prefetch" href="/assets/js/191.0f1f5390.js"><link rel="prefetch" href="/assets/js/192.39ed635e.js"><link rel="prefetch" href="/assets/js/193.fd147b1e.js"><link rel="prefetch" href="/assets/js/194.a5ba5a0f.js"><link rel="prefetch" href="/assets/js/195.c5d0ceb9.js"><link rel="prefetch" href="/assets/js/196.a24e605d.js"><link rel="prefetch" href="/assets/js/197.eee89628.js"><link rel="prefetch" href="/assets/js/198.201b0a74.js"><link rel="prefetch" href="/assets/js/199.a12cb1e8.js"><link rel="prefetch" href="/assets/js/20.c6737434.js"><link rel="prefetch" href="/assets/js/200.7e51e147.js"><link rel="prefetch" href="/assets/js/201.f3fb727c.js"><link rel="prefetch" href="/assets/js/202.00e008e7.js"><link rel="prefetch" href="/assets/js/203.ec9cbded.js"><link rel="prefetch" href="/assets/js/21.0da34766.js"><link rel="prefetch" href="/assets/js/22.62830d86.js"><link rel="prefetch" href="/assets/js/23.aec7e760.js"><link rel="prefetch" href="/assets/js/24.a39131ea.js"><link rel="prefetch" href="/assets/js/25.57991dc7.js"><link rel="prefetch" href="/assets/js/26.666f3888.js"><link rel="prefetch" href="/assets/js/27.d90edddc.js"><link rel="prefetch" href="/assets/js/28.6cfce4ae.js"><link rel="prefetch" href="/assets/js/29.c0e67596.js"><link rel="prefetch" href="/assets/js/3.5291bd6f.js"><link rel="prefetch" href="/assets/js/30.b95b5f96.js"><link rel="prefetch" href="/assets/js/31.6045c77c.js"><link rel="prefetch" href="/assets/js/32.06a13a4f.js"><link rel="prefetch" href="/assets/js/33.6d5117ee.js"><link rel="prefetch" href="/assets/js/34.c9b406ce.js"><link rel="prefetch" href="/assets/js/35.c6ae3eb4.js"><link rel="prefetch" href="/assets/js/36.456a19cc.js"><link rel="prefetch" href="/assets/js/37.96e5f639.js"><link rel="prefetch" href="/assets/js/38.b5c7001a.js"><link rel="prefetch" href="/assets/js/39.6d495ad6.js"><link rel="prefetch" href="/assets/js/4.a2e3361c.js"><link rel="prefetch" href="/assets/js/40.58604bc4.js"><link rel="prefetch" href="/assets/js/41.c9a03414.js"><link rel="prefetch" href="/assets/js/42.51493c8e.js"><link rel="prefetch" href="/assets/js/43.8da0cb4a.js"><link rel="prefetch" href="/assets/js/44.11fd3c9b.js"><link rel="prefetch" href="/assets/js/45.94705128.js"><link rel="prefetch" href="/assets/js/46.74ddaa0b.js"><link rel="prefetch" href="/assets/js/47.40ade509.js"><link rel="prefetch" href="/assets/js/48.48a3dc07.js"><link rel="prefetch" href="/assets/js/49.f4d8d4e3.js"><link rel="prefetch" href="/assets/js/5.e9e877ad.js"><link rel="prefetch" href="/assets/js/50.5c56bc06.js"><link rel="prefetch" href="/assets/js/51.4227b90f.js"><link rel="prefetch" href="/assets/js/52.ad6f5e02.js"><link rel="prefetch" href="/assets/js/53.17fcea84.js"><link rel="prefetch" href="/assets/js/54.49079eb0.js"><link rel="prefetch" href="/assets/js/55.f6dc42d1.js"><link rel="prefetch" href="/assets/js/56.b83686c4.js"><link rel="prefetch" href="/assets/js/57.b9a32559.js"><link rel="prefetch" href="/assets/js/58.130e0d1f.js"><link rel="prefetch" href="/assets/js/59.4dd31af5.js"><link rel="prefetch" href="/assets/js/6.f3f05064.js"><link rel="prefetch" href="/assets/js/60.6b26d636.js"><link rel="prefetch" href="/assets/js/61.4f3cd5b1.js"><link rel="prefetch" href="/assets/js/62.bbe1b100.js"><link rel="prefetch" href="/assets/js/63.03e1ffd2.js"><link rel="prefetch" href="/assets/js/64.36883580.js"><link rel="prefetch" href="/assets/js/65.25c8d7c2.js"><link rel="prefetch" href="/assets/js/66.1bc14ae7.js"><link rel="prefetch" href="/assets/js/67.aa73f9af.js"><link rel="prefetch" href="/assets/js/68.58fb370f.js"><link rel="prefetch" href="/assets/js/69.1ad9aa99.js"><link rel="prefetch" href="/assets/js/7.560b1069.js"><link rel="prefetch" href="/assets/js/70.2dd1cc71.js"><link rel="prefetch" href="/assets/js/71.b6919b00.js"><link rel="prefetch" href="/assets/js/72.42b16660.js"><link rel="prefetch" href="/assets/js/73.810bba7f.js"><link rel="prefetch" href="/assets/js/74.46ea4cc8.js"><link rel="prefetch" href="/assets/js/75.50003a99.js"><link rel="prefetch" href="/assets/js/76.23da54d2.js"><link rel="prefetch" href="/assets/js/77.e1e134d9.js"><link rel="prefetch" href="/assets/js/78.2d7fe4c3.js"><link rel="prefetch" href="/assets/js/79.a44d90c9.js"><link rel="prefetch" href="/assets/js/8.9452abaa.js"><link rel="prefetch" href="/assets/js/80.865c312a.js"><link rel="prefetch" href="/assets/js/81.a422e763.js"><link rel="prefetch" href="/assets/js/82.7436ce46.js"><link rel="prefetch" href="/assets/js/83.e4827f08.js"><link rel="prefetch" href="/assets/js/84.009cf84b.js"><link rel="prefetch" href="/assets/js/85.27e8651c.js"><link rel="prefetch" href="/assets/js/86.56b9dea1.js"><link rel="prefetch" href="/assets/js/87.5671c8c2.js"><link rel="prefetch" href="/assets/js/88.48014911.js"><link rel="prefetch" href="/assets/js/89.72770fc6.js"><link rel="prefetch" href="/assets/js/9.a01ca055.js"><link rel="prefetch" href="/assets/js/90.11ec3a9f.js"><link rel="prefetch" href="/assets/js/91.5249ea22.js"><link rel="prefetch" href="/assets/js/92.bf7f8cf4.js"><link rel="prefetch" href="/assets/js/93.db0d8177.js"><link rel="prefetch" href="/assets/js/94.7135cc0d.js"><link rel="prefetch" href="/assets/js/95.bf1893c1.js"><link rel="prefetch" href="/assets/js/96.752a626f.js"><link rel="prefetch" href="/assets/js/97.038eb2a5.js"><link rel="prefetch" href="/assets/js/98.673f9a86.js"><link rel="prefetch" href="/assets/js/99.5b31447d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.003598ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">yx91490的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Zeppelin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/zeppelin/heart_diease_dataset.html" class="sidebar-link">心脏病预测数据</a></li><li><a href="/bigdata/zeppelin/zeppelin_bugs.html" class="sidebar-link">zeppelin使用趟坑</a></li><li><a href="/bigdata/zeppelin/zeppelin_sharding.html" class="sidebar-link">Zeppelin v0.8分片方案</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Waterdrop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/waterdrop/waterdrop.html" class="sidebar-link">Waterdrop学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Kylin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/kylin/awesome_kylin.html" class="sidebar-link">Kylin学习资料汇总</a></li><li><a href="/bigdata/kylin/read_kylin_source.html" class="sidebar-link">阅读Kylin源码</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Sqoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/sqoop/sqoop_usage.html" class="sidebar-link">代码调试</a></li><li><a href="/bigdata/sqoop/sqoop_hcatalog.html" class="sidebar-link">sqoopHCatalog使用</a></li><li><a href="/bigdata/sqoop/sqoop_mysql_temp_file.html" class="sidebar-link">sqoop导入导致MySQL产生大临时文件问题排查</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ZooKeeper</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/zookeeper/zookeeper.html" class="sidebar-link">ZooKeeper笔记</a></li><li><a href="/bigdata/zookeeper/zookeeper_user.html" class="sidebar-link">ZooKeeper管理员指南</a></li><li><a href="/bigdata/zookeeper/zk_distribute_lock.html" class="sidebar-link">zookeeper实现分布式锁</a></li><li><a href="/bigdata/zookeeper/isbn9787111524311_note.html" class="sidebar-link">《ZooKeeper分布式过程协同技术详解》笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hadoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hadoop/hadoop_interview.html" class="sidebar-link">Hadoop面试题</a></li><li><a href="/bigdata/hadoop/port.html" class="sidebar-link">Hadoop默认端口</a></li><li><a href="/bigdata/hadoop/hdfs_user.html" class="sidebar-link">HDFS命令笔记</a></li><li><a href="/bigdata/hadoop/hdfs_issue.html" class="sidebar-link">HDFS Issue</a></li><li><a href="/bigdata/hadoop/distcp.html" class="sidebar-link">Distcp命令</a></li><li><a href="/bigdata/hadoop/columnar_storage_parquet_orc.html" aria-current="page" class="active sidebar-link">列式存储（parquet,orc）</a></li><li><a href="/bigdata/hadoop/avro_specification_1.8.1.html" class="sidebar-link">avro格式规范1.8.1翻译</a></li><li><a href="/bigdata/hadoop/yarn.html" class="sidebar-link">Yarn</a></li><li><a href="/bigdata/hadoop/yarn_cli.html" class="sidebar-link">Yarn Cli命令</a></li><li><a href="/bigdata/hadoop/mapreduce.html" class="sidebar-link">MapReduce</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Hive</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hive/hive_cli.html" class="sidebar-link">Beeline命令行</a></li><li><a href="/bigdata/hive/hive_src.html" class="sidebar-link">Hive源码分析</a></li><li><a href="/bigdata/hive/hive_ql.html" class="sidebar-link">HiveQL</a></li><li><a href="/bigdata/hive/hive_data_type.html" class="sidebar-link">Hive数据类型</a></li><li><a href="/bigdata/hive/hive_bucket.html" class="sidebar-link">Hive分桶</a></li><li><a href="/bigdata/hive/hive_principle.html" class="sidebar-link">Hive原理</a></li><li><a href="/bigdata/hive/hive_optimize.html" class="sidebar-link">Hive优化</a></li><li><a href="/bigdata/hive/hive_parse_json.html" class="sidebar-link">Hive解析json数组</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>OLAP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/olap/olap.html" class="sidebar-link">OLAP笔记</a></li><li><a href="/bigdata/olap/data_analyze.html" class="sidebar-link">数据分析笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ClickHouse</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/clickhouse/clickhouse.html" class="sidebar-link">ClickHouse学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Doris</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/doris/doris.html" class="sidebar-link">Doris笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Kudu</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/kudu/kudu.html" class="sidebar-link">Kudu</a></li><li><a href="/bigdata/kudu/kudu_paper.html" class="sidebar-link">Kudu: Storage for Fast Analytics on Fast Data</a></li><li><a href="/bigdata/kudu/kudu_paper_translation.html" class="sidebar-link">【译】Kudu论文</a></li><li><a href="/bigdata/kudu/kudu_note.html" class="sidebar-link">Kudu笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Impala</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/impala/cup.html" class="sidebar-link">CUP学习笔记</a></li><li><a href="/bigdata/impala/impala.html" class="sidebar-link">Impala</a></li><li><a href="/bigdata/impala/impala_admin.html" class="sidebar-link">Impala运维</a></li><li><a href="/bigdata/impala/impala_dev.html" class="sidebar-link">Impala开发笔记</a></li><li><a href="/bigdata/impala/impala_community.html" class="sidebar-link">Impala社区</a></li><li><a href="/bigdata/impala/impala_issues.html" class="sidebar-link">Impala问题记录</a></li><li><a href="/bigdata/impala/impala_paper_translation.html" class="sidebar-link">【转】【译】Impala：Hadoop上的一个现代开源SQL引擎</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spark</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/spark/spark.html" class="sidebar-link">Spark</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HBase</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hbase/hbase_interview.html" class="sidebar-link">HBase</a></li><li><a href="/bigdata/hbase/hbase_user.html" class="sidebar-link">HBase使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/note/oss_note.html" class="sidebar-link">《快手短视频打造高稳定千亿级别对象存储平台》笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="列式存储-parquet-orc"><a href="#列式存储-parquet-orc" class="header-anchor">$</a> 列式存储（parquet,orc）</h1> <h3 id="为什么列存储数据库读取速度会比传统的行数据库快"><a href="#为什么列存储数据库读取速度会比传统的行数据库快" class="header-anchor">$</a> 为什么列存储数据库读取速度会比传统的行数据库快？</h3> <p>列式存储只需要读取相关的列（而且可以连续整块读取），而行存储需要读取全部数据。这是其中一个很容易理解也很重要的原因。有些人因此认为，当需要读取全部字段时，行数据库和列式数据库性能应该是差不多的。这样的理解有失偏颇。其实，列式存储读取速度快还有很多其他原因。</p> <ol><li>列式存储把相同类型的数据归在一起，压缩比可以很高，通常能到10%~25%。数据库的瓶颈通常在IO，很高的压缩比，可以大大减轻数据读取的压力，提高响应速度。</li> <li>除去字符串类型，其他类型的字段通常是固定长度的，而且在磁盘和内存的字节顺序通常是一致的，可以直接映射，省去了解析的过程。而在行存储中，只要有变长的字段存在，需要逐行逐字段的解析。</li> <li>列式存储可以向量化的处理一个字段。可以将一个列的一整块连续数据读入CPU cache，效率非常高。而且，可以利用CPU的向量化处理指令并行处理一些常用计算，譬如求和，比较大小等等。而这一切在行存储中都做不到。</li> <li>因为数据表中的数据类型都是用户定义的，开发数据库的各种算子的时候，通常都是虚拟函数。在行存储中，意味着在每一行evaluate这个算子（譬如加法算子）的时候，我们都需要一个很大的case语句，对不同的数据类型分别处理，效率很低。而在列式存储中，极端情况下，对整个列只要做一次case处理就可以了，效率就会很高。当然近几年，很多数据库引擎都引入了JIT，行存储这方面的劣势在缩小。</li></ol> <p>其实，写数据的时候，如果可以批量处理，列式存储的效率也比行存储要高不少。但是oltp通常是对个别行的增删改，不能进行批处理，因此列存储效率不高，不推荐使用。</p> <h3 id="列式存储"><a href="#列式存储" class="header-anchor">$</a> 列式存储</h3> <p>由于OLAP查询的特点，列式存储可以提升其查询性能，但是它是如何做到的呢？这就要从列式存储的原理说起，从图1中可以看到，相对于关系数据库中通常使用的行式存储，在使用列式存储时每一列的所有元素都是顺序存储的。由此特点可以给查询带来如下的优化：</p> <ul><li>查询的时候不需要扫描全部的数据，而只需要读取每次查询涉及的列，这样可以将I/O消耗降低N倍</li> <li>可以保存每一列的统计信息(min、max、sum等)，实现部分的谓词下推。</li> <li>由于每一列的成员都是同构的，可以针对不同的数据类型使用更高效的数据压缩算法，进一步减小I/O。</li> <li>由于每一列的成员的同构性，可以使用更加适合CPU pipeline的编码方式，减小CPU的缓存失效。</li></ul> <h3 id="嵌套数据格式"><a href="#嵌套数据格式" class="header-anchor">$</a> 嵌套数据格式</h3> <p>通常我们使用关系数据库存储结构化数据，而关系数据库支持的数据模型都是扁平式的，而遇到诸如List、Map和自定义Struct的时候就需要用户自己解析，但是在大数据环境下，数据的来源多种多样，例如埋点数据，很可能需要把程序中的某些对象内容作为输出的一部分，而每一个对象都可能是嵌套的，所以如果能够原生的支持这种数据，查询的时候就不需要额外的解析便能获得想要的结果。</p> <h3 id="parquet"><a href="#parquet" class="header-anchor">$</a> Parquet</h3> <p>Apache Parquet 最初的设计动机是存储嵌套式数据,比如Protocolbuffer thrift json 等 将这类数据存储成列式格式以方便对其高效压缩和编码,且使用更少的IO操作取出需要的数据,也是Parquet 相比于ORC的优势,它能透明的将protobuf 和thrift被广泛的使用的今天,于parquet 进行集成,是一件非常容易和自然地事情,除了上述优势外,相比于ORC,Parquet 没有太多其他可圈可点的地方,比如他不支持update操作(数据写成后不可修改),不支持ACID等.</p> <p>Parquet的设计方案，整体来看，基本照搬了Dremel中对嵌套数据结构的打平和重构算法，通过高效的数据打平和重建算法，实现按列存储（列组），进而对列数据引入更具针对性的编码和压缩方案，来降低存储代价，提升计算性能。想要了解这一算法逻辑的，可以看Dremel的论文：<a href="http://research.google.com/pubs/pub36632.html" target="_blank" rel="noopener noreferrer">Dremel: Interactive Analysis of WebScaleDatasets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>从文件结构上来看，如下图所示：</p> <p><img src="/assets/img/180912163528362.efc796d7.png" alt="img"></p> <p>基本上就是一个文件由多个列组组成，数据先按列组（rowgroup）分段（也就是先做行切割），然后在列组内部对每个列的数据分列连续存储（columnchunk）（也就第二步做列切割），每个列内部的数据，再细分成page（可以近似的认为是再做行切割），最后，在文件的尾部，存储所有列组的元数据信息</p> <p>这么分层设计，从并发度的角度考虑，行切割的目的，主要做为任务的切分单元，比如一个Map任务处理一个列组里的数据。然后列切割的目的，除了按需读取数据，也是做为IO的并发单元。最后Page的拆分，主要是从编码和压缩的角度，进行拆分，以page为单位进行压缩编码，如果近似的理解，也可以认为一定程度上起到了内存和CPU上用量的控制，从Parquet文件的层面来说，Page是数据最小的读写单元。</p> <p>最后，对列数据提供多种编码方式，比如：字典（Dictionary)，游程（RLE），增量（DELTA）等等</p> <p>综上，Parquet主要还是对Dremel的存储模型这部分的一个实现，在Dremel存储模型定义范围之外，自己额外做的工作，并不多。（这里指的文件格式底层技术实现方面，工程上和大数据生态系各个组件的打通结合方面，还是做了大量的工作的）</p> <h3 id="orc"><a href="#orc" class="header-anchor">$</a> ORC</h3> <p>ORC(optimizedRC File) 存储源自RC(RecordCloimnar File)这种存储格式,RC是一种列式存储引擎,对schema演化(修改schema需要重新生成数据)支持较差,主要是在压缩编码,查询性能方面做了优化.RC/ORC最初是在Hive中得到使用,最后发展势头不错,独立成一个单独的项目.Hive1.xbanbendu版本对事物和update操作的支持,便是给予ORC实现的(其他存储格式暂不支持).
OCR发展到今天,已经具备一些非常高级的feature,比如支持update操作,支持ACID,支持struct,array复杂类型.你可以使用复杂类型构建一个类似parquet的嵌套式数据架构,但层数非常多时,写起来非常麻烦和复杂,而parquet提供的schema表达方式更容易表示出多级嵌套的数据类型.</p> <p>ORC文件格式的一些基础思想和Parquet很像，也是先按行水平切割，在按列垂直切割，针对不同的列，采用特定的编码格式，最后再进一步对编码后的数据进行压缩。支持的编码格式（游程，字典，增量，bit），压缩格式（zlib，snappy，LZO等等）也基本一致。</p> <p>一个ORC文件包含多个stripes（每个stripes由多组行数据组成的），一个包含辅助信息的file footer。在文件的结尾，一个postscript保存着压缩参数及被压缩的footer的长度。一个stripes缺省大小是250MB，其大小可以扩展的长度只受HDFS的约束。file footer包含文件中的一个记录stripes信息的列表、每个stripes中行的数目及每个列的数据类型，它也包含列级的聚合结果：count, min, max, and sum。</p> <p><img src="/assets/img/180912163528363.ecb73c59.png" alt="img"></p> <p>与Parquet不同的地方是，Parquet对嵌套型数据结构的打散和重构的算法，来源于Dremel，通过两种level信息(definition level,repetition level)来标识特定数据在数据结构中层次位置，这两种信息和具体的列数据直接绑定，仅依靠这些信息和对象整体的Schema就能重构出这一列信息原有的层次结构。</p> <p>而ORC的实现，更加简单直白一些，类似元素是否为Null的信息，就是一组bit位图，而对于元素个数不定的结构，如List，Map等数据结构，则在虚拟的父结构中维护了一个所拥有的子元素数量的信息。这样的带来的问题是，由单纯的某一叶节点列元素的数据出发，是无法独立构建复原出该列数据的结构层次的，需要借助父元素的辅助元数据才能完整复原。</p> <p>在实现中，ORC对于每个列（基本的或符合结构的）采用了多个Stream分别存储数据和上述各类元数据。</p> <p>比如String类型的列，如果使用字典编码，那么会生成4个stream，PRESENT Stream用来标识具体String元素是否为Null，DATA Stream，连续存储字符串自身，DICTIONARY_DATA Stream存储字典信息，LENGTH Stream存储每个元素的长度（用来从DATA Stream中定位和拆分数据）</p> <p><img src="/assets/img/180912163528364.62902ac8.png" alt="img"></p> <p>再比如Map类型的列，使用一个PRESENT Stream来标识具体每个Map元素是否为Null，用LENGTH
Stream来标识每个Map元素内部有几个对象</p> <p><img src="/assets/img/180912163528365.5dd8cf68.png" alt="img"></p> <p>这种处理方式对比Dremel，看起来的确老土很多，理论深度上被甩了不止一条街，不过如果对于嵌套层次不复杂的数据结构，也还是简单有效的。但是，ORC的风评最近感觉明显比Parquet要盛，这又是为什么呢？</p> <p>个人感觉，主要还是工程实现上的问题，除了核心的数据结构的打散和重建逻辑，ORC的文件格式里，还包含了其它的一些工程优化手段。比如索引（并不是传统意义上的全量排序用索引，更接近统计信息，比如列组的min，max，avg，count等信息，可以用作粗过滤手段，也可以覆盖部分聚合计算的需求），比如Bloomfilter等。而Parquet在这些方面有规划，但是目前似乎基本都没有做。</p> <p>另外，如果仅从Hive的角度来说，一方面ORC是亲儿子，有些工作开展得比较早，另一方面扁平的数据结构，让Parquet在支持嵌套数据结构方面的优势并不能很好的体现，大概也是原因之一吧。</p> <p>优势：</p> <ol><li>包含统计信息的索引和Bloomfilter，实现部分的谓词下推</li></ol> <p>劣势：</p> <ol><li>扁平的数据结构</li></ol> <h3 id="性能测试"><a href="#性能测试" class="header-anchor">$</a> 性能测试</h3> <p>写性能：而Parquet这边，压缩率方面看起来和ORC也没有很明显差距，小幅度的区别的原因应该还是具体Encoding和compress算法的区别。但是CPU耗时方面，明显高出RC和ORC，应该是列打散算法的消耗造成的，也不排除目前Parquet对Dremel算法的应用还有优化的空间。</p> <p>读性能：再看Parquet，还是同样的问题，CPU的耗时明显要偏高（尽管使用了比RC和ORC更快的Snappy压缩方式）</p> <h3 id="对比"><a href="#对比" class="header-anchor">$</a> 对比</h3> <table><thead><tr><th></th> <th>parquet</th> <th>orc</th></tr></thead> <tbody><tr><td>列编码</td> <td>支持多种：字典、RLE、delta编码等</td> <td>与parquet类似</td></tr> <tr><td>嵌套结构</td> <td>支持比较完美</td> <td>复杂，性能和空间损失大</td></tr> <tr><td>ACID</td> <td>不支持</td> <td>支持</td></tr> <tr><td>update操作</td> <td>不支持</td> <td>支持</td></tr> <tr><td>统计信息索引</td> <td>粗粒度，block/group/chunk级别</td> <td>粗粒度，file/stripe/row级别</td></tr></tbody></table> <blockquote><p><a href="http://bigdatastudy.net/show.aspx?id=571&amp;cid=9" target="_blank" rel="noopener noreferrer">Scala+Spark教程：RC ORC Parquet 格式比较和性能测试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://yq.aliyun.com/articles/226990" target="_blank" rel="noopener noreferrer">orc格式和parquet格式对比<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/jiangshouzhuang/article/details/51416744" target="_blank" rel="noopener noreferrer">Hive ORC和Parquet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.zhihu.com/question/29380943/answer/556258418" target="_blank" rel="noopener noreferrer">为什么列存储数据库读取速度会比传统的行数据库快？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">8/29/2020, 2:45:20 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/bigdata/hadoop/distcp.html" class="prev">
        Distcp命令
      </a></span> <span class="next"><a href="/bigdata/hadoop/avro_specification_1.8.1.html">
        avro格式规范1.8.1翻译
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.e5e86d4d.js" defer></script><script src="/assets/js/2.09d8812d.js" defer></script><script src="/assets/js/15.88324fac.js" defer></script>
  </body>
</html>
