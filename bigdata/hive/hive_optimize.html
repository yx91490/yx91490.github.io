<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hive优化 | yx91490的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.webp">
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QQHZM2VLM0');
window.addEventListener('load', function(){ var s = document.createElement('script'); s.src = "https://www.googletagmanager.com/gtag/js?id=G-QQHZM2VLM0"; document.body.appendChild(s); });</script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6781d2ac2dff1f3b278518419b4d4deb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <meta name="description" content="java, 大数据(hadoop, sqoop, kylin, zeppelin)相关技术, 工作经验记录">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="google-site-verification" content="j1Gm2ZeMV3D7mPiI08fpx91dEOSlhCAJjD4vy_pSroQ">
    <meta name="baidu-site-verification" content="4z2bGbjYMB">
    
    <link rel="preload" href="/assets/css/0.styles.003598ab.css" as="style"><link rel="preload" href="/assets/js/app.a2246195.js" as="script"><link rel="preload" href="/assets/js/2.a92520c9.js" as="script"><link rel="preload" href="/assets/js/66.8e4764ed.js" as="script"><link rel="prefetch" href="/assets/js/10.9266ea66.js"><link rel="prefetch" href="/assets/js/100.be2d6fa9.js"><link rel="prefetch" href="/assets/js/101.6bf96f53.js"><link rel="prefetch" href="/assets/js/102.b9123862.js"><link rel="prefetch" href="/assets/js/103.3393f6b3.js"><link rel="prefetch" href="/assets/js/104.684c4331.js"><link rel="prefetch" href="/assets/js/105.50f83af8.js"><link rel="prefetch" href="/assets/js/106.af1be028.js"><link rel="prefetch" href="/assets/js/107.03a88e14.js"><link rel="prefetch" href="/assets/js/108.3c9beac7.js"><link rel="prefetch" href="/assets/js/109.1cc12551.js"><link rel="prefetch" href="/assets/js/11.abfb5926.js"><link rel="prefetch" href="/assets/js/110.6496c428.js"><link rel="prefetch" href="/assets/js/111.441b5c62.js"><link rel="prefetch" href="/assets/js/112.c176e7aa.js"><link rel="prefetch" href="/assets/js/113.22b25ffa.js"><link rel="prefetch" href="/assets/js/114.0470f0e2.js"><link rel="prefetch" href="/assets/js/115.133edcde.js"><link rel="prefetch" href="/assets/js/116.5de552b8.js"><link rel="prefetch" href="/assets/js/117.17a14c4a.js"><link rel="prefetch" href="/assets/js/118.c79d4a77.js"><link rel="prefetch" href="/assets/js/119.3a636690.js"><link rel="prefetch" href="/assets/js/12.274720a3.js"><link rel="prefetch" href="/assets/js/120.41a0252a.js"><link rel="prefetch" href="/assets/js/121.18dd56cb.js"><link rel="prefetch" href="/assets/js/122.dcc6fff9.js"><link rel="prefetch" href="/assets/js/123.3e8dd2b0.js"><link rel="prefetch" href="/assets/js/124.c469f9a0.js"><link rel="prefetch" href="/assets/js/125.eb8238e4.js"><link rel="prefetch" href="/assets/js/126.c8b54275.js"><link rel="prefetch" href="/assets/js/127.a9895d7f.js"><link rel="prefetch" href="/assets/js/128.ad16504e.js"><link rel="prefetch" href="/assets/js/129.673ac57e.js"><link rel="prefetch" href="/assets/js/13.473bd291.js"><link rel="prefetch" href="/assets/js/130.9e56a52b.js"><link rel="prefetch" href="/assets/js/131.5423b009.js"><link rel="prefetch" href="/assets/js/132.6438550e.js"><link rel="prefetch" href="/assets/js/133.083d70f2.js"><link rel="prefetch" href="/assets/js/134.80f4d86d.js"><link rel="prefetch" href="/assets/js/135.0368a605.js"><link rel="prefetch" href="/assets/js/136.65c70e71.js"><link rel="prefetch" href="/assets/js/137.676f7436.js"><link rel="prefetch" href="/assets/js/138.d3c68759.js"><link rel="prefetch" href="/assets/js/139.f163f9ac.js"><link rel="prefetch" href="/assets/js/14.4157d143.js"><link rel="prefetch" href="/assets/js/140.0eb4db22.js"><link rel="prefetch" href="/assets/js/141.91c9c472.js"><link rel="prefetch" href="/assets/js/142.ac3a9a62.js"><link rel="prefetch" href="/assets/js/143.156c5dd3.js"><link rel="prefetch" href="/assets/js/144.9117b752.js"><link rel="prefetch" href="/assets/js/145.bf4177dc.js"><link rel="prefetch" href="/assets/js/146.a4e70b4c.js"><link rel="prefetch" href="/assets/js/147.e7503515.js"><link rel="prefetch" href="/assets/js/148.550bb88e.js"><link rel="prefetch" href="/assets/js/149.a3efa6a5.js"><link rel="prefetch" href="/assets/js/15.78885f92.js"><link rel="prefetch" href="/assets/js/150.2b8684be.js"><link rel="prefetch" href="/assets/js/151.723ee132.js"><link rel="prefetch" href="/assets/js/152.2e61447b.js"><link rel="prefetch" href="/assets/js/153.a87224a2.js"><link rel="prefetch" href="/assets/js/154.45b73d0e.js"><link rel="prefetch" href="/assets/js/155.2a158d8e.js"><link rel="prefetch" href="/assets/js/156.6d290334.js"><link rel="prefetch" href="/assets/js/157.dc0ac8e3.js"><link rel="prefetch" href="/assets/js/158.ad8be92a.js"><link rel="prefetch" href="/assets/js/159.17aa0be5.js"><link rel="prefetch" href="/assets/js/16.e9de9925.js"><link rel="prefetch" href="/assets/js/160.f1c672b5.js"><link rel="prefetch" href="/assets/js/161.fced35d3.js"><link rel="prefetch" href="/assets/js/162.14034b66.js"><link rel="prefetch" href="/assets/js/163.b7b22626.js"><link rel="prefetch" href="/assets/js/164.c979848e.js"><link rel="prefetch" href="/assets/js/165.f3b605f4.js"><link rel="prefetch" href="/assets/js/166.31241d54.js"><link rel="prefetch" href="/assets/js/167.99665073.js"><link rel="prefetch" href="/assets/js/168.73a40652.js"><link rel="prefetch" href="/assets/js/169.c6b27f11.js"><link rel="prefetch" href="/assets/js/17.8b238f2d.js"><link rel="prefetch" href="/assets/js/170.9356cc22.js"><link rel="prefetch" href="/assets/js/171.f8f9eeeb.js"><link rel="prefetch" href="/assets/js/172.31967fe5.js"><link rel="prefetch" href="/assets/js/173.6dc70b37.js"><link rel="prefetch" href="/assets/js/174.bad7f12b.js"><link rel="prefetch" href="/assets/js/175.03194976.js"><link rel="prefetch" href="/assets/js/176.5c7853ba.js"><link rel="prefetch" href="/assets/js/177.fc5d3911.js"><link rel="prefetch" href="/assets/js/178.1b8f2927.js"><link rel="prefetch" href="/assets/js/179.7e2010d2.js"><link rel="prefetch" href="/assets/js/18.be942caa.js"><link rel="prefetch" href="/assets/js/180.7fc4904d.js"><link rel="prefetch" href="/assets/js/181.3aa48343.js"><link rel="prefetch" href="/assets/js/182.0da27206.js"><link rel="prefetch" href="/assets/js/183.ea56bc10.js"><link rel="prefetch" href="/assets/js/184.1ba34ef7.js"><link rel="prefetch" href="/assets/js/185.ef514255.js"><link rel="prefetch" href="/assets/js/186.10a22983.js"><link rel="prefetch" href="/assets/js/187.24412415.js"><link rel="prefetch" href="/assets/js/188.9e67f04e.js"><link rel="prefetch" href="/assets/js/189.1a001954.js"><link rel="prefetch" href="/assets/js/19.41661090.js"><link rel="prefetch" href="/assets/js/190.938fd53d.js"><link rel="prefetch" href="/assets/js/191.6036e1aa.js"><link rel="prefetch" href="/assets/js/192.20aaab8b.js"><link rel="prefetch" href="/assets/js/193.1b7ea98e.js"><link rel="prefetch" href="/assets/js/194.1170ccd0.js"><link rel="prefetch" href="/assets/js/195.2da46799.js"><link rel="prefetch" href="/assets/js/196.8c38b115.js"><link rel="prefetch" href="/assets/js/197.c1f360eb.js"><link rel="prefetch" href="/assets/js/198.ab460869.js"><link rel="prefetch" href="/assets/js/199.58b8a906.js"><link rel="prefetch" href="/assets/js/20.7dbafc6d.js"><link rel="prefetch" href="/assets/js/200.a9de3e1c.js"><link rel="prefetch" href="/assets/js/201.9c11ec9b.js"><link rel="prefetch" href="/assets/js/202.31a20041.js"><link rel="prefetch" href="/assets/js/203.561fefc2.js"><link rel="prefetch" href="/assets/js/204.e044c696.js"><link rel="prefetch" href="/assets/js/205.4d437cf2.js"><link rel="prefetch" href="/assets/js/206.074913eb.js"><link rel="prefetch" href="/assets/js/207.f582a2d4.js"><link rel="prefetch" href="/assets/js/208.34c09bd0.js"><link rel="prefetch" href="/assets/js/21.4e3c7f50.js"><link rel="prefetch" href="/assets/js/22.cda475a6.js"><link rel="prefetch" href="/assets/js/23.6677c452.js"><link rel="prefetch" href="/assets/js/24.2e483650.js"><link rel="prefetch" href="/assets/js/25.32b8e5f5.js"><link rel="prefetch" href="/assets/js/26.c63edd69.js"><link rel="prefetch" href="/assets/js/27.6462a4d2.js"><link rel="prefetch" href="/assets/js/28.39745e0d.js"><link rel="prefetch" href="/assets/js/29.3ce79aa0.js"><link rel="prefetch" href="/assets/js/3.cd488c94.js"><link rel="prefetch" href="/assets/js/30.c3c07fa8.js"><link rel="prefetch" href="/assets/js/31.b441fe2c.js"><link rel="prefetch" href="/assets/js/32.9d627aa9.js"><link rel="prefetch" href="/assets/js/33.0a131b8b.js"><link rel="prefetch" href="/assets/js/34.e589c02b.js"><link rel="prefetch" href="/assets/js/35.b905220f.js"><link rel="prefetch" href="/assets/js/36.1451544a.js"><link rel="prefetch" href="/assets/js/37.8e64b501.js"><link rel="prefetch" href="/assets/js/38.ac5585b7.js"><link rel="prefetch" href="/assets/js/39.b7d08e4d.js"><link rel="prefetch" href="/assets/js/4.76c12804.js"><link rel="prefetch" href="/assets/js/40.1e627739.js"><link rel="prefetch" href="/assets/js/41.296baa8a.js"><link rel="prefetch" href="/assets/js/42.e762bf53.js"><link rel="prefetch" href="/assets/js/43.0c8916ee.js"><link rel="prefetch" href="/assets/js/44.fb27d611.js"><link rel="prefetch" href="/assets/js/45.a5c6e285.js"><link rel="prefetch" href="/assets/js/46.c00ec7b1.js"><link rel="prefetch" href="/assets/js/47.924f6a63.js"><link rel="prefetch" href="/assets/js/48.da552f4a.js"><link rel="prefetch" href="/assets/js/49.d4b2e85f.js"><link rel="prefetch" href="/assets/js/5.43a1b6a5.js"><link rel="prefetch" href="/assets/js/50.b0cbb861.js"><link rel="prefetch" href="/assets/js/51.d53173dc.js"><link rel="prefetch" href="/assets/js/52.cec22911.js"><link rel="prefetch" href="/assets/js/53.856b0cbd.js"><link rel="prefetch" href="/assets/js/54.a949b4ab.js"><link rel="prefetch" href="/assets/js/55.8b1c4821.js"><link rel="prefetch" href="/assets/js/56.075464d0.js"><link rel="prefetch" href="/assets/js/57.edeffd0c.js"><link rel="prefetch" href="/assets/js/58.f17ca774.js"><link rel="prefetch" href="/assets/js/59.83a509b9.js"><link rel="prefetch" href="/assets/js/6.8c8eb26f.js"><link rel="prefetch" href="/assets/js/60.b2ac681b.js"><link rel="prefetch" href="/assets/js/61.06292aef.js"><link rel="prefetch" href="/assets/js/62.efb1d9ca.js"><link rel="prefetch" href="/assets/js/63.c621ff20.js"><link rel="prefetch" href="/assets/js/64.fd7d869b.js"><link rel="prefetch" href="/assets/js/65.d6e18805.js"><link rel="prefetch" href="/assets/js/67.39c5f354.js"><link rel="prefetch" href="/assets/js/68.01631967.js"><link rel="prefetch" href="/assets/js/69.21c55f66.js"><link rel="prefetch" href="/assets/js/7.811e798c.js"><link rel="prefetch" href="/assets/js/70.d93f9ac4.js"><link rel="prefetch" href="/assets/js/71.edff7b32.js"><link rel="prefetch" href="/assets/js/72.58f44a0d.js"><link rel="prefetch" href="/assets/js/73.945f295a.js"><link rel="prefetch" href="/assets/js/74.8ca95c7a.js"><link rel="prefetch" href="/assets/js/75.2bda719a.js"><link rel="prefetch" href="/assets/js/76.160188c6.js"><link rel="prefetch" href="/assets/js/77.13d44a5c.js"><link rel="prefetch" href="/assets/js/78.bc9b4703.js"><link rel="prefetch" href="/assets/js/79.51f0cbe9.js"><link rel="prefetch" href="/assets/js/8.b01cfa02.js"><link rel="prefetch" href="/assets/js/80.d5ee7d7e.js"><link rel="prefetch" href="/assets/js/81.a8cb1bb1.js"><link rel="prefetch" href="/assets/js/82.f2466831.js"><link rel="prefetch" href="/assets/js/83.42e24b89.js"><link rel="prefetch" href="/assets/js/84.f11efdd6.js"><link rel="prefetch" href="/assets/js/85.dfb94ac5.js"><link rel="prefetch" href="/assets/js/86.b722d02e.js"><link rel="prefetch" href="/assets/js/87.50dfa4f1.js"><link rel="prefetch" href="/assets/js/88.1f1be810.js"><link rel="prefetch" href="/assets/js/89.9c872859.js"><link rel="prefetch" href="/assets/js/9.6643bf27.js"><link rel="prefetch" href="/assets/js/90.b45fd9d8.js"><link rel="prefetch" href="/assets/js/91.abf3f5f6.js"><link rel="prefetch" href="/assets/js/92.c4da0439.js"><link rel="prefetch" href="/assets/js/93.ee4705d1.js"><link rel="prefetch" href="/assets/js/94.b5887f79.js"><link rel="prefetch" href="/assets/js/95.1950dbcb.js"><link rel="prefetch" href="/assets/js/96.7fbdc57f.js"><link rel="prefetch" href="/assets/js/97.4e371474.js"><link rel="prefetch" href="/assets/js/98.acbe433f.js"><link rel="prefetch" href="/assets/js/99.358cb13a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.003598ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">yx91490的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Zeppelin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/zeppelin/heart_diease_dataset.html" class="sidebar-link">心脏病预测数据</a></li><li><a href="/bigdata/zeppelin/zeppelin_bugs.html" class="sidebar-link">zeppelin使用趟坑</a></li><li><a href="/bigdata/zeppelin/zeppelin_sharding.html" class="sidebar-link">Zeppelin v0.8分片方案</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Calcite</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/calcite/calcite.html" class="sidebar-link">Apache Calcite学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DataX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/datax/datax.html" class="sidebar-link">DataX源码学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Waterdrop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/waterdrop/waterdrop.html" class="sidebar-link">Waterdrop学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Kylin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/kylin/awesome_kylin.html" class="sidebar-link">Kylin学习资料汇总</a></li><li><a href="/bigdata/kylin/read_kylin_source.html" class="sidebar-link">阅读Kylin源码</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Sqoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/sqoop/sqoop_usage.html" class="sidebar-link">代码调试</a></li><li><a href="/bigdata/sqoop/sqoop_hcatalog.html" class="sidebar-link">sqoopHCatalog使用</a></li><li><a href="/bigdata/sqoop/sqoop_mysql_temp_file.html" class="sidebar-link">sqoop导入导致MySQL产生大临时文件问题排查</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ZooKeeper</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/zookeeper/zookeeper.html" class="sidebar-link">ZooKeeper笔记</a></li><li><a href="/bigdata/zookeeper/zookeeper_user.html" class="sidebar-link">ZooKeeper管理员指南</a></li><li><a href="/bigdata/zookeeper/zk_distribute_lock.html" class="sidebar-link">zookeeper实现分布式锁</a></li><li><a href="/bigdata/zookeeper/isbn9787111524311_note.html" class="sidebar-link">《ZooKeeper分布式过程协同技术详解》笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Hadoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hadoop/hadoop_interview.html" class="sidebar-link">Hadoop面试题</a></li><li><a href="/bigdata/hadoop/port.html" class="sidebar-link">Hadoop默认端口</a></li><li><a href="/bigdata/hadoop/hdfs_user.html" class="sidebar-link">HDFS命令笔记</a></li><li><a href="/bigdata/hadoop/hdfs_issue.html" class="sidebar-link">HDFS Issue</a></li><li><a href="/bigdata/hadoop/distcp.html" class="sidebar-link">Distcp命令</a></li><li><a href="/bigdata/hadoop/columnar_storage_parquet_orc.html" class="sidebar-link">列式存储（parquet,orc）</a></li><li><a href="/bigdata/hadoop/avro_specification_1.8.1.html" class="sidebar-link">avro格式规范1.8.1翻译</a></li><li><a href="/bigdata/hadoop/yarn.html" class="sidebar-link">Yarn</a></li><li><a href="/bigdata/hadoop/yarn_cli.html" class="sidebar-link">Yarn Cli命令</a></li><li><a href="/bigdata/hadoop/mapreduce.html" class="sidebar-link">MapReduce</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Hive</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hive/hive_cli.html" class="sidebar-link">Beeline命令行</a></li><li><a href="/bigdata/hive/hive_src.html" class="sidebar-link">Hive源码分析</a></li><li><a href="/bigdata/hive/hive_ql.html" class="sidebar-link">HiveQL</a></li><li><a href="/bigdata/hive/hive_data_type.html" class="sidebar-link">Hive数据类型</a></li><li><a href="/bigdata/hive/hive_bucket.html" class="sidebar-link">Hive分桶</a></li><li><a href="/bigdata/hive/hive_principle.html" class="sidebar-link">Hive原理</a></li><li><a href="/bigdata/hive/hive_optimize.html" aria-current="page" class="active sidebar-link">Hive优化</a></li><li><a href="/bigdata/hive/hive_parse_json.html" class="sidebar-link">Hive解析json数组</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>OLAP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/olap/olap.html" class="sidebar-link">OLAP笔记</a></li><li><a href="/bigdata/olap/data_analyze.html" class="sidebar-link">数据分析笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ClickHouse</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/clickhouse/clickhouse.html" class="sidebar-link">ClickHouse学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Doris</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/doris/doris.html" class="sidebar-link">Doris笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Kudu</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/kudu/kudu.html" class="sidebar-link">Kudu</a></li><li><a href="/bigdata/kudu/kudu_paper.html" class="sidebar-link">Kudu: Storage for Fast Analytics on Fast Data</a></li><li><a href="/bigdata/kudu/kudu_paper_translation.html" class="sidebar-link">【译】Kudu论文</a></li><li><a href="/bigdata/kudu/kudu_note.html" class="sidebar-link">Kudu笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Impala</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/impala/cup.html" class="sidebar-link">CUP学习笔记</a></li><li><a href="/bigdata/impala/impala.html" class="sidebar-link">Impala</a></li><li><a href="/bigdata/impala/impala_admin.html" class="sidebar-link">Impala运维</a></li><li><a href="/bigdata/impala/impala_dev.html" class="sidebar-link">Impala开发笔记</a></li><li><a href="/bigdata/impala/impala_community.html" class="sidebar-link">Impala社区</a></li><li><a href="/bigdata/impala/impala_issues.html" class="sidebar-link">Impala问题记录</a></li><li><a href="/bigdata/impala/impala_paper_translation.html" class="sidebar-link">【转】【译】Impala：Hadoop上的一个现代开源SQL引擎</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spark</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/spark/spark.html" class="sidebar-link">Spark</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HBase</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hbase/hbase_interview.html" class="sidebar-link">HBase</a></li><li><a href="/bigdata/hbase/hbase_user.html" class="sidebar-link">HBase使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/note/oss_note.html" class="sidebar-link">《快手短视频打造高稳定千亿级别对象存储平台》笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hive优化"><a href="#hive优化" class="header-anchor">$</a> Hive优化</h1> <h3 id="调优目标"><a href="#调优目标" class="header-anchor">$</a> 调优目标</h3> <p>Hive调优的目标是：在不影响其他业务正常运行的前提下，最大限度利用集群的物理资源，如CPU、内存、磁盘IO，使其某一项达到瓶颈。</p> <h3 id="调优原则"><a href="#调优原则" class="header-anchor">$</a> 调优原则</h3> <p>1、保证map扫描的数据量尽量少</p> <p>减少map端扫描数量，需要控制待处理的表文件或中间文件的数据量尽量少。<br>
优化的方式如：Hive表文件使用高效的文件格式、Hive表文件使用合适的文件压缩格式、中间文件使用合适的文件压缩格式、利用列裁剪、利用分区裁剪、使用分桶。</p> <p>2、保证map传送给reduce的数据量尽量小</p> <p>控制map传送给reduce的数据量，是指JOIN避免笛卡尔积、启动谓词下推、开启map端聚合功能。</p> <p>3、保证map和reduce处理的数据量尽量均衡</p> <p>保证map处理的数据量尽量均衡，是指使用Hive合并输入格式、必要时对小文件进行合并。<br>
保证reduce处理的数据量尽量均衡，是指解决数据倾斜问题。包括解决group by造成的数据倾斜、解决join造成的数据倾斜。</p> <p>4、合理调整map和reduce占用的计算资源</p> <p>合理调整map和reduce占用的计算资源，是指通过参数设置合理调整map和reduce的内存及虚拟核数。<br>
根据集群总体资源情况，以及分配给当前租户的资源情况，在不影响其他业务正常运行的条件下，最大限度地利用可使用的计算资源。</p> <p>5、合理调整map和reduce的数量</p> <p>合理调整map数，是指通过设置每个map处理数据量的最大和最小值来合理控制map的数量。<br>
合理调整reduce数，是指通过直接设置reduce数量或通过设置每个reduce的处理数据量来合理控制reduce的数量。</p> <p>6、重用计算结果</p> <p>重用计算结果，是指将重复的子查询结果保存到中间表，供其他查询使用，减少重复计算，节省计算资源。</p> <p>7、使用稳定成熟的Hive优化特性</p> <p>使用稳定成熟的Hive优化特性，包括：</p> <ol><li>相关性优化器（CorrelationOptimizer）</li> <li>基于代价的优化（Cost-based optimization）</li> <li>向量化查询引擎（Vectorized Query Execution）</li> <li>Join相关优化（Map Join、SMB Join）</li> <li>Multiple Insert特性</li> <li>TABLESAMPLE抽样查询</li> <li>Limit优化</li> <li>局部排序（SORT BY、 DISTRIBUTE BY）</li></ol> <p>8、使用高效HQL或改用MR</p> <p>使用高效HQL，包括慎用低性能的UDF和SerDe、优化count(distinct)。<br>
对于使用HQL比较冗余同时性能低下的场景，在充分理解业务需求后，改用MR效率更高。</p> <h3 id="调优手段"><a href="#调优手段" class="header-anchor">$</a> 调优手段</h3> <p><strong>1、利用分区裁剪、列裁剪</strong></p> <p>当待查询的表字段较多时，选取需要使用的字段进行查询，避免直接select *出大表的所有字段，以免当使用Beeline查询时控制台输出缓冲区被大数据量撑爆。</p> <p>在分区剪裁中，当使用外关联时，如果将副表的过滤条件写在Where后面，那么就会先全表关联，之后再过滤，比如：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>id
<span class="token keyword">FROM</span> lxw1234_a a
<span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> t_lxw1234_partitioned b
<span class="token keyword">ON</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">WHERE</span> b<span class="token punctuation">.</span><span class="token keyword">day</span> <span class="token operator">=</span> ‘<span class="token number">2015</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">10</span>′
<span class="token comment">-- 正确的写法是写在ON后面：</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>id
<span class="token keyword">FROM</span> lxw1234_a a
<span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> t_lxw1234_partitioned b
<span class="token keyword">ON</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>url <span class="token operator">AND</span> b<span class="token punctuation">.</span><span class="token keyword">day</span> <span class="token operator">=</span> ‘<span class="token number">2015</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">10</span>′<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">--或者直接写成子查询：</span>
<span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>id
<span class="token keyword">FROM</span> lxw1234_a a
<span class="token keyword">left</span> <span class="token keyword">outer</span> <span class="token keyword">join</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> url <span class="token keyword">FROM</span> t_lxw1234_partitioned <span class="token keyword">WHERE</span> <span class="token keyword">day</span> <span class="token operator">=</span> ‘<span class="token number">2015</span><span class="token operator">-</span><span class="token number">05</span><span class="token operator">-</span><span class="token number">10</span>′<span class="token punctuation">)</span> b
<span class="token keyword">ON</span> <span class="token punctuation">(</span>a<span class="token punctuation">.</span>id <span class="token operator">=</span> b<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
</code></pre></div><p><strong>2、JOIN避免笛卡尔积</strong></p> <p>JOIN场景应严格避免出现笛卡尔积的情况。参与笛卡尔积JOIN的两个表，交叉关联后的数据条数是两个原表记录数之积，对于JOIN后还有聚合的场景而言，会导致reduce端处理的数据量暴增，极大地影响运行效率。</p> <div class="language- extra-class"><pre class="language-text"><code>//笛卡尔积
select a.* from a join b; 
//正常Join
select a.* from a join b on a.key = b.key; 
</code></pre></div><p><strong>3、启动谓词下推</strong></p> <p>谓词下推（Predicate Pushdown）是一个逻辑优化：尽早的对底层数据进行过滤以减少后续需要处理的数据量。通过以下参数启动谓词下推。</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.optimize.ppd=true;
</code></pre></div><p><strong>4、开启Map端聚合功能</strong></p> <p>在map中会做部分聚集操作，能够使map传送给reduce的数据量大大减少，从而在一定程度上减轻group by带来的数据倾斜。通过以下参数开启map端聚合功能。</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.map.aggr=true;
</code></pre></div><p><strong>5、使用Hive合并输入格式</strong></p> <p>设置Hive合并输入格式，使Hive在执行map前进行文件合并，使得本轮map处理数据量均衡。通过以下参数设置Hive合并输入格式。</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.input.format=org.apache.Hadoop.hive.ql.io.CombineHiveInputFormat;
</code></pre></div><p><strong>6、合并小文件</strong></p> <p>启动较多的map或reduce能够提高并发度，加快任务运行速度；但同时在HDFS上生成的文件数目也会越来越多，给HDFS的NameNode造成内存上压力，进而影响HDFS读写效率。对于集群的小文件（主要由Hive启动的MR生成）过多已造成NameNode压力时，建议在Hive启动的MR中启动小文件合并。小文件合并能够使本轮map输出及整个任务输出的文件完成合并，保证下轮MapReduce任务map处理数据量均衡。</p> <p><strong>7、解决group by造成的数据倾斜</strong></p> <p>通过开启group by倾斜优化开关，解决group by数据倾斜问题。  开启优化开关后group by会启动两个MR。第一个 MR Job 中，Map 的输出结果集合会随机分布到 Reduce 中，每个Reduce做部分聚合操作，并输出结果，这样处理的结果是相同的Group By Key有可能被分发到不同的Reduce中，从而达到负载均衡的目的；第二个MR Job再根据预处理的数据结果按照Group By Key分布到Reduce中（这个过程可以保证相同的Group By Key被分布到同一个Reduce中），最后完成最终的聚合操作。</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.groupby.skewindata = true;
//这个是group的键对应的记录条数超过这个值则会进行分拆,值根据具体数据量设置
set hive.groupby.mapaggr.checkinterval=100000 ;
</code></pre></div><p>存在大量空值或NULL，或者某一个值的记录特别多，可以先把该值过滤掉，在最后单独处理。比如某一天的IMEI值为’lxw1234’的特别多，当我要统计总的IMEI数，可以先统计不为’lxw1234’的，之后再加1:</p> <div class="language- extra-class"><pre class="language-text"><code>SELECT CAST(COUNT(DISTINCT imei)+1 AS bigint)
FROM lxw1234 where pt = ‘2012-05-28′
AND imei &lt;&gt; ‘lxw1234′ ;
</code></pre></div><p>多重COUNT DISTINCT通常使用UNION ALL + ROW_NUMBER() + SUM + GROUP BY来变通实现。???</p> <p><strong>8、解决Join造成的数据倾斜</strong></p> <p>两个表关联键的数据分布倾斜，会形成Skew Join。<br>
解决方案是将这类倾斜的特殊值（记录数超过hive.skewjoin.key参数值）不落入reduce计算，而是先写入HDFS，然后再启动一轮MapJoin专门做这类特殊值的计算，期望能提高计算这部分值的处理速度。设置以下参数。</p> <div class="language- extra-class"><pre class="language-text"><code>//如果是join 过程出现倾斜 应该设置为true
set hive.optimize.skewjoin=true;
//join的键对应的记录条数超过这个值则会进行分拆
set hive.skewjoin.key=100000;
</code></pre></div><p>关联键存在大量空值或者某一特殊值如&quot;NULL&quot;：</p> <ol><li>空值单独处理，不参与关联；</li> <li>空值或特殊值加随机数作为关联键；</li></ol> <p>不同数据类型的字段关联：</p> <ol><li>转换为同一数据类型之后再做关联</li></ol> <p><strong>9、合理调整map和reduce的内存及虚拟核数</strong></p> <p>map和reduce的内存及虚拟核数设置，决定了集群资源所能同时启动的container个数，影响集群并行计算的能力。</p> <ol><li><p>对于当前任务是CPU密集型任务（如复杂数学计算）的场景：在map和reduce的虚拟核数默认值基础上，逐渐增大虚拟核数进行调试（mapreduce.map.cpu.vcores和mapreduce.reduce.cpu.vcores参数控制），但不要超过可分配给container的虚拟核数（yarn.nodemanager.resource.cpu-vcores参数控制）。</p></li> <li><p>对于当前任务是内存密集型任务（如ORC文件读取/写入、全局排序）的场景：在map和reduce的内存默认值基础上，逐渐增大内存值进行调试（mapreduce.map.memory.mb和mapreduce.reduce.memory.mb参数控制），但不要超过当前NodeManager上可运行的所有容器的物理内存总大小（yarn.nodemanager.resource.memory-mb参数控制）。</p></li></ol> <p><strong>10、合理控制map的数量</strong></p> <p>map的数量会影响MapReduce扫描、过滤数据的效率。对于扫描、过滤数据的逻辑比较复杂、输入数据量较大条数较多的场景：根据集群总体资源情况，以及分配给当前租户的资源情况，在不影响其他业务正常运行的条件下，map数量需要适当增大，增加并行处理的力度。</p> <p><strong>11、合理控制reduce的数量</strong></p> <p>reduce数量会影响MapReduce过滤、聚合、对数据排序的效率。对于关联、聚合、排序时reduce端待处理数据量较大的场景：首先根据每个reduce处理的合适数据量控制reduce的个数，如果每个reduce处理数据仍然很慢，再考虑设置参数增大reduce个数。另一方面，控制能启动的reduce最大个数为分配给当前租户的资源上限，以免影响其他业务的正常运行。</p> <p><strong>12、将重复的子查询结果保存到中间表</strong></p> <p>对于指标计算类型的业务场景，多个指标的HQL语句中可能存在相同的子查询，为避免重复计算浪费计算资源，考虑将重复的子查询的计算结果保存到中间表，实现计算一次、结果共享的优化目标。</p> <p><strong>13、启用相关性优化器</strong></p> <p>相关性优化，旨在利用下面两种查询的相关性：</p> <p>（a）输入相关性：在原始operator树中，同一个输入表被多个MapReduce任务同时使用的场景；</p> <p>（b）作业流程的相关性：两个有依赖关系的MapReduce的任务的shuffle方式相同。</p> <p>通过以下参数启用相关性优化：</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.optimize.correlation=true;
</code></pre></div><p><strong>14、启用基于代价的优化</strong></p> <p>基于代价的优化器，可以基于代价（包括FS读写、CPU、IO等）对查询计划进行进一步的优化选择，提升Hive查询的响应速度。通过以下参数启用基于代价的优化：</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.cbo.enable=true;
</code></pre></div><p><strong>15、启用向量化查询引擎</strong></p> <p>传统方式中，对数据的处理是以行为单位，依次处理的。Hive也采用了这种方案。这种方案带来的问题是，针对每一行数据，都要进行数据解析，条件判断，方法调用等操作，从而导致了低效的CPU利用。向量化特性，通过每次处理1024行数据，列方式处理，从而减少了方法调用，降低了CPU消耗，提高了CPU利用率。结合JDK1.8对SIMD的支持，获得了极高的性能提升。通过以下参数启用向量化查询引擎：</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.vectorized.execution.enabled=true;
</code></pre></div><p><strong>16、启用Join相关优化</strong></p> <p>（a）使用MapJoin。MapJoin是针对以下场景进行的优化：两个待连接表中，有一个表非常大，而另一个表非常小，以至于小表可以直接存放到内存中。这样小表复制多份，在每个map task内存中存在一份（比如存放到hash table中），然后只扫描大表。对于大表中的每一条记录key/value，在hash table中查找是否有相同的key的记录，如果有，则连接后输出即可。</p> <p>（b）使用SMB Join。</p> <p><strong>17、使用Multiple Insert特性</strong></p> <p>以下左图为普通insert，右图为Multiple Insert，减少了MR个数，提升了效率。</p> <div class="language- extra-class"><pre class="language-text"><code>INSERT OVERWRITE TABLE E1
SELECT KEY, COUNT(*)
FROM SRC
WHERE KEY &gt; 450
GROUP BY KEY;
INSERT OVERWRITE TABLE E2
SELECT KEY, COUNT(*)
FROM SRC
WHERE KEY &gt; 500
GROUP BY KEY;
--------------------
FROM SRC
INSERT OVERWRITE TABLE E1
SELECT KEY, COUNT(*)
WHERE KEY &gt; 450
GROUP BY KEY
INSERT OVERWRITE TABLE E2
SELECT KEY, COUNT(*)
WHERE KEY &gt; 500
GROUP BY KEY
</code></pre></div><p>但是对同一张表的union all要比multi insert快的多。http://superlxw1234.iteye.com/blog/1536440</p> <p><strong>18、使用TABLESAMPLE取样查询</strong></p> <p>在Hive中提供了数据取样（SAMPLING）的功能，用来从Hive表中根据一定的规则进行数据取样，Hive中的数据取样支持数据块取样和分桶表取样。</p> <p>以下左图为数据块取样，右图为分桶表取样：</p> <div class="language- extra-class"><pre class="language-text"><code>CREATE TABLE HALF AS
SELECT * FROM SRC
TABLESAMPLE (50 PERCENT);

SELECT COUNT（*)
FROM NON_BUCKET_TABLE TABLESAMPLE(BUCKET 1 OUT OF 10 ON RAND());
</code></pre></div><p><strong>19、启用Limit优化</strong></p> <p>启用limit优化后，使用limit不再是全表查出，而是抽样查询。涉及参数如下：</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.limit.optimize.enable=true;
set hive.limit.row.max.size=100000;
set hive.limit.optimize.limit.file=10;
</code></pre></div><p><strong>20、利用局部排序</strong></p> <p>Hive中使用order by完成全局排序，正常情况下，order by所启动的MR仅有一个reducer，这使得大数据量的表在全局排序时非常低效和耗时。当全局排序为非必须的场景时，可以使用sort by在每个reducer范围进行内部排序。同时可以使用distribute by控制每行记录分配到哪个reducer。</p> <p><strong>21、慎用低性能的UDF和SerDe</strong></p> <p>慎用低性能的UDF和SerDe，主要指谨慎使用正则表达式类型的UDF和SerDe。如：regexp、regexp_extract、regexp_replace、rlike、RegexSerDe。</p> <p>当待处理表的条数很多时，如上亿条，采用诸如<code>([^ ]*)([^ ]*)([^ ]*)(.?)(&quot;.*?&quot;)(-|[0-9]*)(-|[0-9]*)(&quot;.*?&quot;)(&quot;.*?&quot;)</code>这种复杂类型的正则表达式组成过滤条件去匹配记录，会严重地影响map阶段的过滤速度。</p> <p>建议在充分理解业务需求后，自行编写更高效准确的UDF实现相应的功能。</p> <p><strong>22、优化count(distinct)</strong></p> <p>优化方式如下，左图为原始HQL，右图为优化后HQL。</p> <div class="language- extra-class"><pre class="language-text"><code>SELECT COUNT（DISTINCT record) FROM t;
SELECT COUNT(*) FROM (SELECT  DISTINCT record FROM t) s;
</code></pre></div><p>一般COUNT DISTINCT使用先GROUP BY再COUNT的方式替换：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">day</span><span class="token punctuation">,</span>
<span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">DISTINCT</span> id<span class="token punctuation">)</span> <span class="token keyword">AS</span> uv
<span class="token keyword">FROM</span> lxw1234
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">day</span>
<span class="token comment">-- 可以转换成：</span>
<span class="token keyword">SELECT</span> <span class="token keyword">day</span><span class="token punctuation">,</span>
<span class="token function">COUNT</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token keyword">AS</span> uv
<span class="token keyword">FROM</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">day</span><span class="token punctuation">,</span>id <span class="token keyword">FROM</span> lxw1234 <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">day</span><span class="token punctuation">,</span>id<span class="token punctuation">)</span> a
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">day</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p><a href="https://www.jianshu.com/p/58d975a0f8f8" target="_blank" rel="noopener noreferrer">Hive调优的手段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/boyu_tung/article/details/52878412" target="_blank" rel="noopener noreferrer">Hive调优的目标、原则及手段<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/9V99Dgz_yp-CPMtFFATtXw" target="_blank" rel="noopener noreferrer">Hive性能优化（全面）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://cwiki.apache.org/confluence/display/Hive/Correlation+Optimizer" target="_blank" rel="noopener noreferrer">Correlation Optimizer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://cwiki.apache.org/confluence/display/Hive/Cost-based+optimization+in+Hive" target="_blank" rel="noopener noreferrer">Cost-based optimization in Hive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://cwiki.apache.org/confluence/display/Hive/Vectorized+Query+Execution" target="_blank" rel="noopener noreferrer">Vectorized Query Execution<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+JoinOptimization" target="_blank" rel="noopener noreferrer">LanguageManual JoinOptimization<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="其他优化"><a href="#其他优化" class="header-anchor">$</a> 其他优化</h2> <h4 id="fetch抓取"><a href="#fetch抓取" class="header-anchor">$</a> Fetch抓取</h4> <p>Fetch抓取是指，Hive在全局查找、字段查找、limit查找等都不走mapreduce。</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.fetch.task.conversion=more
</code></pre></div><h4 id="本地模式"><a href="#本地模式" class="header-anchor">$</a> 本地模式</h4> <p>当 Hive 查询处理的数据量比较小时，其实没有必要启动分布式模式去执行，因为以分布式方式执行就涉及到跨网络传输、多节点协调 等，并且消耗资源。这个时间可以只使用本地模式来执行 mapreduce job，只在一台机器上执行，速度会很快。启动本地模式涉及到三个参数：</p> <div class="language- extra-class"><pre class="language-text"><code>set hive.exec.mode.local.auto=true
//设置local mr的最大输入数据量，当输入数据量小于这个值时采用local  mr的方式，默认为134217728，即128M
set hive.exec.mode.local.auto.inputbytes.max=50000000;
//设置local mr的最大输入文件个数，当输入文件个数小于这个值时采用local mr的方式，默认为4
set hive.exec.mode.local.auto.input.files.max=10;
</code></pre></div><h4 id="严格模式"><a href="#严格模式" class="header-anchor">$</a> 严格模式</h4> <p>开启严格模式可以禁止3种类型的查询：</p> <ol><li>对于分区表，除非where语句中含有分区字段过滤条件来限制范围，否则不允许执行。</li> <li>对于使用了order by语句的查询，要求必须使用limit语句。因为order by会将所有的结果数据分发到同一个Reducer中进行处理，强制要求用户增加这个LIMIT语句可以防止Reducer额外执行很长一段时间。</li> <li>限制笛卡尔积的查询。</li></ol> <div class="language- extra-class"><pre class="language-text"><code>set hive.mapred.mode=strict
</code></pre></div><h4 id="排序选择"><a href="#排序选择" class="header-anchor">$</a> 排序选择</h4> <p><strong>cluster by</strong>：对同一字段分桶并排序，不能和 sort by 连用</p> <p><strong>distribute by + sort by</strong>：分桶，保证同一字段值只存在一个结果文件当中，结合 sort by 保证 每个 reduceTask 结果有序</p> <p><strong>sort by</strong>：单机排序，单个 reduce 结果有序</p> <p><strong>order by</strong>：全局排序，缺陷是只能使用一个 reduce</p> <h4 id="jvm重用"><a href="#jvm重用" class="header-anchor">$</a> JVM重用</h4> <p>JVM重用是Hadoop调优参数的内容，其对Hive的性能具有非常大的影响，特别是对于很难避免小文件的场景或task特别多的场景，这类场景大多数执行时间都很短。</p> <div class="language- extra-class"><pre class="language-text"><code>set  mapreduce.job.jvm.numtasks=10
</code></pre></div><h4 id="推测执行"><a href="#推测执行" class="header-anchor">$</a> 推测执行</h4> <p>推测式任务，也叫做Speculative task。它是一种以空间换时间的策略。
当所有task都开始运行之后，任务对应的ApplicationMaster会统计所有任务的平均进度，如果某个task所在的task node机器配置比较低或者CPU load很高（原因很多），导致任务执行比总体任务的平均执行要慢，
此时AM会启动一个新的任务（Speculative task），原有任务和新任务哪个先执行完就把另外一个kill掉，
这也是我们经常在RM页面看到任务执行成功，但是总有些task被kill，就是这个原因。</p> <div class="language- extra-class"><pre class="language-text"><code>set mapreduce.map.speculative=true;
set mapreduce.reduce.speculative=true;
</code></pre></div><h4 id="并行执行"><a href="#并行执行" class="header-anchor">$</a> 并行执行</h4> <div class="language- extra-class"><pre class="language-text"><code>//打开任务并行执行
set hive.exec.parallel=true;
//同一个sql允许最大并行度，默认为8
set hive.exec.parallel.thread.number=16;
</code></pre></div><h4 id="map数"><a href="#map数" class="header-anchor">$</a> map数</h4> <p>控制map数量需要遵循两个原则：<strong>使大数据量利用合适的map数；使单个map任务处理合适的数据量；</strong></p> <div class="language- extra-class"><pre class="language-text"><code>set mapred.max.split.size=100000000;
set mapred.min.split.size.per.node=100000000;
set mapred.min.split.size.per.rack=100000000;
# 这个参数表示执行前进行小文件合并
set hive.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
</code></pre></div><p>前面三个参数确定合并文件块的大小，大于文件块大小128m的，按照128m来分隔，小于128m,大于100m的，按照100m来分隔，把那些小于100m的（包括小文件和分隔大文件剩下的）进行合并。</p> <p>如果表a只有一个文件，大小为120M，但包含几千万的记录，如果用1个map去完成这个任务，肯定是比较耗时的，这种情况下，我们要考虑将这一个文件合理的拆分成多个，
这样就可以用多个map任务去完成。</p> <div class="language- extra-class"><pre class="language-text"><code>set mapred.reduce.tasks=10;
create table a_1 as
select * from a
distribute by rand(123);
</code></pre></div><p>这样会将a表的记录，随机的分散到包含10个文件的a_1表中，再用a_1代替上面sql中的a表，则会用10个map任务去完成。</p> <h4 id="reduce数"><a href="#reduce数" class="header-anchor">$</a> reduce数</h4> <p>不指定reduce个数的情况下，Hive会猜测确定一个reduce个数，计算reducer数的公式很简单N=min(每个任务最大的reduce数，总输入数据量/每个reduce任务处理的数据量)：</p> <div class="language- extra-class"><pre class="language-text"><code>// 每个reduce任务处理的数据量，默认为1000^3=1G
hive.exec.reducers.bytes.per.reducer
// 每个任务最大的reduce数，默认为999
hive.exec.reducers.max
</code></pre></div><p>调整reduce个数方法：</p> <div class="language- extra-class"><pre class="language-text"><code>方法一：
set hive.exec.reducers.bytes.per.reducer=500000000;
方法二：
set mapred.reduce.tasks = 15;
</code></pre></div><p>很多时候你会发现任务中不管数据量多大，不管你有没有设置调整reduce个数的参数，任务中一直都只有一个reduce任务；其实只有一个reduce任务的情况，除了数据量小于
hive.exec.reducers.bytes.per.reducer参数值的情况外，还有以下原因：<br>
a)    没有group by的汇总<br>
b)    用了Order by</p> <p>只有一个reduce的场景：</p> <ol><li><p>没有group by 的汇总</p></li> <li><p>order by</p></li> <li><p>笛卡尔积</p></li></ol> <p><a href="http://lxw1234.com/archives/2015/04/15.htm" target="_blank" rel="noopener noreferrer">hive优化之——控制hive任务中的map数和reduce数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="小文件合并"><a href="#小文件合并" class="header-anchor">$</a> 小文件合并</h4> <p><strong>小文件是如何产生的</strong></p> <p>1.动态分区插入数据，产生大量的小文件，从而导致map数量剧增。</p> <p>2.reduce数量越多，小文件也越多(reduce的个数和输出文件是对应的)。</p> <p>3.数据源本身就包含大量的小文件。</p> <p><strong>小文件问题的影响</strong></p> <p>1.从Hive的角度看，小文件会开很多map，一个map开一个JVM去执行，所以这些任务的初始化，启动，执行会浪费大量的资源，严重影响性能。</p> <p>2.在HDFS中，每个小文件对象约占150byte，如果小文件过多会占用大量内存。这样NameNode内存容量严重制约了集群的扩展。</p> <p><strong>小文件问题的解决方案</strong></p> <p>从小文件产生的途经就可以从源头上控制小文件数量，方法如下：</p> <ol><li><p>使用Sequencefile作为表存储格式，不要用textfile，在一定程度上可以减少小文件。</p></li> <li><p>减少reduce的数量(可以使用参数进行控制)。</p></li> <li><p>少用动态分区，用时记得按distribute by分区</p></li> <li><p>设置map输入合并小文件</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 每个Map最大输入大小(这个值决定了合并后文件的数量)</span>
<span class="token keyword">set</span> mapred<span class="token punctuation">.</span>max<span class="token punctuation">.</span>split<span class="token punctuation">.</span>size<span class="token operator">=</span><span class="token number">256000000</span><span class="token punctuation">;</span>  
<span class="token comment">-- 一个节点上split的至少的大小(这个值决定了多个DataNode上的文件是否需要合并)</span>
<span class="token keyword">set</span> mapred<span class="token punctuation">.</span>min<span class="token punctuation">.</span>split<span class="token punctuation">.</span>size<span class="token punctuation">.</span>per<span class="token punctuation">.</span>node<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">;</span>
<span class="token comment">-- 一个交换机下split的至少的大小(这个值决定了多个交换机上的文件是否需要合并)  </span>
<span class="token keyword">set</span> mapred<span class="token punctuation">.</span>min<span class="token punctuation">.</span>split<span class="token punctuation">.</span>size<span class="token punctuation">.</span>per<span class="token punctuation">.</span>rack<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">;</span>
<span class="token comment">-- 执行Map前进行小文件合并</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span>input<span class="token punctuation">.</span>format<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hive<span class="token punctuation">.</span>ql<span class="token punctuation">.</span>io<span class="token punctuation">.</span>CombineHiveInputFormat<span class="token punctuation">;</span> 
</code></pre></div></li> <li><p>设置map输出和reduce输出进行合并</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- 在map-only job后合并文件，默认true</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">merge</span><span class="token punctuation">.</span>mapfiles <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">-- 在map-reduce job后合并文件，默认false</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">merge</span><span class="token punctuation">.</span>mapredfiles <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token comment">-- 设置合并文件的大小</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">merge</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>per<span class="token punctuation">.</span>task <span class="token operator">=</span> <span class="token number">256</span><span class="token operator">*</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">1000</span>
<span class="token comment">-- 当输出文件的平均大小小于该值时，启动一个独立的MapReduce任务进行文件merge。</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">merge</span><span class="token punctuation">.</span>smallfiles<span class="token punctuation">.</span>avgsize<span class="token operator">=</span><span class="token number">16000000</span>
</code></pre></div></li> <li><p>对于输出结果为压缩文件形式存储的情况：</p> <ol><li>如果在Map输入前合并，对输出的文件存储格式并没有限制。</li> <li>如果使用输出合并，则必须配合SequenceFile来存储，否则无法进行合并</li></ol> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">set</span> mapred<span class="token punctuation">.</span>output<span class="token punctuation">.</span>compression<span class="token punctuation">.</span> <span class="token keyword">type</span><span class="token operator">=</span>BLOCK<span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>compress<span class="token punctuation">.</span>output<span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token keyword">set</span> mapred<span class="token punctuation">.</span>output<span class="token punctuation">.</span>compression<span class="token punctuation">.</span>codec<span class="token operator">=</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>io<span class="token punctuation">.</span>compress<span class="token punctuation">.</span>LzoCodec<span class="token punctuation">;</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">merge</span><span class="token punctuation">.</span>smallfiles<span class="token punctuation">.</span>avgsize<span class="token operator">=</span><span class="token number">100000000</span><span class="token punctuation">;</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> dw_stage<span class="token punctuation">.</span>zj_small<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> dw_stage<span class="token punctuation">.</span>zj_small
STORED <span class="token keyword">AS</span> SEQUENCEFILE
<span class="token keyword">as</span> <span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> dw_db<span class="token punctuation">.</span>dw_soj_imp_dtl
<span class="token keyword">where</span> log_dt <span class="token operator">=</span> <span class="token string">'2014-04-14'</span>
<span class="token operator">and</span> paid <span class="token operator">like</span> <span class="token string">'%baidu%'</span> <span class="token punctuation">;</span>
</code></pre></div></li></ol> <p>参考：</p> <blockquote><p><a href="https://blog.csdn.net/yycdaizi/article/details/43341239" target="_blank" rel="noopener noreferrer">Hive小文件合并<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://blog.csdn.net/lzm1340458776/article/details/43567209" target="_blank" rel="noopener noreferrer">Hive优化之小文件问题及其解决方案<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.jianshu.com/p/8e2f2f0d4b6c" target="_blank" rel="noopener noreferrer">Hive/HiveQL常用优化方法全面总结（上篇）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.jianshu.com/p/deb4a6f91d3b" target="_blank" rel="noopener noreferrer">Hive/HiveQL常用优化方法全面总结（下篇）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="hive-sql优化"><a href="#hive-sql优化" class="header-anchor">$</a> Hive SQL优化</h3></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">8/25/2021, 12:49:35 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/bigdata/hive/hive_principle.html" class="prev">
        Hive原理
      </a></span> <span class="next"><a href="/bigdata/hive/hive_parse_json.html">
        Hive解析json数组
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a2246195.js" defer></script><script src="/assets/js/2.a92520c9.js" defer></script><script src="/assets/js/66.8e4764ed.js" defer></script>
  </body>
</html>
