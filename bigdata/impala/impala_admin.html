<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Impala运维 | yx91490的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.webp">
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QQHZM2VLM0');
window.addEventListener('load', function(){ var s = document.createElement('script'); s.src = "https://www.googletagmanager.com/gtag/js?id=G-QQHZM2VLM0"; document.body.appendChild(s); });</script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6781d2ac2dff1f3b278518419b4d4deb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <meta name="description" content="java, 大数据(hadoop, sqoop, kylin, zeppelin)相关技术, 工作经验记录">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="google-site-verification" content="j1Gm2ZeMV3D7mPiI08fpx91dEOSlhCAJjD4vy_pSroQ">
    <meta name="baidu-site-verification" content="4z2bGbjYMB">
    
    <link rel="preload" href="/assets/css/0.styles.003598ab.css" as="style"><link rel="preload" href="/assets/js/app.233c3d40.js" as="script"><link rel="preload" href="/assets/js/2.01043e44.js" as="script"><link rel="preload" href="/assets/js/71.0807649c.js" as="script"><link rel="prefetch" href="/assets/js/10.a9cb54bc.js"><link rel="prefetch" href="/assets/js/100.b5120f6b.js"><link rel="prefetch" href="/assets/js/101.e4ff5750.js"><link rel="prefetch" href="/assets/js/102.a7de7cdf.js"><link rel="prefetch" href="/assets/js/103.473bf3b5.js"><link rel="prefetch" href="/assets/js/104.a4b8c13f.js"><link rel="prefetch" href="/assets/js/105.227d8798.js"><link rel="prefetch" href="/assets/js/106.624df618.js"><link rel="prefetch" href="/assets/js/107.3ed82cac.js"><link rel="prefetch" href="/assets/js/108.ebfbd4fe.js"><link rel="prefetch" href="/assets/js/109.7295f300.js"><link rel="prefetch" href="/assets/js/11.834f9690.js"><link rel="prefetch" href="/assets/js/110.56edfd0b.js"><link rel="prefetch" href="/assets/js/111.6e89543c.js"><link rel="prefetch" href="/assets/js/112.401688e3.js"><link rel="prefetch" href="/assets/js/113.51780982.js"><link rel="prefetch" href="/assets/js/114.6971e7a3.js"><link rel="prefetch" href="/assets/js/115.e52ae920.js"><link rel="prefetch" href="/assets/js/116.b69ef98a.js"><link rel="prefetch" href="/assets/js/117.8b3116ce.js"><link rel="prefetch" href="/assets/js/118.a198e1bf.js"><link rel="prefetch" href="/assets/js/119.e5135809.js"><link rel="prefetch" href="/assets/js/12.f3b82ca5.js"><link rel="prefetch" href="/assets/js/120.b0c277b8.js"><link rel="prefetch" href="/assets/js/121.f293696a.js"><link rel="prefetch" href="/assets/js/122.c36341b7.js"><link rel="prefetch" href="/assets/js/123.9c656742.js"><link rel="prefetch" href="/assets/js/124.9301d8e2.js"><link rel="prefetch" href="/assets/js/125.24e6a342.js"><link rel="prefetch" href="/assets/js/126.34836635.js"><link rel="prefetch" href="/assets/js/127.12c5ea73.js"><link rel="prefetch" href="/assets/js/128.7fc3a22a.js"><link rel="prefetch" href="/assets/js/129.4a1eba90.js"><link rel="prefetch" href="/assets/js/13.cc88f5ca.js"><link rel="prefetch" href="/assets/js/130.3f0620d3.js"><link rel="prefetch" href="/assets/js/131.849886d2.js"><link rel="prefetch" href="/assets/js/132.c042053b.js"><link rel="prefetch" href="/assets/js/133.d557f340.js"><link rel="prefetch" href="/assets/js/134.89f4a765.js"><link rel="prefetch" href="/assets/js/135.78767593.js"><link rel="prefetch" href="/assets/js/136.14775781.js"><link rel="prefetch" href="/assets/js/137.a6dab0e7.js"><link rel="prefetch" href="/assets/js/138.e4c7eeb4.js"><link rel="prefetch" href="/assets/js/139.998ce669.js"><link rel="prefetch" href="/assets/js/14.08157517.js"><link rel="prefetch" href="/assets/js/140.424f5487.js"><link rel="prefetch" href="/assets/js/141.cdd05de7.js"><link rel="prefetch" href="/assets/js/142.ff2dbb1d.js"><link rel="prefetch" href="/assets/js/143.3ff383f1.js"><link rel="prefetch" href="/assets/js/144.5c3baf4b.js"><link rel="prefetch" href="/assets/js/145.ab11a997.js"><link rel="prefetch" href="/assets/js/146.8f6337ab.js"><link rel="prefetch" href="/assets/js/147.b44510e8.js"><link rel="prefetch" href="/assets/js/148.8a31950b.js"><link rel="prefetch" href="/assets/js/149.045323fe.js"><link rel="prefetch" href="/assets/js/15.2ace7afa.js"><link rel="prefetch" href="/assets/js/150.f5241300.js"><link rel="prefetch" href="/assets/js/151.4d187941.js"><link rel="prefetch" href="/assets/js/152.ffcb8745.js"><link rel="prefetch" href="/assets/js/153.5033ba80.js"><link rel="prefetch" href="/assets/js/154.45e3c768.js"><link rel="prefetch" href="/assets/js/155.8155cadb.js"><link rel="prefetch" href="/assets/js/156.44122846.js"><link rel="prefetch" href="/assets/js/157.6e0cd3cd.js"><link rel="prefetch" href="/assets/js/158.a2dcef61.js"><link rel="prefetch" href="/assets/js/159.73dbf59b.js"><link rel="prefetch" href="/assets/js/16.b5e16e48.js"><link rel="prefetch" href="/assets/js/160.94612526.js"><link rel="prefetch" href="/assets/js/161.b9ccc24d.js"><link rel="prefetch" href="/assets/js/162.d536f123.js"><link rel="prefetch" href="/assets/js/163.9648a606.js"><link rel="prefetch" href="/assets/js/164.6efdbcd8.js"><link rel="prefetch" href="/assets/js/165.543a02c4.js"><link rel="prefetch" href="/assets/js/166.bf22c3e0.js"><link rel="prefetch" href="/assets/js/167.cec6a495.js"><link rel="prefetch" href="/assets/js/168.5e8f0936.js"><link rel="prefetch" href="/assets/js/169.51179c07.js"><link rel="prefetch" href="/assets/js/17.2bea4e7c.js"><link rel="prefetch" href="/assets/js/170.63e36c49.js"><link rel="prefetch" href="/assets/js/171.c64cf245.js"><link rel="prefetch" href="/assets/js/172.0de6ac8b.js"><link rel="prefetch" href="/assets/js/173.6741722b.js"><link rel="prefetch" href="/assets/js/174.4479dbfb.js"><link rel="prefetch" href="/assets/js/175.e8ed261c.js"><link rel="prefetch" href="/assets/js/176.cfdb1192.js"><link rel="prefetch" href="/assets/js/177.5e4e41bc.js"><link rel="prefetch" href="/assets/js/178.bff3411f.js"><link rel="prefetch" href="/assets/js/179.0cae0b9e.js"><link rel="prefetch" href="/assets/js/18.006526fc.js"><link rel="prefetch" href="/assets/js/180.f243a5b8.js"><link rel="prefetch" href="/assets/js/181.59a9f15b.js"><link rel="prefetch" href="/assets/js/182.6bbaeb63.js"><link rel="prefetch" href="/assets/js/183.97078df9.js"><link rel="prefetch" href="/assets/js/184.06ab8714.js"><link rel="prefetch" href="/assets/js/185.93cd0732.js"><link rel="prefetch" href="/assets/js/186.c8ac1305.js"><link rel="prefetch" href="/assets/js/187.01fb8117.js"><link rel="prefetch" href="/assets/js/188.0930a239.js"><link rel="prefetch" href="/assets/js/189.1229e7c8.js"><link rel="prefetch" href="/assets/js/19.67bbfd7d.js"><link rel="prefetch" href="/assets/js/190.e0cf83b3.js"><link rel="prefetch" href="/assets/js/191.d4651434.js"><link rel="prefetch" href="/assets/js/192.31944c64.js"><link rel="prefetch" href="/assets/js/193.1869f1e4.js"><link rel="prefetch" href="/assets/js/194.e6e29a31.js"><link rel="prefetch" href="/assets/js/195.afb0f9f9.js"><link rel="prefetch" href="/assets/js/196.5adcf495.js"><link rel="prefetch" href="/assets/js/197.06e56694.js"><link rel="prefetch" href="/assets/js/198.dd9e7944.js"><link rel="prefetch" href="/assets/js/199.7d01989f.js"><link rel="prefetch" href="/assets/js/20.1e9a70fa.js"><link rel="prefetch" href="/assets/js/200.ac6e763f.js"><link rel="prefetch" href="/assets/js/201.bb1fe5aa.js"><link rel="prefetch" href="/assets/js/202.4bfeab52.js"><link rel="prefetch" href="/assets/js/203.f4037ede.js"><link rel="prefetch" href="/assets/js/204.af57c9aa.js"><link rel="prefetch" href="/assets/js/205.3115e168.js"><link rel="prefetch" href="/assets/js/206.056c5c4a.js"><link rel="prefetch" href="/assets/js/21.d0ad9480.js"><link rel="prefetch" href="/assets/js/22.aaf9b950.js"><link rel="prefetch" href="/assets/js/23.527a4855.js"><link rel="prefetch" href="/assets/js/24.67adc2bb.js"><link rel="prefetch" href="/assets/js/25.35349191.js"><link rel="prefetch" href="/assets/js/26.9299ca87.js"><link rel="prefetch" href="/assets/js/27.6babce64.js"><link rel="prefetch" href="/assets/js/28.a4009a44.js"><link rel="prefetch" href="/assets/js/29.fdc9badb.js"><link rel="prefetch" href="/assets/js/3.12bcb417.js"><link rel="prefetch" href="/assets/js/30.ff94cc72.js"><link rel="prefetch" href="/assets/js/31.c74f1881.js"><link rel="prefetch" href="/assets/js/32.1ca73de1.js"><link rel="prefetch" href="/assets/js/33.71e86feb.js"><link rel="prefetch" href="/assets/js/34.2e40f13f.js"><link rel="prefetch" href="/assets/js/35.d45c9aa9.js"><link rel="prefetch" href="/assets/js/36.0c9e21a6.js"><link rel="prefetch" href="/assets/js/37.c05d50ea.js"><link rel="prefetch" href="/assets/js/38.882060a5.js"><link rel="prefetch" href="/assets/js/39.76f10b49.js"><link rel="prefetch" href="/assets/js/4.2c7a81b4.js"><link rel="prefetch" href="/assets/js/40.3b2e5d27.js"><link rel="prefetch" href="/assets/js/41.1058efd5.js"><link rel="prefetch" href="/assets/js/42.66b53120.js"><link rel="prefetch" href="/assets/js/43.d7c6c28f.js"><link rel="prefetch" href="/assets/js/44.9a2ff251.js"><link rel="prefetch" href="/assets/js/45.2d2ab9e9.js"><link rel="prefetch" href="/assets/js/46.befab9ca.js"><link rel="prefetch" href="/assets/js/47.35309c29.js"><link rel="prefetch" href="/assets/js/48.837206ff.js"><link rel="prefetch" href="/assets/js/49.1e71e351.js"><link rel="prefetch" href="/assets/js/5.f685be0d.js"><link rel="prefetch" href="/assets/js/50.9b2f4a48.js"><link rel="prefetch" href="/assets/js/51.26b535f3.js"><link rel="prefetch" href="/assets/js/52.6cc4d072.js"><link rel="prefetch" href="/assets/js/53.418d2839.js"><link rel="prefetch" href="/assets/js/54.1969bf03.js"><link rel="prefetch" href="/assets/js/55.c19e9e30.js"><link rel="prefetch" href="/assets/js/56.f485e61e.js"><link rel="prefetch" href="/assets/js/57.be33f485.js"><link rel="prefetch" href="/assets/js/58.62ccfd2e.js"><link rel="prefetch" href="/assets/js/59.e625729e.js"><link rel="prefetch" href="/assets/js/6.285d951a.js"><link rel="prefetch" href="/assets/js/60.a6c40887.js"><link rel="prefetch" href="/assets/js/61.9cdeb501.js"><link rel="prefetch" href="/assets/js/62.1d1199e5.js"><link rel="prefetch" href="/assets/js/63.12183050.js"><link rel="prefetch" href="/assets/js/64.6e5ca955.js"><link rel="prefetch" href="/assets/js/65.6e6c1328.js"><link rel="prefetch" href="/assets/js/66.a9cd8529.js"><link rel="prefetch" href="/assets/js/67.68ec7f58.js"><link rel="prefetch" href="/assets/js/68.3f9bbb8e.js"><link rel="prefetch" href="/assets/js/69.a8425ee5.js"><link rel="prefetch" href="/assets/js/7.21b242d0.js"><link rel="prefetch" href="/assets/js/70.641c5928.js"><link rel="prefetch" href="/assets/js/72.b0eecbdb.js"><link rel="prefetch" href="/assets/js/73.482463ad.js"><link rel="prefetch" href="/assets/js/74.994c8b97.js"><link rel="prefetch" href="/assets/js/75.cfc8111d.js"><link rel="prefetch" href="/assets/js/76.e3ae15c5.js"><link rel="prefetch" href="/assets/js/77.fd9206d6.js"><link rel="prefetch" href="/assets/js/78.7fc241aa.js"><link rel="prefetch" href="/assets/js/79.6c2a14a0.js"><link rel="prefetch" href="/assets/js/8.55dc32a5.js"><link rel="prefetch" href="/assets/js/80.aedbb0a6.js"><link rel="prefetch" href="/assets/js/81.eb00c97c.js"><link rel="prefetch" href="/assets/js/82.b4014b38.js"><link rel="prefetch" href="/assets/js/83.36e1cd01.js"><link rel="prefetch" href="/assets/js/84.ffa27780.js"><link rel="prefetch" href="/assets/js/85.548ee28c.js"><link rel="prefetch" href="/assets/js/86.a7c0d2c4.js"><link rel="prefetch" href="/assets/js/87.9a115d06.js"><link rel="prefetch" href="/assets/js/88.0b0fe6a6.js"><link rel="prefetch" href="/assets/js/89.4f9535ea.js"><link rel="prefetch" href="/assets/js/9.4463413d.js"><link rel="prefetch" href="/assets/js/90.9b92471f.js"><link rel="prefetch" href="/assets/js/91.a1174215.js"><link rel="prefetch" href="/assets/js/92.43f7a3d7.js"><link rel="prefetch" href="/assets/js/93.2ed0285c.js"><link rel="prefetch" href="/assets/js/94.5dc451e8.js"><link rel="prefetch" href="/assets/js/95.6d8e9de0.js"><link rel="prefetch" href="/assets/js/96.be252391.js"><link rel="prefetch" href="/assets/js/97.0b059ad7.js"><link rel="prefetch" href="/assets/js/98.a573c393.js"><link rel="prefetch" href="/assets/js/99.2a97eaf5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.003598ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">yx91490的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link router-link-active">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Zeppelin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/zeppelin/heart_diease_dataset.html" class="sidebar-link">心脏病预测数据</a></li><li><a href="/bigdata/zeppelin/zeppelin_bugs.html" class="sidebar-link">zeppelin使用趟坑</a></li><li><a href="/bigdata/zeppelin/zeppelin_sharding.html" class="sidebar-link">Zeppelin v0.8分片方案</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DataX</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/datax/datax.html" class="sidebar-link">DataX源码学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Waterdrop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/waterdrop/waterdrop.html" class="sidebar-link">Waterdrop学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Kylin</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/kylin/awesome_kylin.html" class="sidebar-link">Kylin学习资料汇总</a></li><li><a href="/bigdata/kylin/read_kylin_source.html" class="sidebar-link">阅读Kylin源码</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Sqoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/sqoop/sqoop_usage.html" class="sidebar-link">代码调试</a></li><li><a href="/bigdata/sqoop/sqoop_hcatalog.html" class="sidebar-link">sqoopHCatalog使用</a></li><li><a href="/bigdata/sqoop/sqoop_mysql_temp_file.html" class="sidebar-link">sqoop导入导致MySQL产生大临时文件问题排查</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ZooKeeper</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/zookeeper/zookeeper.html" class="sidebar-link">ZooKeeper笔记</a></li><li><a href="/bigdata/zookeeper/zookeeper_user.html" class="sidebar-link">ZooKeeper管理员指南</a></li><li><a href="/bigdata/zookeeper/zk_distribute_lock.html" class="sidebar-link">zookeeper实现分布式锁</a></li><li><a href="/bigdata/zookeeper/isbn9787111524311_note.html" class="sidebar-link">《ZooKeeper分布式过程协同技术详解》笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Hadoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hadoop/hadoop_interview.html" class="sidebar-link">Hadoop面试题</a></li><li><a href="/bigdata/hadoop/port.html" class="sidebar-link">Hadoop默认端口</a></li><li><a href="/bigdata/hadoop/hdfs_user.html" class="sidebar-link">HDFS命令笔记</a></li><li><a href="/bigdata/hadoop/hdfs_issue.html" class="sidebar-link">HDFS Issue</a></li><li><a href="/bigdata/hadoop/distcp.html" class="sidebar-link">Distcp命令</a></li><li><a href="/bigdata/hadoop/columnar_storage_parquet_orc.html" class="sidebar-link">列式存储（parquet,orc）</a></li><li><a href="/bigdata/hadoop/avro_specification_1.8.1.html" class="sidebar-link">avro格式规范1.8.1翻译</a></li><li><a href="/bigdata/hadoop/yarn.html" class="sidebar-link">Yarn</a></li><li><a href="/bigdata/hadoop/yarn_cli.html" class="sidebar-link">Yarn Cli命令</a></li><li><a href="/bigdata/hadoop/mapreduce.html" class="sidebar-link">MapReduce</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Hive</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hive/hive_cli.html" class="sidebar-link">Beeline命令行</a></li><li><a href="/bigdata/hive/hive_src.html" class="sidebar-link">Hive源码分析</a></li><li><a href="/bigdata/hive/hive_ql.html" class="sidebar-link">HiveQL</a></li><li><a href="/bigdata/hive/hive_data_type.html" class="sidebar-link">Hive数据类型</a></li><li><a href="/bigdata/hive/hive_bucket.html" class="sidebar-link">Hive分桶</a></li><li><a href="/bigdata/hive/hive_principle.html" class="sidebar-link">Hive原理</a></li><li><a href="/bigdata/hive/hive_optimize.html" class="sidebar-link">Hive优化</a></li><li><a href="/bigdata/hive/hive_parse_json.html" class="sidebar-link">Hive解析json数组</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>OLAP</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/olap/olap.html" class="sidebar-link">OLAP笔记</a></li><li><a href="/bigdata/olap/data_analyze.html" class="sidebar-link">数据分析笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>ClickHouse</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/clickhouse/clickhouse.html" class="sidebar-link">ClickHouse学习笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Doris</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/doris/doris.html" class="sidebar-link">Doris笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Kudu</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/kudu/kudu.html" class="sidebar-link">Kudu</a></li><li><a href="/bigdata/kudu/kudu_paper.html" class="sidebar-link">Kudu: Storage for Fast Analytics on Fast Data</a></li><li><a href="/bigdata/kudu/kudu_paper_translation.html" class="sidebar-link">【译】Kudu论文</a></li><li><a href="/bigdata/kudu/kudu_note.html" class="sidebar-link">Kudu笔记</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Impala</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/impala/cup.html" class="sidebar-link">CUP学习笔记</a></li><li><a href="/bigdata/impala/impala.html" class="sidebar-link">Impala</a></li><li><a href="/bigdata/impala/impala_admin.html" aria-current="page" class="active sidebar-link">Impala运维</a></li><li><a href="/bigdata/impala/impala_dev.html" class="sidebar-link">Impala开发笔记</a></li><li><a href="/bigdata/impala/impala_community.html" class="sidebar-link">Impala社区</a></li><li><a href="/bigdata/impala/impala_issues.html" class="sidebar-link">Impala问题记录</a></li><li><a href="/bigdata/impala/impala_paper_translation.html" class="sidebar-link">【转】【译】Impala：Hadoop上的一个现代开源SQL引擎</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Spark</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/spark/spark.html" class="sidebar-link">Spark</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HBase</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/hbase/hbase_interview.html" class="sidebar-link">HBase</a></li><li><a href="/bigdata/hbase/hbase_user.html" class="sidebar-link">HBase使用</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/bigdata/note/oss_note.html" class="sidebar-link">《快手短视频打造高稳定千亿级别对象存储平台》笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="impala运维"><a href="#impala运维" class="header-anchor">$</a> Impala运维</h1> <h2 id="sql收集"><a href="#sql收集" class="header-anchor">$</a> SQL收集</h2> <p>对于OLAP引擎的SQL采集和分析是保障稳定性的重要一环，像ClickHouse会将SQL存放在系统表system.query_log里，对于管理员来说采集和分析起来比较方便。Impala则没有系统表可以使用，需要通过接口来进行收集，其中有两种收集方式：一种方式是通过Web UI的HTTP接口来收集，另一种是通过profile日志收集。</p> <h3 id="http接口方式"><a href="#http接口方式" class="header-anchor">$</a> HTTP接口方式</h3> <p>接口地址：http://localhost:25000/queries?json</p> <p>样例数据：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;in_flight_queries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;num_in_flight_queries&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;num_executing_queries&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;num_waiting_queries&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">&quot;waiting-tooltip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;These queries are no longer executing, either because they encountered an error or because they have returned all of their results, but they are still active so that their results can be inspected. To free the resources they are using, they must be closed.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;completed_queries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;effective_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hive&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;default_db&quot;</span><span class="token operator">:</span> <span class="token string">&quot;db1&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;stmt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;SELECT * as A17 from db1.id_name limit 10000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;stmt_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;QUERY&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-07-16 11:11:31.930478000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-07-16 11:11:31.931347000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;duration&quot;</span><span class="token operator">:</span> <span class="token string">&quot;869.000us&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;progress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;N/A&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token string">&quot;EXCEPTION&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;rows_fetched&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token property">&quot;query_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;664ae023e9554947:4e10ec3e00000000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Unregister query&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;waiting&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;executing&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;waiting_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;359h13m&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;resource_pool&quot;</span><span class="token operator">:</span> <span class="token string">&quot;root.default&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;effective_user&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hive&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;default_db&quot;</span><span class="token operator">:</span> <span class="token string">&quot;db1&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;stmt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DESCRIBE `db1`.`id_name`&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;stmt_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DDL&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;start_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-07-16 10:30:45.360787000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;end_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2021-07-16 10:30:45.417917000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;duration&quot;</span><span class="token operator">:</span> <span class="token string">&quot;57.130ms&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;progress&quot;</span><span class="token operator">:</span> <span class="token string">&quot;N/A&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;state&quot;</span><span class="token operator">:</span> <span class="token string">&quot;FINISHED&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;rows_fetched&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token property">&quot;query_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ef433c28d03b3929:2ada991600000000&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;last_event&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Unregister query&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;waiting&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token property">&quot;executing&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token property">&quot;waiting_time&quot;</span><span class="token operator">:</span> <span class="token string">&quot;359h53m&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;resource_pool&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;completed_log_size&quot;</span><span class="token operator">:</span> <span class="token number">200</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用HTTP接口的好处是json格式（json格式参考代码：<a href="https://github.com/apache/impala/blob/030c445ac967054937a0a7c3b17c6b01a38e767c/be/src/service/impala-http-handler.cc#L298" target="_blank" rel="noopener noreferrer">impala-http-handler.cc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）解析比较方便，缺点是默认保存的条数有限（通过参数<a href="https://github.com/apache/impala/blob/030c445ac967054937a0a7c3b17c6b01a38e767c/be/src/service/impala-server.cc#L140" target="_blank" rel="noopener noreferrer">query_log_size<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>控制），重启后即清空。</p> <h3 id="profile日志方式"><a href="#profile日志方式" class="header-anchor">$</a> Profile日志方式</h3> <p>profile日志位于每个Impalad实例的日志目录里（由参数<a href="https://github.com/apache/impala/blob/030c445ac967054937a0a7c3b17c6b01a38e767c/be/src/service/impala-server.cc#L164" target="_blank" rel="noopener noreferrer">profile_log_dir<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>控制），保存的条数由参数<a href="https://github.com/apache/impala/blob/030c445ac967054937a0a7c3b17c6b01a38e767c/be/src/service/impala-server.cc#L166" target="_blank" rel="noopener noreferrer">max_profile_log_file_size<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>和参数<a href="https://github.com/apache/impala/blob/030c445ac967054937a0a7c3b17c6b01a38e767c/be/src/service/impala-server.cc#L168" target="_blank" rel="noopener noreferrer">max_profile_log_files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>控制，格式是thrift压缩二进制格式，然后gzip压缩，之后再使用Base64编码（参考：<a href="https://github.com/apache/impala/blob/9f1c31c597b73662b76eb09a102bdeead58a96ed/be/src/util/runtime-profile.h#L339" target="_blank" rel="noopener noreferrer">runtime-profile.h#L339<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）。</p> <p>原始日志样例：</p> <div class="language- extra-class"><pre class="language-text"><code>1624608142892 7e44315b6c3047bc:3ea0932400000000 eJztXFtsHNd5Xq4ZiVpS4nWp3YiOjis7XRoiNbvL61YywMuSIkgu6V1ScusY0nDmcDnV7sxmLpRo+EF1ioBxDdVI81AEegjapkUbNzWMIBCQNDDyUqPtgx+MIGj7YNQtKqRxmgBBELhK0f+cM7N7ZnZmeXEsU8EusOTOu...
1624608142892 7e44315b6c3047bc:3ea0932400000000 eJztXFtsHNd5Xq4ZiVpS4nWp3YiOjis7XRoiNbvL61YywMuSIkgu6V1ScusY0nDmcDnV7sxmLpRo+EF1ioBxDdVI81AEegjapkUbNzWMIBCQNDDyUqPtgx+MIGj7YNQtKqRxmgBBELhK0f+cM7N7ZnZmeXEsU8EusOTOu...
</code></pre></div><p>要解析profile日志用到的核心代码包括： <a href="https://github.com/apache/impala/blob/3.2.0/bin/parse-thrift-profile.py" target="_blank" rel="noopener noreferrer">parse-thrift-profile.py<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和<a href="https://github.com/apache/impala/blob/3.2.0/lib/python/impala_py_lib/profiles.py" target="_blank" rel="noopener noreferrer">profiles.py<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>以及thrift生成文件<a href="https://github.com/cloudera/impyla/tree/v0.16.0/impala/_thrift_gen" target="_blank" rel="noopener noreferrer">_thrift_gen<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。正常来说需要编译impala源码，但是太麻烦。偷懒一点的话需要将代码目录结构整理成如下格式（部分import路径需要修改）：</p> <div class="language- extra-class"><pre class="language-text"><code>.
├── ExecStats
│   ├── constants.py
│   ├── __init__.py
│   └── ttypes.py
├── __init__.py
├── Metrics
│   ├── constants.py
│   ├── __init__.py
│   └── ttypes.py
├── parse-thrift-profile.py
├── profiles.py
├── RuntimeProfile
│   ├── constants.py
│   ├── __init__.py
│   └── ttypes.py
├── Status
│   ├── constants.py
│   ├── __init__.py
│   └── ttypes.py
└── Types
    ├── constants.py
    ├── __init__.py
    └── ttypes.py
</code></pre></div><p>然后运行命令：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>python2 ./parse-thrift-profile.py impala_profile_log_1.1-1624591721504 <span class="token operator">&gt;</span> output.txt
</code></pre></div><p>输出样例：</p> <div class="language- extra-class"><pre class="language-text"><code>2021-06-25T16:02:22.892000 7e44315b6c3047bc:3ea0932400000000
TRuntimeProfileTree(nodes=[TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Query (id=7e44315b6c3047bc:3ea0932400000000)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=3, child_counters_map={}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['Session ID', 'Session Type', 'HiveServer2 Protocol Version', 'Start Time', 'End Time', 'Query Type', 'Query State', 'Query Status', 'Impala Version', 'User', 'Connected User', 'Delegated User', 'Network Address', 'Default Db', 'Sql Statement', 'Coordinator', 'Query Options (set by configuration)', 'Query Options (set by configuration and planner)', 'Plan', 'Estimated Per-Host Mem', 'Tables Missing Stats', 'Per Host Min Memory Reservation', 'Request Pool', 'Admission result', 'Cluster Memory Admitted', 'ExecSummary', 'Errors'], indent=True, name='Summary', time_series_counters=None, info_strings={'Errors': '', 'Admission result': 'Admitted immediately', 'Network Address': '::ffff:172.23.66.73:52554', 'Tables Missing Stats': 'db1.id_name3', 'Impala Version': 'impalad version 3.2.0-cdh6.2.1 RELEASE (build 525e372410dd2ce206e2ad0f21f57cae7380c0cb)', 'Query Options (set by configuration and planner)': 'MT_DOP=0', 'ExecSummary': '\nOperator              #Hosts  Avg Time  Max Time    #Rows  Est. #Rows  Peak Mem  Est. Peak Mem  Detail           \n-----------------------------------------------------------------------------------------------------------------\nF01:ROOT                   1   0.000ns   0.000ns                              0              0                   \n03:AGGREGATE               1   0.000ns   0.000ns        1           1  16.00 KB       10.00 MB  FINALIZE         \n02:EXCHANGE                1   0.000ns   0.000ns        1           1  16.00 KB       16.00 KB  UNPARTITIONED    \nF00:EXCHANGE SENDER        1   0.000ns   0.000ns                       16.00 KB              0                   \n01:AGGREGATE               1   0.000ns   0.000ns        1           1  16.00 KB       10.00 MB                   \n00:SCAN KUDU               1   7.000ms   7.000ms  262.00K          -1  48.00 KB              0  db1.id_name3', 'Request Pool': 'root.default', 'Start Time': '2021-06-25 16:02:22.812417000', 'End Time': '2021-06-25 16:02:22.881222000', 'Per Host Min Memory Reservation': 'impala-013:22000(0)', 'Plan': '\n----------------\nMax Per-Host Resource Reservation: Memory=0B Threads=3\nPer-Host Resource Estimates: Memory=20MB\nWARNING: The following tables are missing relevant table and/or column statistics.\ndb1.id_name3\nAnalyzed query: SELECT count(*) expr_0 FROM db1.id_name3\n\nF01:PLAN FRAGMENT [UNPARTITIONED] hosts=1 instances=1\n|  Per-Host Resources: mem-estimate=10.02MB mem-reservation=0B thread-reservation=1\nPLAN-ROOT SINK\n|  mem-estimate=0B mem-reservation=0B thread-reservation=0\n|\n03:AGGREGATE [FINALIZE]\n|  output: count:merge(*)\n|  mem-estimate=10.00MB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0\n|  tuple-ids=1 row-size=8B cardinality=1\n|  in pipelines: 03(GETNEXT), 01(OPEN)\n|\n02:EXCHANGE [UNPARTITIONED]\n|  mem-estimate=16.00KB mem-reservation=0B thread-reservation=0\n|  tuple-ids=1 row-size=8B cardinality=1\n|  in pipelines: 01(GETNEXT)\n|\nF00:PLAN FRAGMENT [RANDOM] hosts=3 instances=3\nPer-Host Resources: mem-estimate=10.00MB mem-reservation=0B thread-reservation=2\n01:AGGREGATE\n|  output: count(*)\n|  mem-estimate=10.00MB mem-reservation=0B spill-buffer=2.00MB thread-reservation=0\n|  tuple-ids=1 row-size=8B cardinality=1\n|  in pipelines: 01(GETNEXT), 00(OPEN)\n|\n00:SCAN KUDU [db1.id_name3]\n   mem-estimate=0B mem-reservation=0B thread-reservation=1\n   tuple-ids=0 row-size=0B cardinality=unavailable\n   in pipelines: 00(GETNEXT)\n----------------', 'Query Type': 'QUERY', 'Connected User': 'hive', 'Session ID': 'e1452c4e78113859:192e96a74b2307a2', 'Sql Statement': 'SELECT COUNT(*) as `expr_0` FROM `db1`.`id_name3`', 'User': 'hive', 'Default Db': 'default', 'Delegated User': '', 'Query State': 'FINISHED', 'Session Type': 'HIVESERVER2', 'Cluster Memory Admitted': '20.02 MB', 'Query Status': 'OK', 'Query Options (set by configuration)': '', 'HiveServer2 Protocol Version': 'V6', 'Coordinator': 'impala-013:22000', 'Estimated Per-Host Mem': '20987904'}, summary_stats_counters=None, node_metadata=None, num_children=1, child_counters_map={'': set(['ComputeScanRangeAssignmentTimer', 'AdmissionControlTimeSinceLastUpdate'])}, event_sequences=[TEventSequence(timestamps=[213913, 647239, 669377, 2328785, 2417405, 2433230, 2456567, 2992136], labels=['Metadata of all 1 tables cached', 'Analysis finished', 'Value transfer graph computed', 'Single node plan created', 'Runtime filters computed', 'Distributed plan created', 'Lineage info computed', 'Planning finished'], name='Query Compilation'), TEventSequence(timestamps=[0, 4000125, 4000125, 4000125, 4000125, 5000156, 31000967, 62001934, 69002152, 69002152, 79002464], labels=['Query submitted', 'Planning finished', 'Submit for admission', 'Completed admission', 'Ready to start on 1 backends', 'All 1 execution backends (2 fragment instances) started', 'Rows available', 'First row fetched', 'Last row fetched', 'Released admission control resources', 'Unregister query'], name='Query Timeline')], counters=[TCounter(value=52000000, name='AdmissionControlTimeSinceLastUpdate', unit=5), TCounter(value=0, name='ComputeScanRangeAssignmentTimer', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Frontend', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set([])}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='ImpalaServer', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ClientFetchWaitTimer', 'RowMaterializationTimer'])}, event_sequences=None, counters=[TCounter(value=48001497, name='ClientFetchWaitTimer', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='RowMaterializationTimer', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['Number of filters', 'Filter routing table', 'Backend startup latencies', 'Slowest backend to start up', 'Per Node Peak Memory Usage', 'Per Node Bytes Read', 'Per Node User Time', 'Per Node System Time'], indent=True, name='Execution Profile 7e44315b6c3047bc:3ea0932400000000', time_series_counters=None, info_strings={'Filter routing table': '\n ID  Src. Node  Tgt. Node(s)  Target type  Partition filter  Pending (Expected)  First arrived  Completed   Enabled\n-------------------------------------------------------------------------------------------------------------------', 'Per Node Bytes Read': 'impala-013:22000(0)', 'Per Node User Time': 'impala-013:22000(32.716ms)', 'Per Node System Time': 'impala-013:22000(2.104ms)', 'Per Node Peak Memory Usage': 'impala-013:22000(100.13 KB)', 'Backend startup latencies': 'Count: 1, min / max: 1ms / 1ms, 25th %-ile: 1ms, 50th %-ile: 1ms, 75th %-ile: 1ms, 90th %-ile: 1ms, 95th %-ile: 1ms, 99.9th %-ile: 1ms', 'Slowest backend to start up': 'impala-013:22000', 'Number of filters': '0'}, summary_stats_counters=None, node_metadata=None, num_children=5, child_counters_map={'': set(['ExchangeScanRatio', 'NumBackends', 'TotalScanBytesSent', 'TotalCpuTime', 'TotalInnerBytesSent', 'FinalizationTimer', 'FiltersReceived', 'NumFragments', 'InnerNodeSelectivityRatio', 'TotalBytesSent', 'NumFragmentInstances', 'TotalBytesRead'])}, event_sequences=None, counters=[TCounter(value=0, name='ExchangeScanRatio', unit=6), TCounter(value=0, name='FiltersReceived', unit=0), TCounter(value=0, name='FinalizationTimer', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='InnerNodeSelectivityRatio', unit=6), TCounter(value=1, name='NumBackends', unit=0), TCounter(value=2, name='NumFragmentInstances', unit=0), TCounter(value=2, name='NumFragments', unit=0), TCounter(value=0, name='TotalBytesRead', unit=3), TCounter(value=12, name='TotalBytesSent', unit=3), TCounter(value=34820000, name='TotalCpuTime', unit=5), TCounter(value=12, name='TotalInnerBytesSent', unit=3), TCounter(value=0, name='TotalScanBytesSent', unit=3), TCounter(value=27000842, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Per Node Profiles', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=1, child_counters_map={}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='impala-013:22000', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['TotalEncryptionTime', 'TotalReadBlockTime', 'ScratchBytesRead', 'ScratchFileUsedBytes', 'ScratchWrites', 'ScratchReads', 'ScratchBytesWritten'])}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='ScratchBytesRead', unit=3), TCounter(value=0, name='ScratchBytesWritten', unit=3), TCounter(value=0, name='ScratchFileUsedBytes', unit=3), TCounter(value=0, name='ScratchReads', unit=0), TCounter(value=0, name='ScratchWrites', unit=0), TCounter(value=0, name='TotalEncryptionTime', unit=5), TCounter(value=0, name='TotalReadBlockTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['split sizes', 'completion times', 'execution rates', 'num instances'], indent=True, name='Averaged Fragment F01', time_series_counters=None, info_strings={'completion times': 'min:57.001ms  max:57.001ms  mean: 57.001ms  stddev:0.000ns', 'split sizes': ' min: 0, max: 0, avg: 0, stddev: 0', 'execution rates': 'min:0.00 /sec  max:0.00 /sec  mean:0.00 /sec  stddev:0.00 /sec', 'num instances': '1'}, summary_stats_counters=None, node_metadata=None, num_children=5, child_counters_map={'': set(['ExchangeScanRatio', 'TotalNetworkSendTime', 'PerHostPeakMemUsage', 'AverageThreadTokens', 'PeakMemoryUsage', 'TotalStorageWaitTime', 'TotalThreadsInvoluntaryContextSwitches', 'TotalThreadsTotalWallClockTime', 'RowsProduced', 'TotalThreadsVoluntaryContextSwitches', 'TotalNetworkReceiveTime', 'BloomFilterBytes', 'PeakReservation', 'PeakUsedReservation']), 'TotalThreadsTotalWallClockTime': set(['TotalThreadsUserTime', 'TotalThreadsSysTime'])}, event_sequences=None, counters=[TCounter(value=0, name='AverageThreadTokens', unit=6), TCounter(value=0, name='BloomFilterBytes', unit=3), TCounter(value=0, name='ExchangeScanRatio', unit=6), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=40960, name='PeakMemoryUsage', unit=3), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=102534, name='PerHostPeakMemUsage', unit=3), TCounter(value=1, name='RowsProduced', unit=0), TCounter(value=14000437, name='TotalNetworkReceiveTime', unit=5), TCounter(value=0, name='TotalNetworkSendTime', unit=5), TCounter(value=0, name='TotalStorageWaitTime', unit=5), TCounter(value=0, name='TotalThreadsInvoluntaryContextSwitches', unit=0), TCounter(value=1081000, name='TotalThreadsSysTime', unit=5), TCounter(value=57001778, name='TotalThreadsTotalWallClockTime', unit=5), TCounter(value=11838000, name='TotalThreadsUserTime', unit=5), TCounter(value=5, name='TotalThreadsVoluntaryContextSwitches', unit=0), TCounter(value=57001778, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Buffer pool', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ReadIoWaitTime', 'WriteIoOps', 'SystemAllocTime', 'CumulativeAllocations', 'ReadIoOps', 'ReservationLimit', 'WriteIoBytes', 'WriteIoWaitTime', 'PeakUnpinnedBytes', 'AllocTime', 'ReadIoBytes', 'CumulativeAllocationBytes', 'PeakReservation', 'PeakUsedReservation'])}, event_sequences=None, counters=[TCounter(value=0, name='AllocTime', unit=5), TCounter(value=0, name='CumulativeAllocationBytes', unit=3), TCounter(value=0, name='CumulativeAllocations', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUnpinnedBytes', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=0, name='ReadIoBytes', unit=3), TCounter(value=0, name='ReadIoOps', unit=0), TCounter(value=0, name='ReadIoWaitTime', unit=5), TCounter(value=0, name='ReservationLimit', unit=3), TCounter(value=0, name='SystemAllocTime', unit=5), TCounter(value=0, name='TotalTime', unit=5), TCounter(value=0, name='WriteIoBytes', unit=3), TCounter(value=0, name='WriteIoOps', unit=0), TCounter(value=0, name='WriteIoWaitTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Fragment Instance Lifecycle Timings', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ExecTime', 'OpenTime', 'PrepareTime']), 'ExecTime': set(['ExecTreeExecTime']), 'OpenTime': set(['ExecTreeOpenTime']), 'PrepareTime': set(['ExecTreePrepareTime'])}, event_sequences=None, counters=[TCounter(value=31000967, name='ExecTime', unit=5), TCounter(value=0, name='ExecTreeExecTime', unit=5), TCounter(value=14000437, name='ExecTreeOpenTime', unit=5), TCounter(value=0, name='ExecTreePrepareTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=26000811, name='OpenTime', unit=5), TCounter(value=0, name='PrepareTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='PLAN_ROOT_SINK', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=0, plan_node_id=None), num_children=0, child_counters_map={'': set(['PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='PeakMemoryUsage', unit=3), TCounter(value=31000967, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='AGGREGATION_NODE (id=3)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=3), num_children=2, child_counters_map={'': set(['RowsReturnedRate', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=71, name='RowsReturnedRate', unit=1), TCounter(value=14000437, name='TotalTime', unit=5)], metadata=3), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='NonGroupingAggregator 0', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['BuildTime', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='BuildTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=8192, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=False, name='EXCHANGE_NODE (id=2)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=2), num_children=3, child_counters_map={'': set(['RowsReturned', 'RowsReturnedRate', 'ConvertRowBatchTime', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='ConvertRowBatchTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=71, name='RowsReturnedRate', unit=1), TCounter(value=14000437, name='TotalTime', unit=5)], metadata=2), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Buffer pool', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ReadIoWaitTime', 'WriteIoOps', 'SystemAllocTime', 'CumulativeAllocations', 'ReadIoOps', 'WriteIoBytes', 'WriteIoWaitTime', 'PeakUnpinnedBytes', 'AllocTime', 'ReadIoBytes', 'CumulativeAllocationBytes', 'PeakReservation', 'PeakUsedReservation'])}, event_sequences=None, counters=[TCounter(value=0, name='AllocTime', unit=5), TCounter(value=16384, name='CumulativeAllocationBytes', unit=3), TCounter(value=2, name='CumulativeAllocations', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUnpinnedBytes', unit=3), TCounter(value=16384, name='PeakUsedReservation', unit=3), TCounter(value=0, name='ReadIoBytes', unit=3), TCounter(value=0, name='ReadIoOps', unit=0), TCounter(value=0, name='ReadIoWaitTime', unit=5), TCounter(value=0, name='SystemAllocTime', unit=5), TCounter(value=0, name='TotalTime', unit=5), TCounter(value=0, name='WriteIoBytes', unit=3), TCounter(value=0, name='WriteIoOps', unit=0), TCounter(value=0, name='WriteIoWaitTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Dequeue', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['FirstBatchWaitTime', 'TotalGetBatchTime', 'TotalBytesDequeued']), 'TotalGetBatchTime': set(['DataWaitTime'])}, event_sequences=None, counters=[TCounter(value=14000437, name='DataWaitTime', unit=5), TCounter(value=13000406, name='FirstBatchWaitTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16, name='TotalBytesDequeued', unit=3), TCounter(value=14000437, name='TotalGetBatchTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Enqueue', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['TotalBatchesEnqueued', 'TotalHasDeferredRPCsTime', 'TotalEosReceived', 'DeserializeRowBatchTime', 'TotalRPCsDeferred', 'TotalBytesReceived', 'TotalEarlySenders', 'TotalBatchesReceived'])}, event_sequences=None, counters=[TCounter(value=0, name='DeserializeRowBatchTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=1, name='TotalBatchesEnqueued', unit=0), TCounter(value=1, name='TotalBatchesReceived', unit=0), TCounter(value=12, name='TotalBytesReceived', unit=3), TCounter(value=0, name='TotalEarlySenders', unit=0), TCounter(value=1, name='TotalEosReceived', unit=0), TCounter(value=0, name='TotalHasDeferredRPCsTime', unit=5), TCounter(value=0, name='TotalRPCsDeferred', unit=0), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='CodeGen', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['IrGenerationTime', 'OptimizationTime', 'LoadTime', 'CodegenInvoluntaryContextSwitches', 'CompileTime', 'NumInstructions', 'PeakMemoryUsage', 'ModuleBitcodeSize', 'CodegenVoluntaryContextSwitches', 'CodegenTotalWallClockTime', 'NumFunctions', 'PrepareTime']), 'CodegenTotalWallClockTime': set(['CodegenSysTime', 'CodegenUserTime'])}, event_sequences=None, counters=[TCounter(value=0, name='CodegenInvoluntaryContextSwitches', unit=0), TCounter(value=991000, name='CodegenSysTime', unit=5), TCounter(value=12000374, name='CodegenTotalWallClockTime', unit=5), TCounter(value=10850000, name='CodegenUserTime', unit=5), TCounter(value=2, name='CodegenVoluntaryContextSwitches', unit=0), TCounter(value=0, name='CompileTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='IrGenerationTime', unit=5), TCounter(value=0, name='LoadTime', unit=5), TCounter(value=2392220, name='ModuleBitcodeSize', unit=3), TCounter(value=0, name='NumFunctions', unit=0), TCounter(value=0, name='NumInstructions', unit=0), TCounter(value=0, name='OptimizationTime', unit=5), TCounter(value=0, name='PeakMemoryUsage', unit=3), TCounter(value=12000374, name='PrepareTime', unit=5), TCounter(value=12000374, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Coordinator Fragment F01', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=1, child_counters_map={}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['Last report received time'], indent=True, name='Instance 7e44315b6c3047bc:3ea0932400000000 (host=impala-013:22000)', time_series_counters=[TTimeSeriesCounter(start_index=0, values=[], name='MemoryUsage', unit=3, period_ms=500), TTimeSeriesCounter(start_index=0, values=[], name='ThreadUsage', unit=0, period_ms=500)], info_strings={'Last report received time': '2021-06-25 16:02:22.874'}, summary_stats_counters=None, node_metadata=None, num_children=5, child_counters_map={'': set(['ExchangeScanRatio', 'TotalNetworkSendTime', 'PerHostPeakMemUsage', 'AverageThreadTokens', 'PeakMemoryUsage', 'TotalStorageWaitTime', 'TotalThreadsInvoluntaryContextSwitches', 'TotalThreadsTotalWallClockTime', 'RowsProduced', 'TotalThreadsVoluntaryContextSwitches', 'TotalNetworkReceiveTime', 'BloomFilterBytes', 'PeakReservation', 'PeakUsedReservation']), 'TotalThreadsTotalWallClockTime': set(['TotalThreadsUserTime', 'TotalThreadsSysTime'])}, event_sequences=[TEventSequence(timestamps=[0, 26000811, 26000811, 57001778, 57001778], labels=['Prepare Finished', 'Open Finished', 'First Batch Produced', 'First Batch Sent', 'ExecInternal Finished'], name='Fragment Instance Lifecycle Event Timeline')], counters=[TCounter(value=0, name='AverageThreadTokens', unit=6), TCounter(value=0, name='BloomFilterBytes', unit=3), TCounter(value=0, name='ExchangeScanRatio', unit=6), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=40960, name='PeakMemoryUsage', unit=3), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=102534, name='PerHostPeakMemUsage', unit=3), TCounter(value=1, name='RowsProduced', unit=0), TCounter(value=14000437, name='TotalNetworkReceiveTime', unit=5), TCounter(value=0, name='TotalNetworkSendTime', unit=5), TCounter(value=0, name='TotalStorageWaitTime', unit=5), TCounter(value=0, name='TotalThreadsInvoluntaryContextSwitches', unit=0), TCounter(value=1081000, name='TotalThreadsSysTime', unit=5), TCounter(value=57001778, name='TotalThreadsTotalWallClockTime', unit=5), TCounter(value=11838000, name='TotalThreadsUserTime', unit=5), TCounter(value=5, name='TotalThreadsVoluntaryContextSwitches', unit=0), TCounter(value=57001778, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Buffer pool', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ReadIoWaitTime', 'WriteIoOps', 'SystemAllocTime', 'CumulativeAllocations', 'ReadIoOps', 'ReservationLimit', 'WriteIoBytes', 'WriteIoWaitTime', 'PeakUnpinnedBytes', 'AllocTime', 'ReadIoBytes', 'CumulativeAllocationBytes', 'PeakReservation', 'PeakUsedReservation'])}, event_sequences=None, counters=[TCounter(value=0, name='AllocTime', unit=5), TCounter(value=0, name='CumulativeAllocationBytes', unit=3), TCounter(value=0, name='CumulativeAllocations', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUnpinnedBytes', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=0, name='ReadIoBytes', unit=3), TCounter(value=0, name='ReadIoOps', unit=0), TCounter(value=0, name='ReadIoWaitTime', unit=5), TCounter(value=0, name='ReservationLimit', unit=3), TCounter(value=0, name='SystemAllocTime', unit=5), TCounter(value=0, name='TotalTime', unit=5), TCounter(value=0, name='WriteIoBytes', unit=3), TCounter(value=0, name='WriteIoOps', unit=0), TCounter(value=0, name='WriteIoWaitTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Fragment Instance Lifecycle Timings', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ExecTime', 'OpenTime', 'PrepareTime']), 'ExecTime': set(['ExecTreeExecTime']), 'OpenTime': set(['ExecTreeOpenTime']), 'PrepareTime': set(['ExecTreePrepareTime'])}, event_sequences=None, counters=[TCounter(value=31000967, name='ExecTime', unit=5), TCounter(value=0, name='ExecTreeExecTime', unit=5), TCounter(value=14000437, name='ExecTreeOpenTime', unit=5), TCounter(value=0, name='ExecTreePrepareTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=26000811, name='OpenTime', unit=5), TCounter(value=0, name='PrepareTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='PLAN_ROOT_SINK', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=0, plan_node_id=None), num_children=0, child_counters_map={'': set(['PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=31000967, name='InactiveTotalTime', unit=5), TCounter(value=0, name='PeakMemoryUsage', unit=3), TCounter(value=31000967, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='AGGREGATION_NODE (id=3)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=3), num_children=2, child_counters_map={'': set(['RowsReturnedRate', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=[TEventSequence(timestamps=[12000374, 26000811, 26000811, 26000811, 26000811, 57001778], labels=['Open Started', 'Open Finished', 'First Batch Requested', 'First Batch Returned', 'Last Batch Returned', 'Closed'], name='Node Lifecycle Event Timeline')], counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=71, name='RowsReturnedRate', unit=1), TCounter(value=14000437, name='TotalTime', unit=5)], metadata=3), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='NonGroupingAggregator 0', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['BuildTime', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='BuildTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=8192, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=False, name='EXCHANGE_NODE (id=2)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=2), num_children=3, child_counters_map={'': set(['RowsReturned', 'RowsReturnedRate', 'ConvertRowBatchTime', 'PeakMemoryUsage'])}, event_sequences=[TEventSequence(timestamps=[12000374, 25000780, 25000780, 26000811, 26000811, 26000811], labels=['Open Started', 'Open Finished', 'First Batch Requested', 'First Batch Returned', 'Last Batch Returned', 'Closed'], name='Node Lifecycle Event Timeline')], counters=[TCounter(value=0, name='ConvertRowBatchTime', unit=5), TCounter(value=14000437, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=71, name='RowsReturnedRate', unit=1), TCounter(value=14000437, name='TotalTime', unit=5)], metadata=2), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Buffer pool', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ReadIoWaitTime', 'WriteIoOps', 'SystemAllocTime', 'CumulativeAllocations', 'ReadIoOps', 'WriteIoBytes', 'WriteIoWaitTime', 'PeakUnpinnedBytes', 'AllocTime', 'ReadIoBytes', 'CumulativeAllocationBytes', 'PeakReservation', 'PeakUsedReservation'])}, event_sequences=None, counters=[TCounter(value=0, name='AllocTime', unit=5), TCounter(value=16384, name='CumulativeAllocationBytes', unit=3), TCounter(value=2, name='CumulativeAllocations', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUnpinnedBytes', unit=3), TCounter(value=16384, name='PeakUsedReservation', unit=3), TCounter(value=0, name='ReadIoBytes', unit=3), TCounter(value=0, name='ReadIoOps', unit=0), TCounter(value=0, name='ReadIoWaitTime', unit=5), TCounter(value=0, name='SystemAllocTime', unit=5), TCounter(value=0, name='TotalTime', unit=5), TCounter(value=0, name='WriteIoBytes', unit=3), TCounter(value=0, name='WriteIoOps', unit=0), TCounter(value=0, name='WriteIoWaitTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Dequeue', time_series_counters=[TTimeSeriesCounter(start_index=0, values=[], name='BytesDequeued', unit=3, period_ms=500)], info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['FirstBatchWaitTime', 'TotalGetBatchTime', 'TotalBytesDequeued']), 'TotalGetBatchTime': set(['DataWaitTime'])}, event_sequences=None, counters=[TCounter(value=14000437, name='DataWaitTime', unit=5), TCounter(value=13000406, name='FirstBatchWaitTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16, name='TotalBytesDequeued', unit=3), TCounter(value=14000437, name='TotalGetBatchTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Enqueue', time_series_counters=[TTimeSeriesCounter(start_index=0, values=[], name='BytesReceived', unit=3, period_ms=500), TTimeSeriesCounter(start_index=0, values=[], name='DeferredQueueSize', unit=0, period_ms=500)], info_strings={}, summary_stats_counters=[TSummaryStatsCounter(total_num_values=1, name='DispatchTime', max_value=34073, sum=34073, min_value=34073, unit=5)], node_metadata=None, num_children=0, child_counters_map={'': set(['TotalBatchesEnqueued', 'TotalHasDeferredRPCsTime', 'TotalEosReceived', 'DeserializeRowBatchTime', 'TotalRPCsDeferred', 'TotalBytesReceived', 'TotalEarlySenders', 'TotalBatchesReceived'])}, event_sequences=None, counters=[TCounter(value=0, name='DeserializeRowBatchTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=1, name='TotalBatchesEnqueued', unit=0), TCounter(value=1, name='TotalBatchesReceived', unit=0), TCounter(value=12, name='TotalBytesReceived', unit=3), TCounter(value=0, name='TotalEarlySenders', unit=0), TCounter(value=1, name='TotalEosReceived', unit=0), TCounter(value=0, name='TotalHasDeferredRPCsTime', unit=5), TCounter(value=0, name='TotalRPCsDeferred', unit=0), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='CodeGen', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['IrGenerationTime', 'OptimizationTime', 'LoadTime', 'CodegenInvoluntaryContextSwitches', 'CompileTime', 'NumInstructions', 'PeakMemoryUsage', 'ModuleBitcodeSize', 'CodegenVoluntaryContextSwitches', 'CodegenTotalWallClockTime', 'NumFunctions', 'PrepareTime']), 'CodegenTotalWallClockTime': set(['CodegenSysTime', 'CodegenUserTime'])}, event_sequences=None, counters=[TCounter(value=0, name='CodegenInvoluntaryContextSwitches', unit=0), TCounter(value=991000, name='CodegenSysTime', unit=5), TCounter(value=12000374, name='CodegenTotalWallClockTime', unit=5), TCounter(value=10850000, name='CodegenUserTime', unit=5), TCounter(value=2, name='CodegenVoluntaryContextSwitches', unit=0), TCounter(value=0, name='CompileTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='IrGenerationTime', unit=5), TCounter(value=0, name='LoadTime', unit=5), TCounter(value=2392220, name='ModuleBitcodeSize', unit=3), TCounter(value=0, name='NumFunctions', unit=0), TCounter(value=0, name='NumInstructions', unit=0), TCounter(value=0, name='OptimizationTime', unit=5), TCounter(value=0, name='PeakMemoryUsage', unit=3), TCounter(value=12000374, name='PrepareTime', unit=5), TCounter(value=12000374, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['split sizes', 'completion times', 'execution rates', 'num instances'], indent=True, name='Averaged Fragment F00', time_series_counters=None, info_strings={'completion times': 'min:57.001ms  max:57.001ms  mean: 57.001ms  stddev:0.000ns', 'split sizes': ' min: 0, max: 0, avg: 0, stddev: 0', 'execution rates': 'min:0.00 /sec  max:0.00 /sec  mean:0.00 /sec  stddev:0.00 /sec', 'num instances': '1'}, summary_stats_counters=None, node_metadata=None, num_children=5, child_counters_map={'': set(['ExchangeScanRatio', 'TotalNetworkSendTime', 'PerHostPeakMemUsage', 'AverageThreadTokens', 'PeakMemoryUsage', 'TotalStorageWaitTime', 'TotalThreadsInvoluntaryContextSwitches', 'TotalThreadsTotalWallClockTime', 'RowsProduced', 'TotalThreadsVoluntaryContextSwitches', 'TotalNetworkReceiveTime', 'BloomFilterBytes', 'PeakReservation', 'PeakUsedReservation']), 'TotalThreadsTotalWallClockTime': set(['TotalThreadsUserTime', 'TotalThreadsSysTime'])}, event_sequences=None, counters=[TCounter(value=0, name='AverageThreadTokens', unit=6), TCounter(value=0, name='BloomFilterBytes', unit=3), TCounter(value=0, name='ExchangeScanRatio', unit=6), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=90246, name='PeakMemoryUsage', unit=3), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=102534, name='PerHostPeakMemUsage', unit=3), TCounter(value=1, name='RowsProduced', unit=0), TCounter(value=0, name='TotalNetworkReceiveTime', unit=5), TCounter(value=1000031, name='TotalNetworkSendTime', unit=5), TCounter(value=1000032, name='TotalStorageWaitTime', unit=5), TCounter(value=0, name='TotalThreadsInvoluntaryContextSwitches', unit=0), TCounter(value=1023000, name='TotalThreadsSysTime', unit=5), TCounter(value=29000905, name='TotalThreadsTotalWallClockTime', unit=5), TCounter(value=20878000, name='TotalThreadsUserTime', unit=5), TCounter(value=117, name='TotalThreadsVoluntaryContextSwitches', unit=0), TCounter(value=26000811, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Buffer pool', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ReadIoWaitTime', 'WriteIoOps', 'SystemAllocTime', 'CumulativeAllocations', 'ReadIoOps', 'ReservationLimit', 'WriteIoBytes', 'WriteIoWaitTime', 'PeakUnpinnedBytes', 'AllocTime', 'ReadIoBytes', 'CumulativeAllocationBytes', 'PeakReservation', 'PeakUsedReservation'])}, event_sequences=None, counters=[TCounter(value=0, name='AllocTime', unit=5), TCounter(value=0, name='CumulativeAllocationBytes', unit=3), TCounter(value=0, name='CumulativeAllocations', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUnpinnedBytes', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=0, name='ReadIoBytes', unit=3), TCounter(value=0, name='ReadIoOps', unit=0), TCounter(value=0, name='ReadIoWaitTime', unit=5), TCounter(value=0, name='ReservationLimit', unit=3), TCounter(value=0, name='SystemAllocTime', unit=5), TCounter(value=0, name='TotalTime', unit=5), TCounter(value=0, name='WriteIoBytes', unit=3), TCounter(value=0, name='WriteIoOps', unit=0), TCounter(value=0, name='WriteIoWaitTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Fragment Instance Lifecycle Timings', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ExecTime', 'OpenTime', 'PrepareTime']), 'ExecTime': set(['ExecTreeExecTime']), 'OpenTime': set(['ExecTreeOpenTime']), 'PrepareTime': set(['ExecTreePrepareTime'])}, event_sequences=None, counters=[TCounter(value=1000031, name='ExecTime', unit=5), TCounter(value=0, name='ExecTreeExecTime', unit=5), TCounter(value=5000156, name='ExecTreeOpenTime', unit=5), TCounter(value=0, name='ExecTreePrepareTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=25000780, name='OpenTime', unit=5), TCounter(value=0, name='PrepareTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='KrpcDataStreamSender (dst_id=2)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=1, plan_node_id=None), num_children=0, child_counters_map={'': set(['SerializeBatchTime', 'UncompressedRowBatchSize', 'RpcFailure', 'PeakMemoryUsage', 'RpcRetry', 'EosSent', 'TotalBytesSent', 'RowsSent'])}, event_sequences=None, counters=[TCounter(value=1, name='EosSent', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsSent', unit=0), TCounter(value=0, name='RpcFailure', unit=0), TCounter(value=0, name='RpcRetry', unit=0), TCounter(value=0, name='SerializeBatchTime', unit=5), TCounter(value=12, name='TotalBytesSent', unit=3), TCounter(value=1000031, name='TotalTime', unit=5), TCounter(value=16, name='UncompressedRowBatchSize', unit=3)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='AGGREGATION_NODE (id=1)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=1), num_children=2, child_counters_map={'': set(['RowsReturnedRate', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=199, name='RowsReturnedRate', unit=1), TCounter(value=5000156, name='TotalTime', unit=5)], metadata=1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='NonGroupingAggregator 0', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['BuildTime', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='BuildTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=8192, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=False, name='KUDU_SCAN_NODE (id=0)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=0), num_children=0, child_counters_map={'': set(['NumScannerThreadsStarted', 'ScanRangesComplete', 'PeakScannerThreadConcurrency', 'KuduClientTime', 'NumScannerThreadMemUnavailable', 'KuduRemoteScanTokens', 'PeakMemoryUsage', 'ScannerThreadsInvoluntaryContextSwitches', 'RowBatchQueuePutWaitTime', 'ScannerThreadsVoluntaryContextSwitches', 'RowBatchQueueGetWaitTime', 'MaterializeTupleTime(*)', 'ScannerThreadsTotalWallClockTime', 'RowBatchQueuePeakMemoryUsage', 'RowsReturnedRate', 'RowsReturned', 'TotalKuduScanRoundTrips', 'RowBatchesEnqueued', 'AverageScannerThreadConcurrency', 'RowBatchBytesEnqueued', 'RowsRead']), 'ScannerThreadsTotalWallClockTime': set(['ScannerThreadsUserTime', 'ScannerThreadsSysTime'])}, event_sequences=None, counters=[TCounter(value=0, name='AverageScannerThreadConcurrency', unit=6), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=1000032, name='KuduClientTime', unit=5), TCounter(value=1, name='KuduRemoteScanTokens', unit=0), TCounter(value=0, name='MaterializeTupleTime(*)', unit=5), TCounter(value=0, name='NumScannerThreadMemUnavailable', unit=0), TCounter(value=1, name='NumScannerThreadsStarted', unit=0), TCounter(value=49152, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='PeakScannerThreadConcurrency', unit=0), TCounter(value=0, name='RowBatchBytesEnqueued', unit=3), TCounter(value=3000094, name='RowBatchQueueGetWaitTime', unit=5), TCounter(value=40960, name='RowBatchQueuePeakMemoryUsage', unit=3), TCounter(value=0, name='RowBatchQueuePutWaitTime', unit=5), TCounter(value=256, name='RowBatchesEnqueued', unit=0), TCounter(value=262000, name='RowsRead', unit=0), TCounter(value=262000, name='RowsReturned', unit=0), TCounter(value=37427405, name='RowsReturnedRate', unit=1), TCounter(value=1, name='ScanRangesComplete', unit=0), TCounter(value=0, name='ScannerThreadsInvoluntaryContextSwitches', unit=0), TCounter(value=0, name='ScannerThreadsSysTime', unit=5), TCounter(value=3000094, name='ScannerThreadsTotalWallClockTime', unit=5), TCounter(value=415000, name='ScannerThreadsUserTime', unit=5), TCounter(value=2, name='ScannerThreadsVoluntaryContextSwitches', unit=0), TCounter(value=1, name='TotalKuduScanRoundTrips', unit=0), TCounter(value=7000218, name='TotalTime', unit=5)], metadata=0), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='CodeGen', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['IrGenerationTime', 'OptimizationTime', 'LoadTime', 'CodegenInvoluntaryContextSwitches', 'CompileTime', 'NumInstructions', 'PeakMemoryUsage', 'ModuleBitcodeSize', 'CodegenVoluntaryContextSwitches', 'CodegenTotalWallClockTime', 'NumFunctions', 'PrepareTime']), 'CodegenTotalWallClockTime': set(['CodegenSysTime', 'CodegenUserTime'])}, event_sequences=None, counters=[TCounter(value=0, name='CodegenInvoluntaryContextSwitches', unit=0), TCounter(value=0, name='CodegenSysTime', unit=5), TCounter(value=20000624, name='CodegenTotalWallClockTime', unit=5), TCounter(value=19844000, name='CodegenUserTime', unit=5), TCounter(value=0, name='CodegenVoluntaryContextSwitches', unit=0), TCounter(value=2000063, name='CompileTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='IrGenerationTime', unit=5), TCounter(value=0, name='LoadTime', unit=5), TCounter(value=2392220, name='ModuleBitcodeSize', unit=3), TCounter(value=5, name='NumFunctions', unit=0), TCounter(value=55, name='NumInstructions', unit=0), TCounter(value=5000156, name='OptimizationTime', unit=5), TCounter(value=28160, name='PeakMemoryUsage', unit=3), TCounter(value=13000405, name='PrepareTime', unit=5), TCounter(value=20000624, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Fragment F00', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=1, child_counters_map={}, event_sequences=None, counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['Last report received time', 'Hdfs split stats (&lt;volume id&gt;:&lt;# splits&gt;/&lt;split lengths&gt;)'], indent=True, name='Instance 7e44315b6c3047bc:3ea0932400000001 (host=impala-013:22000)', time_series_counters=[TTimeSeriesCounter(start_index=0, values=[], name='MemoryUsage', unit=3, period_ms=500), TTimeSeriesCounter(start_index=0, values=[], name='ThreadUsage', unit=0, period_ms=500)], info_strings={'Hdfs split stats (&lt;volume id&gt;:&lt;# splits&gt;/&lt;split lengths&gt;)': '', 'Last report received time': '2021-06-25 16:02:22.874'}, summary_stats_counters=None, node_metadata=None, num_children=5, child_counters_map={'': set(['ExchangeScanRatio', 'TotalNetworkSendTime', 'PerHostPeakMemUsage', 'AverageThreadTokens', 'PeakMemoryUsage', 'TotalStorageWaitTime', 'TotalThreadsInvoluntaryContextSwitches', 'TotalThreadsTotalWallClockTime', 'RowsProduced', 'TotalThreadsVoluntaryContextSwitches', 'TotalNetworkReceiveTime', 'BloomFilterBytes', 'PeakReservation', 'PeakUsedReservation']), 'TotalThreadsTotalWallClockTime': set(['TotalThreadsUserTime', 'TotalThreadsSysTime'])}, event_sequences=[TEventSequence(timestamps=[0, 25000780, 25000780, 25000780, 26000811], labels=['Prepare Finished', 'Open Finished', 'First Batch Produced', 'First Batch Sent', 'ExecInternal Finished'], name='Fragment Instance Lifecycle Event Timeline')], counters=[TCounter(value=0, name='AverageThreadTokens', unit=6), TCounter(value=0, name='BloomFilterBytes', unit=3), TCounter(value=0, name='ExchangeScanRatio', unit=6), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=90246, name='PeakMemoryUsage', unit=3), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=102534, name='PerHostPeakMemUsage', unit=3), TCounter(value=1, name='RowsProduced', unit=0), TCounter(value=0, name='TotalNetworkReceiveTime', unit=5), TCounter(value=1000031, name='TotalNetworkSendTime', unit=5), TCounter(value=1000032, name='TotalStorageWaitTime', unit=5), TCounter(value=0, name='TotalThreadsInvoluntaryContextSwitches', unit=0), TCounter(value=1023000, name='TotalThreadsSysTime', unit=5), TCounter(value=29000905, name='TotalThreadsTotalWallClockTime', unit=5), TCounter(value=20878000, name='TotalThreadsUserTime', unit=5), TCounter(value=117, name='TotalThreadsVoluntaryContextSwitches', unit=0), TCounter(value=26000811, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Buffer pool', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ReadIoWaitTime', 'WriteIoOps', 'SystemAllocTime', 'CumulativeAllocations', 'ReadIoOps', 'ReservationLimit', 'WriteIoBytes', 'WriteIoWaitTime', 'PeakUnpinnedBytes', 'AllocTime', 'ReadIoBytes', 'CumulativeAllocationBytes', 'PeakReservation', 'PeakUsedReservation'])}, event_sequences=None, counters=[TCounter(value=0, name='AllocTime', unit=5), TCounter(value=0, name='CumulativeAllocationBytes', unit=3), TCounter(value=0, name='CumulativeAllocations', unit=0), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='PeakReservation', unit=3), TCounter(value=0, name='PeakUnpinnedBytes', unit=3), TCounter(value=0, name='PeakUsedReservation', unit=3), TCounter(value=0, name='ReadIoBytes', unit=3), TCounter(value=0, name='ReadIoOps', unit=0), TCounter(value=0, name='ReadIoWaitTime', unit=5), TCounter(value=0, name='ReservationLimit', unit=3), TCounter(value=0, name='SystemAllocTime', unit=5), TCounter(value=0, name='TotalTime', unit=5), TCounter(value=0, name='WriteIoBytes', unit=3), TCounter(value=0, name='WriteIoOps', unit=0), TCounter(value=0, name='WriteIoWaitTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='Fragment Instance Lifecycle Timings', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['ExecTime', 'OpenTime', 'PrepareTime']), 'ExecTime': set(['ExecTreeExecTime']), 'OpenTime': set(['ExecTreeOpenTime']), 'PrepareTime': set(['ExecTreePrepareTime'])}, event_sequences=None, counters=[TCounter(value=1000031, name='ExecTime', unit=5), TCounter(value=0, name='ExecTreeExecTime', unit=5), TCounter(value=5000156, name='ExecTreeOpenTime', unit=5), TCounter(value=0, name='ExecTreePrepareTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=25000780, name='OpenTime', unit=5), TCounter(value=0, name='PrepareTime', unit=5), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=['ExecOption'], indent=True, name='KrpcDataStreamSender (dst_id=2)', time_series_counters=[TTimeSeriesCounter(start_index=0, values=[], name='BytesSent', unit=3, period_ms=500)], info_strings={'ExecOption': 'Unpartitioned Sender Codegen Disabled: not needed'}, summary_stats_counters=[TSummaryStatsCounter(total_num_values=1, name='NetworkThroughput', max_value=97288, sum=97288, min_value=97288, unit=4)], node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=1, plan_node_id=None), num_children=0, child_counters_map={'': set(['SerializeBatchTime', 'UncompressedRowBatchSize', 'RpcFailure', 'PeakMemoryUsage', 'RpcRetry', 'EosSent', 'TotalBytesSent', 'RowsSent'])}, event_sequences=None, counters=[TCounter(value=1, name='EosSent', unit=0), TCounter(value=1000031, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsSent', unit=0), TCounter(value=0, name='RpcFailure', unit=0), TCounter(value=0, name='RpcRetry', unit=0), TCounter(value=0, name='SerializeBatchTime', unit=5), TCounter(value=12, name='TotalBytesSent', unit=3), TCounter(value=1000031, name='TotalTime', unit=5), TCounter(value=16, name='UncompressedRowBatchSize', unit=3)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='AGGREGATION_NODE (id=1)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=1), num_children=2, child_counters_map={'': set(['RowsReturnedRate', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=[TEventSequence(timestamps=[20000624, 25000780, 25000780, 25000780, 25000780, 26000811], labels=['Open Started', 'Open Finished', 'First Batch Requested', 'First Batch Returned', 'Last Batch Returned', 'Closed'], name='Node Lifecycle Event Timeline')], counters=[TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=16384, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=199, name='RowsReturnedRate', unit=1), TCounter(value=5000156, name='TotalTime', unit=5)], metadata=1), TRuntimeProfileNode(info_strings_display_order=['ExecOption'], indent=True, name='NonGroupingAggregator 0', time_series_counters=None, info_strings={'ExecOption': 'Codegen Enabled'}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['BuildTime', 'RowsReturned', 'PeakMemoryUsage'])}, event_sequences=None, counters=[TCounter(value=0, name='BuildTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=8192, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='RowsReturned', unit=0), TCounter(value=0, name='TotalTime', unit=5)], metadata=-1), TRuntimeProfileNode(info_strings_display_order=[], indent=False, name='KUDU_SCAN_NODE (id=0)', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=TRuntimeProfileNodeMetadata(data_sink_id=None, plan_node_id=0), num_children=0, child_counters_map={'': set(['NumScannerThreadsStarted', 'ScanRangesComplete', 'PeakScannerThreadConcurrency', 'KuduClientTime', 'NumScannerThreadMemUnavailable', 'KuduRemoteScanTokens', 'PeakMemoryUsage', 'ScannerThreadsInvoluntaryContextSwitches', 'RowBatchQueuePutWaitTime', 'ScannerThreadsVoluntaryContextSwitches', 'RowBatchQueueGetWaitTime', 'MaterializeTupleTime(*)', 'ScannerThreadsTotalWallClockTime', 'RowBatchQueuePeakMemoryUsage', 'RowsReturnedRate', 'RowsReturned', 'TotalKuduScanRoundTrips', 'RowBatchesEnqueued', 'AverageScannerThreadConcurrency', 'RowBatchBytesEnqueued', 'RowsRead']), 'ScannerThreadsTotalWallClockTime': set(['ScannerThreadsUserTime', 'ScannerThreadsSysTime'])}, event_sequences=[TEventSequence(timestamps=[20000624, 22000686, 22000686, 24000749, 25000780, 25000780], labels=['Open Started', 'Open Finished', 'First Batch Requested', 'First Batch Returned', 'Last Batch Returned', 'Closed'], name='Node Lifecycle Event Timeline')], counters=[TCounter(value=0, name='AverageScannerThreadConcurrency', unit=6), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=1000032, name='KuduClientTime', unit=5), TCounter(value=1, name='KuduRemoteScanTokens', unit=0), TCounter(value=0, name='MaterializeTupleTime(*)', unit=5), TCounter(value=0, name='NumScannerThreadMemUnavailable', unit=0), TCounter(value=1, name='NumScannerThreadsStarted', unit=0), TCounter(value=49152, name='PeakMemoryUsage', unit=3), TCounter(value=1, name='PeakScannerThreadConcurrency', unit=0), TCounter(value=0, name='RowBatchBytesEnqueued', unit=3), TCounter(value=3000094, name='RowBatchQueueGetWaitTime', unit=5), TCounter(value=40960, name='RowBatchQueuePeakMemoryUsage', unit=3), TCounter(value=0, name='RowBatchQueuePutWaitTime', unit=5), TCounter(value=256, name='RowBatchesEnqueued', unit=0), TCounter(value=262000, name='RowsRead', unit=0), TCounter(value=262000, name='RowsReturned', unit=0), TCounter(value=37427405, name='RowsReturnedRate', unit=1), TCounter(value=1, name='ScanRangesComplete', unit=0), TCounter(value=0, name='ScannerThreadsInvoluntaryContextSwitches', unit=0), TCounter(value=0, name='ScannerThreadsSysTime', unit=5), TCounter(value=3000094, name='ScannerThreadsTotalWallClockTime', unit=5), TCounter(value=415000, name='ScannerThreadsUserTime', unit=5), TCounter(value=2, name='ScannerThreadsVoluntaryContextSwitches', unit=0), TCounter(value=1, name='TotalKuduScanRoundTrips', unit=0), TCounter(value=7000218, name='TotalTime', unit=5)], metadata=0), TRuntimeProfileNode(info_strings_display_order=[], indent=True, name='CodeGen', time_series_counters=None, info_strings={}, summary_stats_counters=None, node_metadata=None, num_children=0, child_counters_map={'': set(['IrGenerationTime', 'OptimizationTime', 'LoadTime', 'CodegenInvoluntaryContextSwitches', 'CompileTime', 'NumInstructions', 'PeakMemoryUsage', 'ModuleBitcodeSize', 'CodegenVoluntaryContextSwitches', 'CodegenTotalWallClockTime', 'NumFunctions', 'PrepareTime']), 'CodegenTotalWallClockTime': set(['CodegenSysTime', 'CodegenUserTime'])}, event_sequences=None, counters=[TCounter(value=0, name='CodegenInvoluntaryContextSwitches', unit=0), TCounter(value=0, name='CodegenSysTime', unit=5), TCounter(value=20000624, name='CodegenTotalWallClockTime', unit=5), TCounter(value=19844000, name='CodegenUserTime', unit=5), TCounter(value=0, name='CodegenVoluntaryContextSwitches', unit=0), TCounter(value=2000063, name='CompileTime', unit=5), TCounter(value=0, name='InactiveTotalTime', unit=5), TCounter(value=0, name='IrGenerationTime', unit=5), TCounter(value=0, name='LoadTime', unit=5), TCounter(value=2392220, name='ModuleBitcodeSize', unit=3), TCounter(value=5, name='NumFunctions', unit=0), TCounter(value=55, name='NumInstructions', unit=0), TCounter(value=5000156, name='OptimizationTime', unit=5), TCounter(value=28160, name='PeakMemoryUsage', unit=3), TCounter(value=13000405, name='PrepareTime', unit=5), TCounter(value=20000624, name='TotalTime', unit=5)], metadata=-1)], exec_summary=TExecSummary(status=None, is_queued=None, queued_reason=None, error_logs=None, state=0, progress=None, nodes=None, exch_to_sender_map=None))
</code></pre></div><p>完整解析代码可以参考：<a href="https://github.com/centercode/code-samples/tree/1ec4a638c71a9a593f38bab1acdc6e65ce6a9183/impala-sample/impala_profile_log_parse" target="_blank" rel="noopener noreferrer">impala_profile_log_parse<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>Impala4.0内置了一个 profile 解析工具，使用方式：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Docker 方式</span>
<span class="token function">cat</span> <span class="token variable">${path_to_profile_file}</span> <span class="token operator">|</span> <span class="token function">docker</span> run <span class="token parameter variable">-i</span> apache/impala:4.0.0-impala_profile_tool
<span class="token comment"># 开发环境</span>
<span class="token variable">${IMPALA_HOME}</span>/be/build/latest/util/impala-profile-tool <span class="token operator">&lt;</span> <span class="token variable">${path_to_profile_file}</span>
</code></pre></div><h3 id="参考"><a href="#参考" class="header-anchor">$</a> 参考</h3> <p><a href="http://mail-archives.apache.org/mod_mbox/impala-user/201908.mbox/%3CCAEoRBexmjJ7hNfHo_yLFyc0KGQDvMPKNTH--VPOfTO-w=X18qQ@mail.gmail.com%3E" target="_blank" rel="noopener noreferrer">Re: How to parse a query plan /summary/profile<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://stackoverflow.com/questions/61296108/how-to-understand-zlib-compressed-query-profiles-of-apache-impala" target="_blank" rel="noopener noreferrer">How to understand zlib-compressed query profiles of Apache Impala<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">8/21/2022, 9:31:13 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/bigdata/impala/impala.html" class="prev">
        Impala
      </a></span> <span class="next"><a href="/bigdata/impala/impala_dev.html">
        Impala开发笔记
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.233c3d40.js" defer></script><script src="/assets/js/2.01043e44.js" defer></script><script src="/assets/js/71.0807649c.js" defer></script>
  </body>
</html>
