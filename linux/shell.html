<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Shell笔记 | yx91490的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.webp">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-QQHZM2VLM0"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QQHZM2VLM0');</script>
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?6781d2ac2dff1f3b278518419b4d4deb";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    <meta name="description" content="java, 大数据(hadoop, sqoop, kylin, zeppelin)相关技术, 工作经验记录">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="google-site-verification" content="j1Gm2ZeMV3D7mPiI08fpx91dEOSlhCAJjD4vy_pSroQ">
    <meta name="baidu-site-verification" content="4z2bGbjYMB">
    
    <link rel="preload" href="/assets/css/0.styles.003598ab.css" as="style"><link rel="preload" href="/assets/js/app.8bb29984.js" as="script"><link rel="preload" href="/assets/js/2.33a0ea92.js" as="script"><link rel="preload" href="/assets/js/189.390a4b4d.js" as="script"><link rel="prefetch" href="/assets/js/10.ac34de1e.js"><link rel="prefetch" href="/assets/js/100.9d5136c9.js"><link rel="prefetch" href="/assets/js/101.457040f0.js"><link rel="prefetch" href="/assets/js/102.214e1a22.js"><link rel="prefetch" href="/assets/js/103.0c1319a5.js"><link rel="prefetch" href="/assets/js/104.fe41e908.js"><link rel="prefetch" href="/assets/js/105.dd46a221.js"><link rel="prefetch" href="/assets/js/106.471c5cf7.js"><link rel="prefetch" href="/assets/js/107.69b7fe88.js"><link rel="prefetch" href="/assets/js/108.ed033a21.js"><link rel="prefetch" href="/assets/js/109.48eeebab.js"><link rel="prefetch" href="/assets/js/11.c6e191a3.js"><link rel="prefetch" href="/assets/js/110.ba25321a.js"><link rel="prefetch" href="/assets/js/111.098a6c1a.js"><link rel="prefetch" href="/assets/js/112.bdb497b6.js"><link rel="prefetch" href="/assets/js/113.e642dc45.js"><link rel="prefetch" href="/assets/js/114.ddb09731.js"><link rel="prefetch" href="/assets/js/115.01358cc7.js"><link rel="prefetch" href="/assets/js/116.e76ec27a.js"><link rel="prefetch" href="/assets/js/117.49949d00.js"><link rel="prefetch" href="/assets/js/118.46cb8dfc.js"><link rel="prefetch" href="/assets/js/119.624977af.js"><link rel="prefetch" href="/assets/js/12.d8dd2e86.js"><link rel="prefetch" href="/assets/js/120.5bbe0d71.js"><link rel="prefetch" href="/assets/js/121.3a39d543.js"><link rel="prefetch" href="/assets/js/122.cb1d5f52.js"><link rel="prefetch" href="/assets/js/123.7577c6fb.js"><link rel="prefetch" href="/assets/js/124.71af0098.js"><link rel="prefetch" href="/assets/js/125.a26f5c88.js"><link rel="prefetch" href="/assets/js/126.6d06207a.js"><link rel="prefetch" href="/assets/js/127.a3c688a9.js"><link rel="prefetch" href="/assets/js/128.333adb01.js"><link rel="prefetch" href="/assets/js/129.6c27c894.js"><link rel="prefetch" href="/assets/js/13.74ad55a2.js"><link rel="prefetch" href="/assets/js/130.6d915923.js"><link rel="prefetch" href="/assets/js/131.31df8752.js"><link rel="prefetch" href="/assets/js/132.d9271930.js"><link rel="prefetch" href="/assets/js/133.b73ccfea.js"><link rel="prefetch" href="/assets/js/134.270b03c4.js"><link rel="prefetch" href="/assets/js/135.4dc2d47f.js"><link rel="prefetch" href="/assets/js/136.583dce48.js"><link rel="prefetch" href="/assets/js/137.bd58420b.js"><link rel="prefetch" href="/assets/js/138.547c3c57.js"><link rel="prefetch" href="/assets/js/139.28c43024.js"><link rel="prefetch" href="/assets/js/14.05e7e215.js"><link rel="prefetch" href="/assets/js/140.63c1a715.js"><link rel="prefetch" href="/assets/js/141.4150ca1a.js"><link rel="prefetch" href="/assets/js/142.32ceda70.js"><link rel="prefetch" href="/assets/js/143.a2c76554.js"><link rel="prefetch" href="/assets/js/144.797368ce.js"><link rel="prefetch" href="/assets/js/145.59645bf1.js"><link rel="prefetch" href="/assets/js/146.33de1e99.js"><link rel="prefetch" href="/assets/js/147.56f45229.js"><link rel="prefetch" href="/assets/js/148.e25727fc.js"><link rel="prefetch" href="/assets/js/149.0a8aa45d.js"><link rel="prefetch" href="/assets/js/15.7fa338d3.js"><link rel="prefetch" href="/assets/js/150.5b88081d.js"><link rel="prefetch" href="/assets/js/151.4a37bfc8.js"><link rel="prefetch" href="/assets/js/152.986c7dd4.js"><link rel="prefetch" href="/assets/js/153.124ede5e.js"><link rel="prefetch" href="/assets/js/154.95a1a12e.js"><link rel="prefetch" href="/assets/js/155.56b08148.js"><link rel="prefetch" href="/assets/js/156.5a50d816.js"><link rel="prefetch" href="/assets/js/157.29a94216.js"><link rel="prefetch" href="/assets/js/158.a2f43f2a.js"><link rel="prefetch" href="/assets/js/159.606452f7.js"><link rel="prefetch" href="/assets/js/16.784b850a.js"><link rel="prefetch" href="/assets/js/160.60653613.js"><link rel="prefetch" href="/assets/js/161.f6743bcc.js"><link rel="prefetch" href="/assets/js/162.1de57bce.js"><link rel="prefetch" href="/assets/js/163.4cfc92dc.js"><link rel="prefetch" href="/assets/js/164.a97b2848.js"><link rel="prefetch" href="/assets/js/165.7b15121c.js"><link rel="prefetch" href="/assets/js/166.b2e5a2d0.js"><link rel="prefetch" href="/assets/js/167.d20f88f2.js"><link rel="prefetch" href="/assets/js/168.b57fa35b.js"><link rel="prefetch" href="/assets/js/169.2fd6af4e.js"><link rel="prefetch" href="/assets/js/17.7381a196.js"><link rel="prefetch" href="/assets/js/170.97b9fb6f.js"><link rel="prefetch" href="/assets/js/171.878d6d97.js"><link rel="prefetch" href="/assets/js/172.def54853.js"><link rel="prefetch" href="/assets/js/173.b6942bb6.js"><link rel="prefetch" href="/assets/js/174.c10008ea.js"><link rel="prefetch" href="/assets/js/175.5c9a0f2d.js"><link rel="prefetch" href="/assets/js/176.8ffe1644.js"><link rel="prefetch" href="/assets/js/177.4cc4f98f.js"><link rel="prefetch" href="/assets/js/178.df1120c5.js"><link rel="prefetch" href="/assets/js/179.c9515e6f.js"><link rel="prefetch" href="/assets/js/18.87e895cc.js"><link rel="prefetch" href="/assets/js/180.c264c232.js"><link rel="prefetch" href="/assets/js/181.92a0d3c3.js"><link rel="prefetch" href="/assets/js/182.81b9f2fb.js"><link rel="prefetch" href="/assets/js/183.315bf204.js"><link rel="prefetch" href="/assets/js/184.4686abc2.js"><link rel="prefetch" href="/assets/js/185.d89719c8.js"><link rel="prefetch" href="/assets/js/186.03995c61.js"><link rel="prefetch" href="/assets/js/187.2dad1931.js"><link rel="prefetch" href="/assets/js/188.4b947b3d.js"><link rel="prefetch" href="/assets/js/19.26511bb1.js"><link rel="prefetch" href="/assets/js/190.b2145064.js"><link rel="prefetch" href="/assets/js/191.1735a67d.js"><link rel="prefetch" href="/assets/js/192.16c0fee8.js"><link rel="prefetch" href="/assets/js/193.2f01454f.js"><link rel="prefetch" href="/assets/js/194.de5f9b10.js"><link rel="prefetch" href="/assets/js/195.dbcf3e1d.js"><link rel="prefetch" href="/assets/js/196.bc541919.js"><link rel="prefetch" href="/assets/js/197.62142903.js"><link rel="prefetch" href="/assets/js/198.6dff64af.js"><link rel="prefetch" href="/assets/js/199.fc54e2c4.js"><link rel="prefetch" href="/assets/js/20.5415d28b.js"><link rel="prefetch" href="/assets/js/200.b6ea1b71.js"><link rel="prefetch" href="/assets/js/201.ede1a738.js"><link rel="prefetch" href="/assets/js/202.a379c338.js"><link rel="prefetch" href="/assets/js/203.ddb87e9e.js"><link rel="prefetch" href="/assets/js/204.c36a16eb.js"><link rel="prefetch" href="/assets/js/21.9d9ce6d2.js"><link rel="prefetch" href="/assets/js/22.f95812a0.js"><link rel="prefetch" href="/assets/js/23.a1a17881.js"><link rel="prefetch" href="/assets/js/24.bfdeab55.js"><link rel="prefetch" href="/assets/js/25.22a50ce9.js"><link rel="prefetch" href="/assets/js/26.a33d1d7b.js"><link rel="prefetch" href="/assets/js/27.e972e44d.js"><link rel="prefetch" href="/assets/js/28.5f8ddeb5.js"><link rel="prefetch" href="/assets/js/29.a0859256.js"><link rel="prefetch" href="/assets/js/3.83ed7666.js"><link rel="prefetch" href="/assets/js/30.1a2af81e.js"><link rel="prefetch" href="/assets/js/31.cf26282b.js"><link rel="prefetch" href="/assets/js/32.123751ca.js"><link rel="prefetch" href="/assets/js/33.c7ad61a1.js"><link rel="prefetch" href="/assets/js/34.d2258744.js"><link rel="prefetch" href="/assets/js/35.b8795cb6.js"><link rel="prefetch" href="/assets/js/36.ec3ada6a.js"><link rel="prefetch" href="/assets/js/37.a8bd031a.js"><link rel="prefetch" href="/assets/js/38.88dae979.js"><link rel="prefetch" href="/assets/js/39.89e8fb86.js"><link rel="prefetch" href="/assets/js/4.c36cffa4.js"><link rel="prefetch" href="/assets/js/40.c3293dc6.js"><link rel="prefetch" href="/assets/js/41.8303865e.js"><link rel="prefetch" href="/assets/js/42.815ae46a.js"><link rel="prefetch" href="/assets/js/43.6f5793d4.js"><link rel="prefetch" href="/assets/js/44.b3905490.js"><link rel="prefetch" href="/assets/js/45.65d01f71.js"><link rel="prefetch" href="/assets/js/46.341f3d64.js"><link rel="prefetch" href="/assets/js/47.d47da5a9.js"><link rel="prefetch" href="/assets/js/48.0d61742a.js"><link rel="prefetch" href="/assets/js/49.aca9f3e0.js"><link rel="prefetch" href="/assets/js/5.67f4b5e6.js"><link rel="prefetch" href="/assets/js/50.85494396.js"><link rel="prefetch" href="/assets/js/51.c863024b.js"><link rel="prefetch" href="/assets/js/52.58df719d.js"><link rel="prefetch" href="/assets/js/53.527c7dbc.js"><link rel="prefetch" href="/assets/js/54.9328e081.js"><link rel="prefetch" href="/assets/js/55.43d92349.js"><link rel="prefetch" href="/assets/js/56.4962691f.js"><link rel="prefetch" href="/assets/js/57.61f08c7a.js"><link rel="prefetch" href="/assets/js/58.d0e15e90.js"><link rel="prefetch" href="/assets/js/59.f2a16f23.js"><link rel="prefetch" href="/assets/js/6.c7ede0f2.js"><link rel="prefetch" href="/assets/js/60.5a4d3aa2.js"><link rel="prefetch" href="/assets/js/61.058b782e.js"><link rel="prefetch" href="/assets/js/62.a156a433.js"><link rel="prefetch" href="/assets/js/63.00958f2f.js"><link rel="prefetch" href="/assets/js/64.e56b37c5.js"><link rel="prefetch" href="/assets/js/65.ca902383.js"><link rel="prefetch" href="/assets/js/66.ca79276a.js"><link rel="prefetch" href="/assets/js/67.76ba9ef7.js"><link rel="prefetch" href="/assets/js/68.6f7b4d3c.js"><link rel="prefetch" href="/assets/js/69.c9f3619c.js"><link rel="prefetch" href="/assets/js/7.44bbcdc9.js"><link rel="prefetch" href="/assets/js/70.f8c778c6.js"><link rel="prefetch" href="/assets/js/71.db4b7fa9.js"><link rel="prefetch" href="/assets/js/72.b71cf51e.js"><link rel="prefetch" href="/assets/js/73.288d2d54.js"><link rel="prefetch" href="/assets/js/74.c85941d9.js"><link rel="prefetch" href="/assets/js/75.785d29ee.js"><link rel="prefetch" href="/assets/js/76.6d93e04b.js"><link rel="prefetch" href="/assets/js/77.986c4797.js"><link rel="prefetch" href="/assets/js/78.8476bc14.js"><link rel="prefetch" href="/assets/js/79.ac2d9803.js"><link rel="prefetch" href="/assets/js/8.1661bdd8.js"><link rel="prefetch" href="/assets/js/80.2414a88f.js"><link rel="prefetch" href="/assets/js/81.fc3bd703.js"><link rel="prefetch" href="/assets/js/82.174a8096.js"><link rel="prefetch" href="/assets/js/83.a9f5f337.js"><link rel="prefetch" href="/assets/js/84.79f6137c.js"><link rel="prefetch" href="/assets/js/85.a104e15e.js"><link rel="prefetch" href="/assets/js/86.10c9e45f.js"><link rel="prefetch" href="/assets/js/87.ab3edbf9.js"><link rel="prefetch" href="/assets/js/88.0bb7b3a7.js"><link rel="prefetch" href="/assets/js/89.9477ad7d.js"><link rel="prefetch" href="/assets/js/9.a4f1574b.js"><link rel="prefetch" href="/assets/js/90.95043837.js"><link rel="prefetch" href="/assets/js/91.a7cc2934.js"><link rel="prefetch" href="/assets/js/92.401d0477.js"><link rel="prefetch" href="/assets/js/93.3a2272f5.js"><link rel="prefetch" href="/assets/js/94.6dea0b57.js"><link rel="prefetch" href="/assets/js/95.6c444add.js"><link rel="prefetch" href="/assets/js/96.80c4e9bc.js"><link rel="prefetch" href="/assets/js/97.9f303494.js"><link rel="prefetch" href="/assets/js/98.f771c795.js"><link rel="prefetch" href="/assets/js/99.651808ae.js">
    <link rel="stylesheet" href="/assets/css/0.styles.003598ab.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">yx91490的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link router-link-active">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link">
  Java开发
</a></div><div class="nav-item"><a href="/bigdata/" class="nav-link">
  大数据
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="contactMe" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="contactMe" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/sql/" class="nav-link">
  SQL
</a></li><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link router-link-active">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/clang/" class="nav-link">
  C语言
</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/diagram/" class="nav-link">
  图示速查
</a></li><li class="dropdown-item"><!----> <a href="/collection/" class="nav-link">
  资料收藏
</a></li><li class="dropdown-item"><!----> <a href="/cs/" class="nav-link">
  计算机科学
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/yx91490/yx91490.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  给我留言
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/linux/shell.html" aria-current="page" class="active sidebar-link">Shell笔记</a></li><li><a href="/linux/locale.html" class="sidebar-link">Locale笔记</a></li><li><a href="/linux/network.html" class="sidebar-link">计算机网络笔记</a></li><li><a href="/linux/rpm_yum.html" class="sidebar-link">RPM命令</a></li><li><a href="/linux/centos6_centos7_diff.html" class="sidebar-link">CentOS6和CentOS7对比</a></li><li><a href="/linux/docker.html" class="sidebar-link">Docker笔记</a></li><li><a href="/linux/kill_signal.html" class="sidebar-link">Kill命令与信号</a></li><li><a href="/linux/ssh_timeout.html" class="sidebar-link">SSH设置超时时间</a></li><li><a href="/linux/netstat.html" class="sidebar-link">netstat参数分析</a></li><li><a href="/linux/symlink.html" class="sidebar-link">如何原子性地更新目录的软链接？</a></li><li><a href="/linux/admin_cmd.html" class="sidebar-link">Linux系统管理命令</a></li><li><a href="/linux/ulimit.html" class="sidebar-link">操作系统ulimit</a></li><li><a href="/linux/systemd.html" class="sidebar-link">Systemd管理命令</a></li><li><a href="/linux/systemd_wiki.html" class="sidebar-link">Systemd wiki译文</a></li><li><a href="/linux/systemd_blog.html" class="sidebar-link">Systemd作者博客 译文</a></li><li><a href="/linux/linux_desktop.html" class="sidebar-link">Ubuntu桌面使用总结</a></li><li><a href="/linux/wsl.html" class="sidebar-link">如何优雅地使用win10的Linux子系统</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>经验</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/linux/static_blog.html" class="sidebar-link">Github Pages + VuePress + Github Actions 搭建个人静态博客</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="shell笔记"><a href="#shell笔记" class="header-anchor">$</a> Shell笔记</h1> <h2 id="最佳实践"><a href="#最佳实践" class="header-anchor">$</a> 最佳实践</h2> <h3 id="适用场景"><a href="#适用场景" class="header-anchor">$</a> 适用场景</h3> <p>什么时候不应该使用bash脚本：</p> <ul><li>你的脚本太长，多达几百行</li> <li>你需要比数组更复杂的数据结构</li> <li>出现了复杂的转义问题</li> <li>有太多的字符串操作</li> <li>不太需要调用其它程序和跟其它程序管道交互</li> <li>担心性能</li></ul> <h3 id="执行"><a href="#执行" class="header-anchor">$</a> 执行</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>用bash -n对脚本进行语法检查：
<span class="token function">bash</span> <span class="token parameter variable">-n</span> myscript.sh

用bash -v跟踪脚本里的每个命令的执行：
<span class="token function">bash</span> <span class="token parameter variable">-v</span> myscript.sh

用bash -x跟踪脚本里的每个命令的执行，并附加扩充信息：
<span class="token function">bash</span> <span class="token parameter variable">-x</span> myscript.sh
</code></pre></div><h3 id="set选项"><a href="#set选项" class="header-anchor">$</a> set选项</h3> <table><thead><tr><th>短参数</th> <th>长参数</th> <th>说明</th></tr></thead> <tbody><tr><td>-a</td> <td>-o allexport</td> <td>创建或修改的每个变量或函数都具有导出属性，并标记为导出到后续命令的环境。</td></tr> <tr><td>-B</td> <td>-o braceexpand</td> <td>立即报告停止的后台任务状态，而不是在下一次主要交互时打印</td></tr> <tr><td></td> <td>-o emacs</td> <td></td></tr> <tr><td>-e</td> <td>-o errexit</td> <td>当pipeline返回非零状态时立即退出</td></tr> <tr><td>-E</td> <td>-o errtrace</td> <td></td></tr> <tr><td>-T</td> <td>-o functrace</td> <td></td></tr> <tr><td>-h</td> <td>-o hashall</td> <td></td></tr> <tr><td>-H</td> <td>-o histexpand</td> <td></td></tr> <tr><td></td> <td>-o history</td> <td></td></tr> <tr><td></td> <td>-o ignoreeof</td> <td></td></tr> <tr><td>-k</td> <td>-o keyword</td> <td></td></tr> <tr><td>-m</td> <td>-o monitor</td> <td></td></tr> <tr><td>-C</td> <td>-o noclobber</td> <td></td></tr> <tr><td>-n</td> <td>-o noexec</td> <td></td></tr> <tr><td>-f</td> <td>-o noglob</td> <td>禁止globbing(文件名扩展)</td></tr> <tr><td></td> <td>-o nolog</td> <td></td></tr> <tr><td>-b</td> <td>-o notify</td> <td>导致立即报告终止的后台作业的状态，而不是在打印下一个主要提示之前。</td></tr> <tr><td>-u</td> <td>-o nounset</td> <td>遇到不存在的变量就会报错并停止执行。</td></tr> <tr><td>-t</td> <td>-o onecmd</td> <td></td></tr> <tr><td>-P</td> <td>-o physical</td> <td></td></tr> <tr><td></td> <td>-o pipefail</td> <td></td></tr> <tr><td></td> <td>-o posix</td> <td></td></tr> <tr><td>-p</td> <td>-o privileged</td> <td></td></tr> <tr><td>-v</td> <td>-o verbose</td> <td></td></tr> <tr><td></td> <td>-o vi</td> <td></td></tr> <tr><td>-x</td> <td>-o xtrace</td> <td>用来在运行结果之前，先输出执行的那一行命令</td></tr> <tr><td></td> <td>--</td> <td>如果该选项后不跟参数，则重置位置参数，否则将位置参数设置为选项后的参数</td></tr></tbody></table> <p>参考：</p> <p><a href="https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html" target="_blank" rel="noopener noreferrer">The Set Builtin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="http://www.ruanyifeng.com/blog/2017/11/bash-set.html" target="_blank" rel="noopener noreferrer">Bash 脚本 set 命令教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="退出状态码"><a href="#退出状态码" class="header-anchor">$</a> 退出状态码</h3> <p>如果要根据命令的退出状态码做如下的分支操作，当状态码不为0且设置<code>set -o errexit</code>时会直接退出：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">grep</span> <span class="token parameter variable">-q</span> something /path/to/somefile
<span class="token assign-left variable">retval</span><span class="token operator">=</span><span class="token variable">$?</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$retval</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  do_something  <span class="token comment"># found</span>
<span class="token keyword">else</span>
  do_something_else  <span class="token comment"># not found</span>
<span class="token keyword">fi</span>
</code></pre></div><p>可以改写成：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token keyword">if</span> <span class="token function">grep</span> <span class="token parameter variable">-q</span> something /path/to/somefile<span class="token punctuation">;</span> <span class="token keyword">then</span>
  do_something  <span class="token comment"># found</span>
<span class="token keyword">else</span>
  do_something_else  <span class="token comment"># not found</span>
<span class="token keyword">fi</span>
</code></pre></div><p>参考：<a href="https://stackoverflow.com/questions/44080974/if-errexit-is-on-how-do-i-run-a-command-that-might-fail-and-get-its-exit-code" target="_blank" rel="noopener noreferrer">If errexit is on, how do I run a command that might fail and get its exit code?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="封装"><a href="#封装" class="header-anchor">$</a> 封装</h3> <p>封装提高复用性和可读性：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function-name function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">prefix</span><span class="token operator">=</span><span class="token string">&quot;[<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%Y/%m/%d<span class="token punctuation">\</span> %H:%M:%S<span class="token variable">)</span></span>]: &quot;</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${prefix}</span> <span class="token variable">$@</span>&quot;</span> <span class="token operator">&gt;</span><span class="token file-descriptor important">&amp;2</span>
<span class="token punctuation">}</span>
log <span class="token string">&quot;INFO&quot;</span> <span class="token string">&quot;a info level message&quot;</span>


<span class="token function-name function">ExtractBashComments</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">egrep</span> <span class="token string">&quot;^#&quot;</span>
<span class="token punctuation">}</span>
<span class="token function">cat</span> example.sh <span class="token operator">|</span> ExtractBashComments <span class="token operator">|</span><span class="token function">wc</span> <span class="token parameter variable">-l</span>
<span class="token assign-left variable">comments</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>ExtractBashComments <span class="token operator">&lt;</span> rules.sh<span class="token variable">)</span></span>
</code></pre></div><h3 id="变量安全性"><a href="#变量安全性" class="header-anchor">$</a> 变量安全性</h3> <p>使用readonly和local修饰变量提高安全：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># DEFAULT_VAL可以被环境变量中的值覆盖</span>
<span class="token builtin class-name">readonly</span> <span class="token assign-left variable">DEFAULT_VAL</span><span class="token operator">=</span><span class="token variable">${DEFAULT_VAL<span class="token operator">:-</span>234}</span>
<span class="token function-name function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">var</span><span class="token operator">=</span><span class="token variable">${DEFAULT_VAL}</span>
    <span class="token builtin class-name">echo</span> var:<span class="token variable">$var</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用替代品"><a href="#使用替代品" class="header-anchor">$</a> 使用替代品</h3> <p>用$()代替反单引号&quot;`&quot;的好处：</p> <ul><li><p>$()能够支持内嵌</p></li> <li><p>$()不用转义</p></li> <li><p>$()不容易与单引号混淆</p></li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> &quot;A-<span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> B-<span class="token punctuation">\</span><span class="token variable">`</span></span><span class="token builtin class-name">echo</span> C-<span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">echo</span> D<span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token punctuation">\</span><span class="token variable">`</span></span><span class="token punctuation">\</span>``<span class="token string">&quot;
echo &quot;</span>A-<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> B-<span class="token punctuation">$(</span>echo C-<span class="token punctuation">$(</span>echo D<span class="token punctuation">)</span><span class="token variable">)</span></span><span class="token punctuation">)</span>&quot;
</code></pre></div><p>用[[]]替代[]的好处：</p> <ul><li>避免转义问题</li> <li>支持新功能</li></ul> <table><thead><tr><th>对比项</th> <th>[]</th> <th>[[]]</th></tr></thead> <tbody><tr><td>逻辑或</td> <td></td> <td>||</td></tr> <tr><td>逻辑与</td> <td></td> <td>&amp;&amp;</td></tr> <tr><td>字符串比较（不需要转义）</td> <td></td> <td>&lt;</td></tr> <tr><td>通配符(glob)字符串比较</td> <td></td> <td>==</td></tr> <tr><td>正则表达式字符串比较</td> <td></td> <td>=~</td></tr></tbody></table> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">name</span><span class="token operator">=</span>b
<span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">${name}</span>&quot;</span> <span class="token punctuation">\</span><span class="token operator">&gt;</span> <span class="token string">&quot;a&quot;</span> <span class="token parameter variable">-o</span> <span class="token variable">${name}</span> <span class="token punctuation">\</span><span class="token operator">&lt;</span> <span class="token string">&quot;m&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">${name}</span>&quot;</span> <span class="token operator">&gt;</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">${name}</span>&quot;</span> <span class="token operator">&lt;</span> <span class="token string">&quot;m&quot;</span>  <span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="正则表达式-globbing"><a href="#正则表达式-globbing" class="header-anchor">$</a> 正则表达式/Globbing</h3> <p>注意正则表达式和globbing表达式都不能用引号包裹：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">t</span><span class="token operator">=</span><span class="token string">&quot;abc123&quot;</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$t</span>&quot;</span> <span class="token operator">==</span> abc* <span class="token punctuation">]</span><span class="token punctuation">]</span>         <span class="token comment"># true (globbing比较)</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$t</span>&quot;</span> <span class="token operator">=~</span> <span class="token punctuation">[</span>abc<span class="token punctuation">]</span>+<span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span>+ <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># true (正则表达式比较)</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$t</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;abc*&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>       <span class="token comment"># false (字面比较)</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$t</span>&quot;</span> <span class="token operator">=~</span> <span class="token string">&quot;abc*&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>       <span class="token comment"># false (字面比较)</span>
</code></pre></div><p>如果表达式里有空格，可以把它存储到一个变量里：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">r</span><span class="token operator">=</span><span class="token string">&quot;a b+&quot;</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;a bbb&quot;</span> <span class="token operator">=~</span> <span class="token variable">$r</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>        <span class="token comment"># true</span>
</code></pre></div><p>按Globbing方式的字符串比较也可以用到case语句中：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">case</span> <span class="token variable">$t</span> <span class="token keyword">in</span>
abc*<span class="token punctuation">)</span>  <span class="token builtin class-name">echo</span> <span class="token string">&quot;matched abc*&quot;</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre></div><h3 id="使用"><a href="#使用" class="header-anchor">$</a> 使用&lt;()</h3> <p>使用&lt;()避免使用临时文件：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#   下载并比较两个网页</span>
<span class="token function">diff</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token function">wget</span> <span class="token parameter variable">-O</span> - https://baidu.com<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token function">wget</span> <span class="token parameter variable">-O</span> - https://sogou.com<span class="token punctuation">)</span>
</code></pre></div><h3 id="使用-here-documents"><a href="#使用-here-documents" class="header-anchor">$</a> 使用&quot;here documents&quot;</h3> <p>使用&quot;here documents&quot;在标准输入上输入多行字符串：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#   任何字词都可以当作分界符</span>
<span class="token builtin class-name">command</span>  <span class="token operator">&lt;&lt;</span> <span class="token string">MARKER
...
<span class="token variable">${var}</span>
<span class="token variable"><span class="token variable">$(</span>cmd<span class="token variable">)</span></span>
...
MARKER</span>
</code></pre></div><p>如果文本里没有内嵌变量替换操作，你可以把第一个MARKER用单引号包起来：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">command</span> <span class="token operator">&lt;&lt;</span> <span class="token string">'MARKER'
...
no substitution is happening here.
$ (dollar sign) is passed through verbatim.
...
MARKER</span>
</code></pre></div><h2 id="登录shell"><a href="#登录shell" class="header-anchor">$</a> 登录shell</h2> <p>交互式 shell 和非交互式 shell：</p> <ul><li><p>交互式 shell 指的是在终端有交互的模式，比如 ssh 登录</p></li> <li><p>非交互式 shell 指的是 bash shell 以命令脚本的形式执行</p></li></ul> <p><strong>登录shell</strong>：登录shell是用户使用自己的 user ID 登录交互式 shell 的第一个进程。登录shell一定是<strong>交互式</strong>的。</p> <ul><li><p>shell首先执行/etc/profile中的命令，为系统内的所有bash用户建立默认特征。然后依次查找<code>~/.bash_profile</code>，<code>~/.bash_login</code>，<code>~/.profile</code>并执行它找到的第1个相关文件中的命令。</p></li> <li><p>退出执行<code>.bash_logout</code>文件中的命令。</p></li></ul> <p><strong>交互式非登录shell</strong>：当你在已经存在的终端 session 中开启一个 shell 会得到一个交互式非登录 shell。</p> <ul><li>交互式非登录shell执行<code>~/.bashrc</code>文件中的命令。</li></ul> <p><strong>非交互式非登录shell</strong>：</p> <ul><li>非交互式shell并不执行前面描述的启动文件中的命令(如那些运行shell脚本的shell)，然而这些shell从登录shell继承了由这些启动文件设置的shell变量。</li></ul> <table><thead><tr><th>交互类型</th> <th>登录类型</th> <th>Bash启动</th> <th>bash退出</th></tr></thead> <tbody><tr><td>交互式</td> <td>登录shell</td> <td>/etc/profile<br>~/.bash_profile | ~/.bash_login | ~/.profile</td> <td>.bash_logout</td></tr> <tr><td>交互式</td> <td>非登录shell</td> <td>~/.bashrc</td> <td></td></tr> <tr><td>非交互式</td> <td>非登录shell</td> <td>继承环境变量</td> <td></td></tr></tbody></table> <p>参考：<a href="http://einverne.github.io/post/2019/01/login-shell-vs-non-login-shell.html" target="_blank" rel="noopener noreferrer">登录式 shell 和非登录式 shell 区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="变量"><a href="#变量" class="header-anchor">$</a> 变量</h2> <h3 id="变量类型"><a href="#变量类型" class="header-anchor">$</a> 变量类型</h3> <p>运行shell时，会同时存在三种变量：</p> <ol><li>局部变量：局部变量在脚本或命令中定义，仅在当前shell实例中有效，其他shell启动的程序不能访问局部变量。</li> <li>环境变量：所有的程序，包括shell启动的程序，都能访问环境变量，有些程序需要环境变量来保证其正常运行。必要的时候shell脚本也可以定义环境变量。</li> <li>shell变量：shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，有一部分是局部变量，这些变量保证了shell的正常运行。</li></ol> <p>子进程从它的父进程继承环境。由于进程的局部性，一旦子进程被产生，父进程就无法感知对环境的修改，子进程也无法感知父进程对环境变量的修改。</p> <p>当运行export 变量时，shell将这些变量的名称放入环境中。如果没有参数，export将列出所有环境变量。</p> <h3 id="定义变量"><a href="#定义变量" class="header-anchor">$</a> 定义变量</h3> <p>Shell 变量的命名规范和大部分编程语言都一样：</p> <ul><li>变量名由数字、字母、下划线组成</li> <li>必须以字母或者下划线开头</li> <li>不能使用 Shell 里的关键字（通过 help 命令可以查看保留关键字）</li></ul> <p>Shell 支持以下定义变量的方式：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">variable</span><span class="token operator">=</span>value             <span class="token comment"># 赋值号的周围不能有空格</span>
<span class="token assign-left variable">variable</span><span class="token operator">=</span><span class="token string">'value'</span>           <span class="token comment"># 如果 value 包含了空白符，那么就必须使用引号包围起来。</span>
<span class="token assign-left variable">variable</span><span class="token operator">=</span><span class="token string">&quot;value&quot;</span>
<span class="token builtin class-name">readonly</span> <span class="token assign-left variable">variable</span><span class="token operator">=</span><span class="token string">&quot;value&quot;</span>  <span class="token comment"># 使用 readonly 命令可以将变量定义为只读变量，只读变量的值不能被改变</span>
</code></pre></div><p>Shell 也支持将命令的执行结果赋值给变量，常见的有以下两种方式：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">variable</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">command</span><span class="token variable">`</span></span>
<span class="token assign-left variable">variable</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">command</span><span class="token variable">)</span></span>
</code></pre></div><h3 id="使用变量"><a href="#使用变量" class="header-anchor">$</a> 使用变量</h3> <p>使用一个定义过的变量，只要在变量名前面加美元符号$即可，如：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">variable</span><span class="token operator">=</span><span class="token string">&quot;value&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$variable</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${variable}</span>       <span class="token comment"># 加花括号是为了帮助解释器识别变量的边界，推荐给所有变量加上花括号{}</span>
</code></pre></div><h3 id="删除变量"><a href="#删除变量" class="header-anchor">$</a> 删除变量</h3> <p>使用 unset 命令可以删除变量，unset 命令不能删除只读变量，变量被删除后不能再次使用：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">unset</span> variable_name
</code></pre></div><h3 id="内置变量"><a href="#内置变量" class="header-anchor">$</a> 内置变量</h3> <p>// TODO</p> <h3 id="参数替换"><a href="#参数替换" class="header-anchor">$</a> 参数替换</h3> <p>两种形式的区别是：</p> <ul><li><p>一般形式下区分未声明变量和值为空字符串的变量</p></li> <li><p>非空形式下不区分未声明变量和值为空字符串的变量，即当变量值为空字符串时视为变量未声明。</p></li></ul> <table><thead><tr><th>一般形式</th> <th>非空形式</th> <th>说明（括号内非空形式）</th></tr></thead> <tbody><tr><td>${parameter}</td> <td></td> <td>即变量parameter的值</td></tr> <tr><td>${parameter-default}</td> <td>${parameter:-default}</td> <td>如果parameter未声明（或值为空）返回default值</td></tr> <tr><td>${parameter=default}</td> <td>${parameter:=default}</td> <td>如果parameter未声明（或值为空）则parameter值设置为default并返回</td></tr> <tr><td>${parameter+alt_value}</td> <td>${parameter:+alt_value}</td> <td>如果parameter未声明（或值为空）则返回空字符串；否则修改为alt_value并返回</td></tr> <tr><td>${parameter?err_msg}</td> <td>${parameter:?err_msg}</td> <td>如果parameter未声明（或值为空）则打印err_msg并返回退出码1</td></tr> <tr><td>${#var}</td> <td></td> <td>变量var字符串长度；如果var为数组则返回数组中第一个元素的长度</td></tr> <tr><td>${#array[*]} and ${#array[@]}</td> <td></td> <td>返回数组长度</td></tr> <tr><td>${var#Pattern}</td> <td></td> <td>从变量var的最前端（左端）去掉最短匹配Pattern的部分</td></tr> <tr><td>${var##Pattern}</td> <td></td> <td>从变量var的最前端（左端）去掉最长匹配Pattern的部分</td></tr> <tr><td>${var%Pattern}</td> <td></td> <td>从变量var的最后端（右端）去掉最短匹配Pattern的部分</td></tr> <tr><td>${var%%Pattern}</td> <td></td> <td>从变量var的最后端（右端）去掉最长匹配Pattern的部分</td></tr> <tr><td>${var:pos}</td> <td></td> <td>从pos位置处截取到结尾</td></tr> <tr><td>${var:pos:len}</td> <td></td> <td>从pos位置处截取len长度的子串</td></tr> <tr><td>${var/Pattern/Replacement}</td> <td></td> <td>将var中第一次匹配Pattern的部分替换成Replacement，如果Replacement为空，则相当于删除</td></tr> <tr><td>${var//Pattern/Replacement}</td> <td></td> <td>将var中所有匹配Pattern的部分替换成Replacement，如果Replacement为空，则相当于删除</td></tr> <tr><td>${var/#Pattern/Replacement}</td> <td></td> <td>如果var的前缀匹配Pattern则替换为Replacement</td></tr> <tr><td>${var/%Pattern/Replacement}</td> <td></td> <td>如果var的后缀匹配Pattern则替换为Replacement</td></tr> <tr><td>${!varprefix*}, ${!varprefix@}</td> <td></td> <td>匹配所有以varprefix开头的已声明变量</td></tr></tbody></table> <p>参考：https://tldp.org/LDP/abs/html/parameter-substitution.html</p> <h2 id="字符串"><a href="#字符串" class="header-anchor">$</a> 字符串</h2> <p>单引号字符串的限制：</p> <ul><li>单引号里的任何字符都会原样输出，单引号字符串中的变量是无效的；</li> <li>单引号字串中不能出现单独一个的单引号（对单引号使用转义符后也不行），但可成对出现，作为字符串拼接使用。</li></ul> <p>双引号的优点：</p> <ul><li>双引号里可以有变量</li> <li>双引号里可以出现转义字符</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">your_name</span><span class="token operator">=</span><span class="token string">&quot;runoob&quot;</span>
<span class="token comment"># 使用双引号拼接</span>
<span class="token assign-left variable">greeting</span><span class="token operator">=</span><span class="token string">&quot;hello, &quot;</span><span class="token variable">$your_name</span><span class="token string">&quot; !&quot;</span>
<span class="token assign-left variable">greeting_1</span><span class="token operator">=</span><span class="token string">&quot;hello, <span class="token variable">${your_name}</span> !&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$greeting</span>  <span class="token variable">$greeting_1</span>

<span class="token comment"># 使用单引号拼接</span>
<span class="token assign-left variable">greeting_2</span><span class="token operator">=</span><span class="token string">'hello, '</span><span class="token variable">$your_name</span><span class="token string">' !'</span>
<span class="token assign-left variable">greeting_3</span><span class="token operator">=</span><span class="token string">'hello, ${your_name} !'</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$greeting_2</span>  <span class="token variable">$greeting_3</span>

<span class="token comment">#获取字符串长度</span>
<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">&quot;abcd&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">#</span>string}</span> <span class="token comment">#输出 4</span>

<span class="token comment">#提取子字符串</span>
<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">&quot;runoob is a great site&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${string<span class="token operator">:</span>1<span class="token operator">:</span>4}</span> <span class="token comment"># 输出 unoo</span>

<span class="token comment">#查找子字符串</span>
<span class="token assign-left variable">string</span><span class="token operator">=</span><span class="token string">&quot;runoob is a great site&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> index <span class="token string">&quot;<span class="token variable">$string</span>&quot;</span> io<span class="token variable">`</span></span>  <span class="token comment"># 输出 4</span>
<span class="token comment">#判断字符串为空的正确方法,注意双引号</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable">$STRING</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;STRING is empty&quot;</span>
<span class="token keyword">fi</span>
<span class="token comment">#或</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$STRING</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;STRING is not empty&quot;</span>
<span class="token keyword">fi</span>
</code></pre></div><blockquote><p>注意：判断字符串为空的正确方法需要加双引号。</p></blockquote> <h2 id="数组"><a href="#数组" class="header-anchor">$</a> 数组</h2> <h3 id="定义数组"><a href="#定义数组" class="header-anchor">$</a> 定义数组</h3> <p>bash只支持一维数组，但参数个数没有限制。定义数组有以下方式：</p> <ol><li><p>使用<code>declare -a</code>定义数组：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">declare</span> <span class="token parameter variable">-a</span> array
</code></pre></div></li> <li><p>使用[]操作符：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'foo'</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'bar'</span>
</code></pre></div></li> <li><p>使用()直接赋值：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'foo'</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token comment"># 或</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'bar'</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>连接两个数组：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">array3</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span> <span class="token variable">${array2<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">#</span>array3<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
</code></pre></div></li> <li><p>从文件中读取数组：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 将每一行读取为数组的一个元素</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> <span class="token string">'array.txt'</span><span class="token variable">`</span></span><span class="token punctuation">)</span> 
</code></pre></div></li></ol> <h3 id="读取数组"><a href="#读取数组" class="header-anchor">$</a> 读取数组</h3> <p>使用[]操作符和基于0的下标来取值：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'foo'</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token variable">${array<span class="token punctuation">[</span>n<span class="token punctuation">]</span>}</span>                     <span class="token comment"># 数组第n个元素</span>
<span class="token variable">${array<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span> 或<span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>       <span class="token comment"># 数组所有成员，使用“@”这个特殊的下标，可以将数组扩展成列表</span>
<span class="token variable">${<span class="token operator">!</span>array<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span> 或<span class="token variable">${<span class="token operator">!</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>     <span class="token comment"># 数组所有下标</span>
<span class="token variable">${<span class="token operator">#</span>array<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span> 或<span class="token variable">${<span class="token operator">#</span>array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>     <span class="token comment"># 数组元素个数，没有定义的数组下标不会占用数组中元素的个数</span>
<span class="token variable">${<span class="token operator">#</span>array<span class="token punctuation">[</span>0<span class="token punctuation">]</span>}</span>                    <span class="token comment"># 数组第一个成员的长度</span>
</code></pre></div><h3 id="遍历数组元素"><a href="#遍历数组元素" class="header-anchor">$</a> 遍历数组元素</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 使用for in循环读取数组：</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">item</span> <span class="token keyword">in</span> <span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span><span class="token punctuation">;</span><span class="token keyword">do</span>
 <span class="token builtin class-name">echo</span> <span class="token variable">$item</span>
<span class="token keyword">done</span>
<span class="token comment"># 使用for循环读取数组：</span>
<span class="token assign-left variable">len</span><span class="token operator">=</span><span class="token variable">${<span class="token operator">#</span>adobe<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>$len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span><span class="token keyword">do</span>
 <span class="token builtin class-name">echo</span> <span class="token variable">${adobe<span class="token punctuation">[</span>$i<span class="token punctuation">]</span>}</span>
<span class="token keyword">do</span>
</code></pre></div><h3 id="修改数组"><a href="#修改数组" class="header-anchor">$</a> 修改数组</h3> <p>替换数组元素：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'foo'</span> <span class="token string">'bar'</span><span class="token punctuation">)</span>
<span class="token comment"># 使用模式操作符替换数组中的元素</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">/</span>foo<span class="token operator">/</span>foo2}</span>
</code></pre></div><p>删除数组元素：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'foo1'</span> <span class="token string">'bar2'</span> <span class="token string">'foo3'</span> <span class="token string">'bar4'</span> <span class="token string">'foo5'</span><span class="token punctuation">)</span>
<span class="token comment"># 使用命令替换并重新赋值的方式删除数组元素</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>0<span class="token operator">:</span>2}</span> <span class="token variable">${array	<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">:</span>3}</span><span class="token punctuation">)</span>
<span class="token comment"># 使用模式操作符删除数组元素</span>
<span class="token assign-left variable">array</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">${array<span class="token punctuation">[</span>@<span class="token punctuation">]</span><span class="token operator">/</span>foo3<span class="token operator">/</span>}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="数组与循环示例"><a href="#数组与循环示例" class="header-anchor">$</a> 数组与循环示例</h3> <p>从标准输入读入n次字符串，每次输入的字符串保存在数组array里：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">n</span><span class="token operator">=</span><span class="token number">5</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$i</span>&quot;</span> <span class="token parameter variable">-lt</span> <span class="token variable">$n</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;Please input strings ... <span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $i + <span class="token number">1</span><span class="token variable">`</span></span>&quot;</span>
  <span class="token builtin class-name">read</span> array<span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${array<span class="token punctuation">[</span>$i<span class="token punctuation">]</span>}</span>&quot;</span>
  <span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">expr</span> $i + <span class="token number">1</span><span class="token variable">`</span></span>
<span class="token keyword">done</span>
</code></pre></div><p>将字符串里的字母逐个放入数组，并输出到标准输出：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token assign-left variable">chars</span><span class="token operator">=</span><span class="token string">'abcdefghijklmnopqrstuvwxyz'</span>
<span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">))</span></span> <span class="token punctuation">;</span> <span class="token keyword">do</span>
    array<span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">${chars<span class="token operator">:</span>$i<span class="token operator">:</span>1}</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">${array<span class="token punctuation">[</span>$i<span class="token punctuation">]</span>}</span>
<span class="token keyword">done</span>
</code></pre></div><p>将文件中内容给数组赋值：(碰到第一个回车符之前的内容)，然后查看数组赋值情况：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">read</span> <span class="token parameter variable">-a</span> Words <span class="token operator">&lt;</span> /tmp/tmp.file
<span class="token builtin class-name">set</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Words&quot;</span>
</code></pre></div><h3 id="关联数组"><a href="#关联数组" class="header-anchor">$</a> 关联数组</h3> <p>由于shell的的数组只支持一维数组,并且并没有map这种数据结构也。我们使用关联数组来模拟map的效果：</p> <p>定义一个map：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">declare</span> <span class="token parameter variable">-A</span> <span class="token assign-left variable">map</span><span class="token operator">=</span>（）
<span class="token builtin class-name">declare</span> <span class="token parameter variable">-A</span> <span class="token assign-left variable">map</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;100&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;1&quot;</span> <span class="token punctuation">[</span><span class="token string">&quot;200&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>输出所有key：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token variable">${<span class="token operator">!</span>map<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
</code></pre></div><p>输出所有value：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token variable">${map<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
</code></pre></div><p>添加值：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token string">&quot;300&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;3&quot;</span>
</code></pre></div><p>输出key对应的值：</p> <div class="language-ruby extra-class"><pre class="language-ruby"><code>echo $<span class="token punctuation">{</span>map<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;100&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><p>遍历map：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">for</span> <span class="token for-or-select variable">key</span> <span class="token keyword">in</span> <span class="token variable">${<span class="token operator">!</span>map<span class="token punctuation">[</span>@<span class="token punctuation">]</span>}</span>
<span class="token keyword">do</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">${map<span class="token punctuation">[</span>$key<span class="token punctuation">]</span>}</span>
<span class="token keyword">done</span>
</code></pre></div><h3 id="参考"><a href="#参考" class="header-anchor">$</a> 参考</h3> <ul><li><a href="https://www.jb51.net/article/101241.htm" target="_blank" rel="noopener noreferrer">Bash中数组的操作教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/ilovemilk/article/details/4959747" target="_blank" rel="noopener noreferrer">bash数组定义<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://c.biancheng.net/cpp/shell/" target="_blank" rel="noopener noreferrer">30分钟玩转Shell脚本编程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/samxx8/article/details/8025548" target="_blank" rel="noopener noreferrer">BASH数组用法小结及循环用法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/xzw_123/article/details/42920371" target="_blank" rel="noopener noreferrer">shell中map的使用和遍历<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/uestcyms/article/details/97511768" target="_blank" rel="noopener noreferrer">shell 数组(含&quot;map&quot;)操作总结<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="注释"><a href="#注释" class="header-anchor">$</a> 注释</h2> <p>多行注释还可以使用以下格式：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>:<span class="token operator">&lt;&lt;</span><span class="token string">EOF
注释内容...
注释内容...
注释内容...
EOF</span>
</code></pre></div><p>EOF 也可以使用其他符号:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>:<span class="token operator">&lt;&lt;</span><span class="token string">'
注释内容...
注释内容...
注释内容...
'</span>
</code></pre></div><h2 id="传递参数"><a href="#传递参数" class="header-anchor">$</a> 传递参数</h2> <table><thead><tr><th>参数处理</th> <th>说明</th></tr></thead> <tbody><tr><td>$0</td> <td>脚本名称</td></tr> <tr><td>$n</td> <td>传给脚本/函数的第n个参数(第10+个参数要使用花括号：${10})</td></tr> <tr><td>$*</td> <td>以一个单字符串显示所有向脚本传递的参数。 如&quot;$*&quot;用用双引号括起来的情况、以&quot;$1 $2 … $n&quot;的形式输出所有参数（传递了一个参数）。</td></tr> <tr><td>$@</td> <td>与$*相同，但是使用时加引号，并在引号中返回每个参数。 如&quot;$@&quot;用双引号括起来的情况、以&quot;$1&quot; &quot;$2&quot; … &quot;$n&quot; 的形式输出所有参数（传递了N个参数）。</td></tr> <tr><td>$#</td> <td>传递到脚本的参数个数</td></tr> <tr><td>$-</td> <td>显示Shell使用的当前选项，与set命令功能相同。</td></tr> <tr><td>$!</td> <td>后台运行的最后一个进程的ID号</td></tr> <tr><td>$?</td> <td>显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。</td></tr> <tr><td>$$</td> <td>脚本运行的当前进程ID号</td></tr></tbody></table> <h2 id="运算符"><a href="#运算符" class="header-anchor">$</a> 运算符</h2> <p>Shell 和其他编程语言一样，支持多种运算符，包括：</p> <ul><li>算数运算符</li> <li>关系运算符</li> <li>布尔运算符</li> <li>字符串运算符</li> <li>文件测试运算符</li></ul> <h3 id="算术运算符"><a href="#算术运算符" class="header-anchor">$</a> 算术运算符</h3> <table><thead><tr><th>运算符</th> <th>举例</th> <th>说明</th></tr></thead> <tbody><tr><td>+</td> <td><code>expr $a + $b</code> 结果为 30。</td> <td>加法</td></tr> <tr><td>-</td> <td><code>expr $a - $b</code> 结果为 -10。</td> <td>减法</td></tr> <tr><td>*</td> <td><code>expr $a \* $b</code> 结果为  200。</td> <td>乘法</td></tr> <tr><td>/</td> <td><code>expr $b / $a</code> 结果为 2。</td> <td>除法</td></tr> <tr><td>%</td> <td><code>expr $b % $a</code> 结果为 0。</td> <td>取余</td></tr> <tr><td>=</td> <td>a=$b 将把变量 b 的值赋给 a。</td> <td>赋值</td></tr> <tr><td>==</td> <td>[ $a == $b ] 返回 false。</td> <td>相等。用于比较两个数字，相同则返回 true。</td></tr> <tr><td>!=</td> <td>[ $a != $b ] 返回 true。</td> <td>不相等。用于比较两个数字，不相同则返回 true。</td></tr></tbody></table> <ul><li>乘号(*)前边必须加反斜杠()才能实现乘法运算；</li> <li>条件表达式要放在方括号之间，并且要有空格，例如: <strong>[$a==$b]</strong> 是错误的，必须写成 <strong>[ $a == $b ]</strong>。</li></ul> <h3 id="关系运算符"><a href="#关系运算符" class="header-anchor">$</a> 关系运算符</h3> <p>关系运算符只支持数字，不支持字符串，除非字符串的值是数字。</p> <p>下表列出了常用的关系运算符，假定变量 a 为 10，变量 b 为 20：</p> <table><thead><tr><th>运算符</th> <th>举例</th> <th>说明</th></tr></thead> <tbody><tr><td>-eq</td> <td>[ $a -eq $b ] 返回 false</td> <td>检测两个数是否相等，相等返回 true。</td></tr> <tr><td>-ne</td> <td>[ $a -ne $b ] 返回 true</td> <td>检测两个数是否不相等，不相等返回 true。</td></tr> <tr><td>-gt</td> <td>[ $a -gt $b ] 返回 false</td> <td>检测左边的数是否大于右边的，如果是，则返回 true。</td></tr> <tr><td>-lt</td> <td>[ $a -lt $b ] 返回 true</td> <td>检测左边的数是否小于右边的，如果是，则返回 true。</td></tr> <tr><td>-ge</td> <td>[ $a -ge $b ] 返回 false</td> <td>检测左边的数是否大于等于右边的，如果是，则返回 true。</td></tr> <tr><td>-le</td> <td>[ $a -le $b ] 返回 true</td> <td>检测左边的数是否小于等于右边的，如果是，则返回 true。</td></tr></tbody></table> <h3 id="布尔运算符"><a href="#布尔运算符" class="header-anchor">$</a> 布尔运算符</h3> <p>下表列出了常用的布尔运算符，假定变量 a 为 10，变量 b 为 20：</p> <table><thead><tr><th>运算符</th> <th>举例</th> <th>说明</th></tr></thead> <tbody><tr><td>!</td> <td>[ ! false ] 返回 true。</td> <td>非运算，表达式为 true 则返回 false，否则返回 true。</td></tr> <tr><td>-o</td> <td>[ $a -lt 20 -o $b -gt 100 ] 返回 true。</td> <td>或运算，有一个表达式为 true 则返回 true。</td></tr> <tr><td>-a</td> <td>[ $a -lt 20 -a $b -gt 100 ] 返回 false。</td> <td>与运算，两个表达式都为 true 才返回 true。</td></tr></tbody></table> <h3 id="逻辑运算符"><a href="#逻辑运算符" class="header-anchor">$</a> 逻辑运算符</h3> <table><thead><tr><th>运算符</th> <th>说明</th> <th>举例</th></tr></thead> <tbody><tr><td>&amp;&amp;</td> <td>逻辑的 AND</td> <td>[[ $a -lt 100 &amp;&amp; $b -gt 100 ]] 返回 false</td></tr> <tr><td>||</td> <td>逻辑的 OR</td> <td>[[ $a -lt 100 || $b -gt 100 ]] 返回 true</td></tr></tbody></table> <p>可以用逻辑运算符模拟三目运算符：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token keyword">if</span> command1<span class="token punctuation">;</span> <span class="token keyword">then</span>
    command2
<span class="token keyword">else</span>
    command3
<span class="token keyword">fi</span>
</code></pre></div><p>等价于：</p> <div class="language- extra-class"><pre class="language-text"><code>command1 &amp;&amp; command2 || command3
</code></pre></div><h3 id="字符串运算符"><a href="#字符串运算符" class="header-anchor">$</a> 字符串运算符</h3> <table><thead><tr><th>运算符</th> <th>举例</th> <th>说明</th></tr></thead> <tbody><tr><td>=</td> <td>[ $a = $b ] 返回 false。</td> <td>检测两个字符串是否相等，相等返回 true。</td></tr> <tr><td>!=</td> <td>[ $a != $b ] 返回 true。</td> <td>检测两个字符串是否相等，不相等返回 true。</td></tr> <tr><td>-z</td> <td>[ -z &quot;$a&quot; ] 返回 false。</td> <td>检测字符串长度是否为0，为0返回 true。</td></tr> <tr><td>-n</td> <td>[ -n &quot;$a&quot; ] 返回 true。</td> <td>检测字符串长度是否为0，不为0返回 true。</td></tr> <tr><td>str</td> <td>[ $a ] 返回 true。</td> <td>检测字符串是否为空，不为空返回 true。</td></tr></tbody></table> <h3 id="文件测试运算符"><a href="#文件测试运算符" class="header-anchor">$</a> 文件测试运算符</h3> <table><thead><tr><th>操作符</th> <th>举例</th> <th>说明</th></tr></thead> <tbody><tr><td>-b file</td> <td>[ -b $file ] 返回 false</td> <td>检测文件是否是块设备文件，如果是，则返回 true。</td></tr> <tr><td>-c file</td> <td>[ -c $file ] 返回 false。</td> <td>检测文件是否是字符设备文件，如果是，则返回 true。</td></tr> <tr><td>-d file</td> <td>[ -d $file ] 返回 false。</td> <td>检测文件是否是目录，如果是，则返回 true。</td></tr> <tr><td>-f file</td> <td>[ -f $file ] 返回 true。</td> <td>检测文件是否是普通文件（既不是目录，也不是设备文件），<br>如果是，则返回 true。</td></tr> <tr><td>-g file</td> <td>[ -g $file ] 返回 false。</td> <td>检测文件是否设置了 SGID 位，如果是，则返回 true。</td></tr> <tr><td>-k file</td> <td>[ -k $file ] 返回 false。</td> <td>检测文件是否设置了粘着位(Sticky Bit)，如果是，则返回 true。</td></tr> <tr><td>-p file</td> <td>[ -p $file ] 返回 false。</td> <td>检测文件是否是有名管道，如果是，则返回 true。</td></tr> <tr><td>-u file</td> <td>[ -u $file ] 返回 false。</td> <td>检测文件是否设置了 SUID 位，如果是，则返回 true。</td></tr> <tr><td>-r file</td> <td>[ -r $file ] 返回 true。</td> <td>检测文件是否可读，如果是，则返回 true。</td></tr> <tr><td>-w file</td> <td>[ -w $file ] 返回 true。</td> <td>检测文件是否可写，如果是，则返回 true。</td></tr> <tr><td>-x file</td> <td>[ -x $file ] 返回 true。</td> <td>检测文件是否可执行，如果是，则返回 true。</td></tr> <tr><td>-s file</td> <td>[ -s $file ] 返回 true。</td> <td>检测文件是否为空（文件大小是否大于0），不为空返回 true。</td></tr> <tr><td>-e file</td> <td>[ -e $file ] 返回 true。</td> <td>检测文件（包括目录）是否存在，如果是，则返回 true。</td></tr></tbody></table> <p><code>test</code> 和 <code>[</code> 属于 Shell 的内建命令，所以需要跟它的参数使用空格隔开，然后 ] 作为最后一个参数表示条件结束，<code>[[</code> 属于 Shell 的保留关键字:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token builtin class-name">type</span> <span class="token string">&quot;test&quot;</span> <span class="token string">&quot;[&quot;</span> <span class="token string">&quot;[[&quot;</span>
<span class="token builtin class-name">test</span> is a shell <span class="token builtin class-name">builtin</span>
<span class="token punctuation">[</span> is a shell <span class="token builtin class-name">builtin</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> is a reserved word
</code></pre></div><blockquote><p><a href="http://www.runoob.com/w3cnote/linux-shell-brackets-features.html" target="_blank" rel="noopener noreferrer">shell 中各种括号的作用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="符号命令"><a href="#符号命令" class="header-anchor">$</a> 符号命令</h2> <table><thead><tr><th>符号</th> <th>命令</th></tr></thead> <tbody><tr><td>()</td> <td>子shell</td></tr> <tr><td>$()</td> <td>替换命令</td></tr> <tr><td>$(())</td> <td>算术扩展式</td></tr> <tr><td>(())</td> <td>计算算术表达式，let的同义词(当被括起来的值中包含等号时使用)</td></tr> <tr><td>[]</td> <td>test命令</td></tr> <tr><td>[[]]</td> <td>条件表达式，类似于[]，但添加了字符串比较</td></tr></tbody></table> <p>参考：</p> <p><a href="https://blog.csdn.net/yumushui/article/details/53469845" target="_blank" rel="noopener noreferrer">shell脚本中整数型变量自增（加1）的实现方式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://stackoverflow.com/questions/3985193/what-is-bin-sh-c" target="_blank" rel="noopener noreferrer">What is /bin/sh -c?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="管道"><a href="#管道" class="header-anchor">$</a> 管道</h2> <h3 id="管道与退出状态码"><a href="#管道与退出状态码" class="header-anchor">$</a> 管道与退出状态码</h3> <p>对于非管道命令使用 $? 能够检查前一个命令的退出状态；对于管道命令也有 PIPESTATUS 变量允许检查从管道所有部分返回的代码。</p> <p>对于管道：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>cmd1 <span class="token operator">|</span> cmd2 <span class="token operator">|</span> cmd3
</code></pre></div><p>cmd1 退出代码在 <code>${PIPESTATUS[0]}</code> 中，cmd3 退出代码在 <code>${PIPESTATUS[2]}</code> 中，因此 <code>$?</code> 总是与 <code>${PIPESTATUS: -1}</code> 相同。</p> <p>参考：<a href="https://www.qiansw.com/bash-shell-gets-the-exit-status-code-before-the-pipe.html" target="_blank" rel="noopener noreferrer">bash shell 获取管道前的退出状态码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="管道与循环"><a href="#管道与循环" class="header-anchor">$</a> 管道与循环</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>producer-command <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> line
<span class="token keyword">do</span>
	consumer-command
<span class="token keyword">done</span>
</code></pre></div><h2 id="todo"><a href="#todo" class="header-anchor">$</a> TODO</h2> <div class="language- extra-class"><pre class="language-text"><code>Shell替换：Shell变量替换，命令替换，转义字符
数据类型
流程控制
if
switch
while
for
函数
操作符
模式操作符
read和数组
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">4/24/2022, 11:31:18 AM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/linux/locale.html">
        Locale笔记
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.8bb29984.js" defer></script><script src="/assets/js/2.33a0ea92.js" defer></script><script src="/assets/js/189.390a4b4d.js" defer></script>
  </body>
</html>
